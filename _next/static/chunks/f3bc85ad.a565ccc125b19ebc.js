"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[757],{9338:function(l,p,d){var f,_;d.r(p),f="undefined"!=typeof self?self:void 0,_=()=>(()=>{var l={382:function(l,p,d){var f,_,m,O,I,V,F,P,te,ts,ti,tn,tl,th,tu,tp,td,tf,t_,tm,tg,tv,ty;f=d(424),_=d(690),m=d(728),O=function(l,p,d){return{endTime:p,insertTime:d,type:"exponentialRampToValue",value:l}},I=function(l,p,d){return{endTime:p,insertTime:d,type:"linearRampToValue",value:l}},V=function(l,p){return{startTime:p,type:"setValue",value:l}},F=function(l,p,d){return{duration:d,startTime:p,type:"setValueCurve",values:l}},P=function(l,p,d){var f=d.startTime,_=d.target;return _+(p-_)*Math.exp((f-l)/d.timeConstant)},te=function(l){return"exponentialRampToValue"===l.type},ts=function(l){return"linearRampToValue"===l.type},ti=function(l){return te(l)||ts(l)},tn=function(l){return"setValue"===l.type},tl=function(l){return"setValueCurve"===l.type},th=function t(l,p,d,f){var _=l[p];return void 0===_?f:ti(_)||tn(_)?_.value:tl(_)?_.values[_.values.length-1]:P(d,t(l,p-1,_.startTime,f),_)},tu=function(l,p,d,f,_){return void 0===d?[f.insertTime,_]:ti(d)?[d.endTime,d.value]:tn(d)?[d.startTime,d.value]:tl(d)?[d.startTime+d.duration,d.values[d.values.length-1]]:[d.startTime,th(l,p-1,d.startTime,_)]},tp=function(l){return"cancelAndHold"===l.type},td=function(l){return"cancelScheduledValues"===l.type},tf=function(l){return tp(l)||td(l)?l.cancelTime:te(l)||ts(l)?l.endTime:l.startTime},t_=function(l,p,d,f){var _=f.endTime,m=f.value;return d===m?m:0<d&&0<m||d<0&&m<0?d*Math.pow(m/d,(l-p)/(_-p)):0},tm=function(l,p,d,f){return d+(l-p)/(f.endTime-p)*(f.value-d)},tg=function(l,p){var d,f,_,m=p.duration,O=p.startTime,I=p.values;return(f=Math.floor(d=(l-O)/m*(I.length-1)))===(_=Math.ceil(d))?I[f]:(1-(d-f))*I[f]+(1-(_-d))*I[_]},tv=function(l){return"setTarget"===l.type},ty=m(function t(l){_(this,t),this._automationEvents=[],this._currenTime=0,this._defaultValue=l},[{key:Symbol.iterator,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(l){var p=tf(l);if(tp(l)||td(l)){var d=this._automationEvents.findIndex(function(d){return td(l)&&tl(d)?d.startTime+d.duration>=p:tf(d)>=p}),f=this._automationEvents[d];if(-1!==d&&(this._automationEvents=this._automationEvents.slice(0,d)),tp(l)){var _=this._automationEvents[this._automationEvents.length-1];if(void 0!==f&&ti(f)){if(void 0!==_&&tv(_))throw Error("The internal list is malformed.");var m=void 0===_?f.insertTime:tl(_)?_.startTime+_.duration:tf(_),P=void 0===_?this._defaultValue:tl(_)?_.values[_.values.length-1]:_.value,tn=te(f)?t_(p,m,P,f):tm(p,m,P,f),th=te(f)?O(tn,p,this._currenTime):I(tn,p,this._currenTime);this._automationEvents.push(th)}if(void 0!==_&&tv(_)&&this._automationEvents.push(V(this.getValue(p),p)),void 0!==_&&tl(_)&&_.startTime+_.duration>p){var tu=p-_.startTime,tg=(_.values.length-1)/_.duration,ty=Math.max(2,1+Math.ceil(tu*tg)),tx=tu/(ty-1)*tg,tb=_.values.slice(0,ty);if(tx<1)for(var tw=1;tw<ty;tw+=1){var tT=tx*tw%1;tb[tw]=_.values[tw-1]*(1-tT)+_.values[tw]*tT}this._automationEvents[this._automationEvents.length-1]=F(tb,_.startTime,tu)}}}else{var tS=this._automationEvents.findIndex(function(l){return tf(l)>p}),tk=-1===tS?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[tS-1];if(void 0!==tk&&tl(tk)&&tf(tk)+tk.duration>p)return!1;var tA=te(l)?O(l.value,l.endTime,this._currenTime):ts(l)?I(l.value,p,this._currenTime):l;if(-1===tS)this._automationEvents.push(tA);else{if(tl(l)&&p+l.duration>tf(this._automationEvents[tS]))return!1;this._automationEvents.splice(tS,0,tA)}}return!0}},{key:"flush",value:function(l){var p=this._automationEvents.findIndex(function(p){return tf(p)>l});if(p>1){var d=this._automationEvents.slice(p-1),f=d[0];tv(f)&&d.unshift(V(th(this._automationEvents,p-2,f.startTime,this._defaultValue),f.startTime)),this._automationEvents=d}}},{key:"getValue",value:function(l){if(0===this._automationEvents.length)return this._defaultValue;var p=this._automationEvents.findIndex(function(p){return tf(p)>l}),d=this._automationEvents[p],_=(-1===p?this._automationEvents.length:p)-1,m=this._automationEvents[_];if(void 0!==m&&tv(m)&&(void 0===d||!ti(d)||d.insertTime>l))return P(l,th(this._automationEvents,_-1,m.startTime,this._defaultValue),m);if(void 0!==m&&tn(m)&&(void 0===d||!ti(d)))return m.value;if(void 0!==m&&tl(m)&&(void 0===d||!ti(d)||m.startTime+m.duration>l))return l<m.startTime+m.duration?tg(l,m):m.values[m.values.length-1];if(void 0!==m&&ti(m)&&(void 0===d||!ti(d)))return m.value;if(void 0!==d&&te(d)){var O=f(tu(this._automationEvents,_,m,d,this._defaultValue),2);return t_(l,O[0],O[1],d)}if(void 0!==d&&ts(d)){var I=f(tu(this._automationEvents,_,m,d,this._defaultValue),2);return tm(l,I[0],I[1],d)}return this._defaultValue}}]),p.AutomationEventList=ty,p.createCancelAndHoldAutomationEvent=function(l){return{cancelTime:l,type:"cancelAndHold"}},p.createCancelScheduledValuesAutomationEvent=function(l){return{cancelTime:l,type:"cancelScheduledValues"}},p.createExponentialRampToValueAutomationEvent=function(l,p){return{endTime:p,type:"exponentialRampToValue",value:l}},p.createLinearRampToValueAutomationEvent=function(l,p){return{endTime:p,type:"linearRampToValue",value:l}},p.createSetTargetAutomationEvent=function(l,p,d){return{startTime:p,target:l,timeConstant:d,type:"setTarget"}},p.createSetValueAutomationEvent=V,p.createSetValueCurveAutomationEvent=F},897:l=>{l.exports=function(l,p){(null==p||p>l.length)&&(p=l.length);for(var d=0,f=Array(p);d<p;d++)f[d]=l[d];return f},l.exports.__esModule=!0,l.exports.default=l.exports},372:l=>{l.exports=function(l){if(Array.isArray(l))return l},l.exports.__esModule=!0,l.exports.default=l.exports},690:l=>{l.exports=function(l,p){if(!(l instanceof p))throw TypeError("Cannot call a class as a function")},l.exports.__esModule=!0,l.exports.default=l.exports},728:(l,p,d)=>{var f=d(62);function i(l,p){for(var d=0;d<p.length;d++){var _=p[d];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(l,f(_.key),_)}}l.exports=function(l,p,d){return p&&i(l.prototype,p),d&&i(l,d),Object.defineProperty(l,"prototype",{writable:!1}),l},l.exports.__esModule=!0,l.exports.default=l.exports},872:l=>{l.exports=function(l,p){var d=null==l?null:"undefined"!=typeof Symbol&&l[Symbol.iterator]||l["@@iterator"];if(null!=d){var f,_,m,O,I=[],V=!0,F=!1;try{if(m=(d=d.call(l)).next,0===p){if(Object(d)!==d)return;V=!1}else for(;!(V=(f=m.call(d)).done)&&(I.push(f.value),I.length!==p);V=!0);}catch(l){F=!0,_=l}finally{try{if(!V&&null!=d.return&&(O=d.return(),Object(O)!==O))return}finally{if(F)throw _}}return I}},l.exports.__esModule=!0,l.exports.default=l.exports},218:l=>{l.exports=function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},l.exports.__esModule=!0,l.exports.default=l.exports},424:(l,p,d)=>{var f=d(372),_=d(872),m=d(116),O=d(218);l.exports=function(l,p){return f(l)||_(l,p)||m(l,p)||O()},l.exports.__esModule=!0,l.exports.default=l.exports},36:(l,p,d)=>{var f=d(698).default;l.exports=function(l,p){if("object"!=f(l)||!l)return l;var d=l[Symbol.toPrimitive];if(void 0!==d){var _=d.call(l,p||"default");if("object"!=f(_))return _;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===p?String:Number)(l)},l.exports.__esModule=!0,l.exports.default=l.exports},62:(l,p,d)=>{var f=d(698).default,_=d(36);l.exports=function(l){var p=_(l,"string");return"symbol"==f(p)?p:p+""},l.exports.__esModule=!0,l.exports.default=l.exports},698:l=>{function e(p){return l.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(l){return typeof l}:function(l){return l&&"function"==typeof Symbol&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},l.exports.__esModule=!0,l.exports.default=l.exports,e(p)}l.exports=e,l.exports.__esModule=!0,l.exports.default=l.exports},116:(l,p,d)=>{var f=d(897);l.exports=function(l,p){if(l){if("string"==typeof l)return f(l,p);var d=Object.prototype.toString.call(l).slice(8,-1);return"Object"===d&&l.constructor&&(d=l.constructor.name),"Map"===d||"Set"===d?Array.from(l):"Arguments"===d||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?f(l,p):void 0}},l.exports.__esModule=!0,l.exports.default=l.exports}},p={};function s(d){var f=p[d];if(void 0!==f)return f.exports;var _=p[d]={exports:{}};return l[d].call(_.exports,_,_.exports,s),_.exports}s.d=(l,p)=>{for(var d in p)s.o(p,d)&&!s.o(l,d)&&Object.defineProperty(l,d,{enumerable:!0,get:p[d]})},s.o=(l,p)=>Object.prototype.hasOwnProperty.call(l,p),s.r=l=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})};var d={};return(()=>{let l,p;s.r(d),s.d(d,{AMOscillator:()=>$o,AMSynth:()=>Cr,Abs:()=>pr,Add:()=>nr,AmplitudeEnvelope:()=>Sr,Analyser:()=>Xa,AudioToGain:()=>Xo,AutoFilter:()=>ua,AutoPanner:()=>da,AutoWah:()=>_a,BaseContext:()=>Ci,BiquadFilter:()=>Dr,BitCrusher:()=>ga,Buffer:()=>iL,BufferSource:()=>iW,Buffers:()=>iz,Channel:()=>sc,Chebyshev:()=>ya,Chorus:()=>Sa,Clock:()=>vo,Compressor:()=>cc,Context:()=>Di,Convolver:()=>fc,CrossFade:()=>ca,DCMeter:()=>Ja,Delay:()=>yo,Destination:()=>iF,Distortion:()=>ka,Draw:()=>ij,DuoSynth:()=>Rr,EQ3:()=>dc,Emitter:()=>Ai,Envelope:()=>xr,FFT:()=>Ha,FMOscillator:()=>Ho,FMSynth:()=>qr,FatOscillator:()=>Ko,FeedbackCombFilter:()=>Br,FeedbackDelay:()=>Ca,Filter:()=>Or,Follower:()=>fa,Freeverb:()=>Ra,Frequency:()=>Ji,FrequencyClass:()=>Yi,FrequencyEnvelope:()=>Mr,FrequencyShifter:()=>Oa,Gain:()=>ho,GainToAudio:()=>dr,Gate:()=>hc,GrainPlayer:()=>ur,GreaterThan:()=>gr,GreaterThanZero:()=>mr,IntervalTimeline:()=>Co,JCReverb:()=>Va,LFO:()=>rr,Limiter:()=>lc,Listener:()=>iP,Loop:()=>$r,LowpassCombFilter:()=>Gr,Master:()=>iN,MembraneSynth:()=>Vr,Merge:()=>wa,MetalSynth:()=>Ir,Meter:()=>$a,MidSideCompressor:()=>uc,MidSideMerge:()=>Ba,MidSideSplit:()=>Wa,Midi:()=>To,MidiClass:()=>bo,Mono:()=>nc,MonoSynth:()=>Er,MultibandCompressor:()=>pc,MultibandSplit:()=>ic,Multiply:()=>Yo,Negate:()=>fr,Noise:()=>Lo,NoiseSynth:()=>Nr,Offline:()=>xo,OfflineContext:()=>qi,OmniOscillator:()=>sr,OnePoleFilter:()=>Ur,Oscillator:()=>Zo,PWMOscillator:()=>tr,PanVol:()=>ec,Panner:()=>pa,Panner3D:()=>rc,Param:()=>no,Part:()=>Hr,Pattern:()=>ra,Phaser:()=>La,PingPongDelay:()=>Pa,PitchShift:()=>ja,Player:()=>hr,Players:()=>lr,PluckSynth:()=>Qr,PolySynth:()=>Zr,Pow:()=>Fo,PulseOscillator:()=>Jo,Recorder:()=>ac,Reverb:()=>za,Sampler:()=>Xr,Scale:()=>ir,ScaleExp:()=>vr,Sequence:()=>aa,Signal:()=>po,Solo:()=>tc,Split:()=>xa,StateTimeline:()=>so,StereoWidener:()=>Ga,Subtract:()=>_r,SyncedSignal:()=>yr,Synth:()=>kr,Ticks:()=>ko,TicksClass:()=>So,Time:()=>Xi,TimeClass:()=>Zi,Timeline:()=>wi,ToneAudioBuffer:()=>Ri,ToneAudioBuffers:()=>wo,ToneAudioNode:()=>io,ToneBufferSource:()=>jo,ToneEvent:()=>Yr,ToneOscillatorNode:()=>Qo,Transport:()=>iV,TransportTime:()=>to,TransportTimeClass:()=>Ki,Tremolo:()=>Qa,Unit:()=>eM,UserMedia:()=>Uo,Vibrato:()=>Za,Volume:()=>Oo,WaveShaper:()=>qo,Waveform:()=>Ka,Zero:()=>or,connect:()=>ro,connectSeries:()=>oo,connectSignal:()=>fo,context:()=>iB,dbToGain:()=>ji,debug:()=>eD,defaultArg:()=>pi,disconnect:()=>ao,fanIn:()=>co,ftom:()=>Bi,gainToDb:()=>Li,getContext:()=>Vi,getDestination:()=>wc,getDraw:()=>kc,getListener:()=>Tc,getTransport:()=>vc,immediate:()=>mc,intervalToFrequencyRatio:()=>zi,isArray:()=>Ln,isBoolean:()=>jn,isDefined:()=>In,isFunction:()=>Vn,isNote:()=>Wn,isNumber:()=>Nn,isObject:()=>Pn,isString:()=>zn,isUndef:()=>Fn,loaded:()=>Cc,mtof:()=>Gi,now:()=>_c,optionsFromArguments:()=>ui,setContext:()=>Ni,start:()=>Pi,supported:()=>qn,version:()=>eR});var f,_,m,O,I,V,F,P,te,ts,ti,tn,tl,th,tu,tp,td,tf,t_,tm,tg,tv,ty,tx,tb,tw,tT,tS,tk,tA,tC,tO,tD,tM,tR,tE,tq,tI,tV,tF,tN,tP,tj,tB,tL,tz,tW,tU,tZ,tG,tY,tX,tQ,tH,t$,tK,tJ,t0,t1,t2,t3,t4,t8,t6,t5,t9,t7,es,ei,en,er,el,eh,eu,ep,ed,ef,e_,em,eg,ev,ey,ex,eb,ew,eT,eS,ek,eA,eC,eO,eD={};s.r(eD),s.d(eD,{assert:()=>Bn,assertContextRunning:()=>Gn,assertRange:()=>Un,assertUsedScheduleTime:()=>Yn,enterScheduledCallback:()=>Xn,log:()=>Jn,setLogger:()=>Hn,warn:()=>Kn});var eM={};s.r(eM);let eR="14.9.17";var eE=s(382);let eq=new WeakSet,eI=new WeakMap,eV=new WeakMap,eF=new WeakMap,eN=new WeakMap,eP=new WeakMap,ej=new WeakMap,eB=new WeakMap,eL=new WeakMap,ez=new WeakMap,eW={construct:()=>eW},eU=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,v=(l,p)=>{let d=[],f=l.replace(/^[\s]+/,""),_=f.match(eU);for(;null!==_;){let l=_[1].slice(1,-1),m=_[0].replace(/([\s]+)?;?$/,"").replace(l,new URL(l,p).toString());d.push(m),_=(f=f.slice(_[0].length).replace(/^[\s]+/,"")).match(eU)}return[d.join(";"),f]},y=l=>{if(void 0!==l&&!Array.isArray(l))throw TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},x=l=>{if(!(l=>{try{new new Proxy(l,eW)}catch{return!1}return!0})(l))throw TypeError("The given value for processorCtor should be a constructor.");if(null===l.prototype||"object"!=typeof l.prototype)throw TypeError("The given value for processorCtor should have a prototype.")},w=(l,p)=>{let d=l.get(p);if(void 0===d)throw Error("A value with the given key could not be found.");return d},b=(l,p)=>{let d=Array.from(l).filter(p);if(d.length>1)throw Error("More than one element was found.");if(0===d.length)throw Error("No element was found.");let[f]=d;return l.delete(f),f},T=(l,p,d,f)=>{let _=w(l,p),m=b(_,l=>l[0]===d&&l[1]===f);return 0===_.size&&l.delete(p),m},S=l=>w(ej,l),k=l=>{if(eq.has(l))throw Error("The AudioNode is already stored.");eq.add(l),S(l).forEach(l=>l(!0))},A=l=>"port"in l,C=l=>{if(!eq.has(l))throw Error("The AudioNode is not stored.");eq.delete(l),S(l).forEach(l=>l(!1))},D=(l,p)=>{!A(l)&&p.every(l=>0===l.size)&&C(l)},eZ={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},M=(l,p)=>l.context===p,E=l=>{try{l.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},R=()=>new DOMException("","IndexSizeError"),q=l=>{var p;l.getChannelData=(p=l.getChannelData,d=>{try{return p.call(l,d)}catch(l){if(12===l.code)throw R();throw l}})},eG={numberOfChannels:1},N=l=>eq.has(l),eY={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},j=l=>w(eI,l),L=l=>w(eF,l),z=(l,p)=>{let{activeInputs:d}=j(l);d.forEach(d=>d.forEach(([d])=>{p.includes(l)||z(d,[...p,l])}));let f="playbackRate"in l?[l.playbackRate]:A(l)?Array.from(l.parameters.values()):"frequency"in l&&"gain"in l?[l.Q,l.detune,l.frequency,l.gain]:"offset"in l?[l.offset]:!("frequency"in l)&&"gain"in l?[l.gain]:"detune"in l&&"frequency"in l?[l.detune,l.frequency]:"pan"in l?[l.pan]:[];for(let l of f){let d=L(l);void 0!==d&&d.activeInputs.forEach(([l])=>z(l,p))}N(l)&&C(l)},W=l=>{z(l.destination,[])},B=l=>"context"in l,U=l=>B(l[0]),G=(l,p,d,f)=>{for(let p of l)if(d(p)){if(f)return!1;throw Error("The set contains at least one similar element.")}return l.add(p),!0},Q=(l,p,[d,f],_)=>{G(l,[p,d,f],l=>l[0]===p&&l[1]===d,_)},Z=(l,[p,d,f],_)=>{let m=l.get(p);void 0===m?l.set(p,new Set([[d,f]])):G(m,[d,f],l=>l[0]===d,_)},X=l=>"inputs"in l,Y=(l,p,d,f)=>{if(X(p)){let _=p.inputs[f];return l.connect(_,d,0),[_,d,0]}return l.connect(p,d,f),[p,d,f]},$=(l,p,d)=>{for(let f of l)if(f[0]===p&&f[1]===d)return l.delete(f),f;return null},H=(l,p)=>{if(!S(l).delete(p))throw Error("Missing the expected event listener.")},J=(l,p,d)=>{let f=w(l,p),_=b(f,l=>l[0]===d);return 0===f.size&&l.delete(p),_},K=(l,p,d,f)=>{X(p)?l.disconnect(p.inputs[f],d,0):l.disconnect(p,d,f)},tt=l=>w(eV,l),et=l=>w(eN,l),st=l=>eB.has(l),nt=l=>!eq.has(l),it=(l,p)=>new Promise(d=>{if(null!==p)d(!0);else{let p=l.createScriptProcessor(256,1,1),f=l.createGain(),_=l.createBuffer(1,2,44100),m=_.getChannelData(0);m[0]=1,m[1]=1;let O=l.createBufferSource();O.buffer=_,O.loop=!0,O.connect(p).connect(l.destination),O.connect(f),O.disconnect(f),p.onaudioprocess=f=>{let _=f.inputBuffer.getChannelData(0);Array.prototype.some.call(_,l=>1===l)?d(!0):d(!1),O.stop(),p.onaudioprocess=null,O.disconnect(p),p.disconnect(l.destination)},O.start()}}),ot=(l,p)=>{let d=new Map;for(let p of l)for(let l of p){let p=d.get(l);d.set(l,void 0===p?1:p+1)}d.forEach((l,d)=>p(d,l))},rt=l=>"context"in l,at=l=>{var p,d;let f=new Map;l.connect=(p=l.connect.bind(l),(l,d=0,_=0)=>{let m=rt(l)?p(l,d,_):p(l,d),O=f.get(l);return void 0===O?f.set(l,[{input:_,output:d}]):O.every(l=>l.input!==_||l.output!==d)&&O.push({input:_,output:d}),m}),l.disconnect=(d=l.disconnect,(p,_,m)=>{if(d.apply(l),void 0===p)f.clear();else if("number"==typeof p)for(let[l,d]of f){let _=d.filter(l=>l.output!==p);0===_.length?f.delete(l):f.set(l,_)}else if(f.has(p)){if(void 0===_)f.delete(p);else{let l=f.get(p);if(void 0!==l){let d=l.filter(l=>l.output!==_&&(l.input!==m||void 0===m));0===d.length?f.delete(p):f.set(p,d)}}}for(let[p,d]of f)d.forEach(d=>{rt(p)?l.connect(p,d.output,d.input):l.connect(p,d.output)})})},ct=(l,p,d,f,_)=>{let[m,O]=((l,p,d,f)=>{let{activeInputs:_,passiveInputs:m}=j(p),O=$(_[f],l,d);return null===O?[T(m,l,d,f)[2],!1]:[O[2],!0]})(l,d,f,_);if(null!==m&&(H(l,m),!O||p||st(l)||K(tt(l),tt(d),f,_)),N(d)){let{activeInputs:l}=j(d);D(d,l)}},ht=(l,p,d,f)=>{let[_,m]=((l,p,d)=>{let{activeInputs:f,passiveInputs:_}=L(p),m=$(f,l,d);return null===m?[J(_,l,d)[1],!1]:[m[2],!0]})(l,d,f);null!==_&&(H(l,_),!m||p||st(l)||tt(l).disconnect(et(d),f))};let lt=class lt{constructor(l){this._map=new Map(l)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(l,p=null){return this._map.forEach((d,f)=>l.call(p,d,f,this))}get(l){return this._map.get(l)}has(l){return this._map.has(l)}keys(){return this._map.keys()}values(){return this._map.values()}};let eX={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function pt(l,p,d,f,_){if("function"==typeof l.copyFromChannel)0===p[d].byteLength&&(p[d]=new Float32Array(128)),l.copyFromChannel(p[d],f,_);else{let m=l.getChannelData(f);if(0===p[d].byteLength)p[d]=m.slice(_,_+128);else{let l=new Float32Array(m.buffer,_*Float32Array.BYTES_PER_ELEMENT,128);p[d].set(l)}}}let dt=(l,p,d,f,_)=>{"function"==typeof l.copyToChannel?0!==p[d].byteLength&&l.copyToChannel(p[d],f,_):0!==p[d].byteLength&&l.getChannelData(f).set(p[d],_)},ft=(l,p)=>{let d=[];for(let f=0;f<l;f+=1){let l=[],_="number"==typeof p?p:p[f];for(let p=0;p<_;p+=1)l.push(new Float32Array(128));d.push(l)}return d},_t=async(l,p,d,f,_,m,O)=>{let I=null===p?128*Math.ceil(l.context.length/128):p.length,V=f.channelCount*f.numberOfInputs,F=_.reduce((l,p)=>l+p,0),P=0===F?null:d.createBuffer(F,I,d.sampleRate);if(void 0===m)throw Error("Missing the processor constructor.");let te=j(l),ts=await ((l,p)=>{let d=w(ez,l),f=tt(p);return w(d,f)})(d,l),ti=ft(f.numberOfInputs,f.channelCount),tn=ft(f.numberOfOutputs,_),tl=Array.from(l.parameters.keys()).reduce((l,p)=>({...l,[p]:new Float32Array(128)}),{});for(let F=0;F<I;F+=128){if(f.numberOfInputs>0&&null!==p)for(let l=0;l<f.numberOfInputs;l+=1)for(let d=0;d<f.channelCount;d+=1)pt(p,ti[l],d,d,F);void 0!==m.parameterDescriptors&&null!==p&&m.parameterDescriptors.forEach(({name:l},d)=>{pt(p,tl,l,V+d,F)});for(let l=0;l<f.numberOfInputs;l+=1)for(let p=0;p<_[l];p+=1)0===tn[l][p].byteLength&&(tn[l][p]=new Float32Array(128));try{let l=ti.map((l,p)=>0===te.activeInputs[p].size?[]:l),p=O(F/d.sampleRate,d.sampleRate,()=>ts.process(l,tn,tl));if(null!==P)for(let l=0,p=0;l<f.numberOfOutputs;l+=1){for(let d=0;d<_[l];d+=1)dt(P,tn[l],d,p+d,F);p+=_[l]}if(!p)break}catch(p){l.dispatchEvent(new ErrorEvent("processorerror",{colno:p.colno,filename:p.filename,lineno:p.lineno,message:p.message}));break}}return P},eQ={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},eH={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},e$={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},eK={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},eJ={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},wt=l=>{let{port1:p,port2:d}=new MessageChannel;return new Promise(f=>{let i=()=>{d.onmessage=null,p.close(),d.close(),f()};d.onmessage=()=>i();try{p.postMessage(l,[l])}catch{}finally{i()}})},e0={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Tt=(l,p,d)=>{let f=p[d];if(void 0===f)throw l();return f},e1={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},e2={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},At=()=>new DOMException("","InvalidStateError"),Ct=()=>new DOMException("","InvalidAccessError"),e3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},Ot=(l,p,d,f,_,m,O,I,V,F,P)=>{let te=F.length,ts=I;for(let I=0;I<te;I+=1){let te=d[0]*F[I];for(let p=1;p<_;p+=1){let f=ts-p&V-1;te+=d[p]*m[f],te-=l[p]*O[f]}for(let l=_;l<f;l+=1)te+=d[l]*m[ts-l&V-1];for(let d=_;d<p;d+=1)te-=l[d]*O[ts-d&V-1];m[ts]=F[I],O[ts]=te,ts=ts+1&V-1,P[I]=te}return ts},e4={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Et=l=>{let p=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{let d=l.decodeAudioData(p.buffer,()=>{});return void 0!==d&&(d.catch(()=>{}),!0)}catch{}return!1},Rt=(l,p,d)=>{let f=p[d];void 0!==f&&f!==l[d]&&(l[d]=f)},qt=(l,p)=>{Rt(l,p,"channelCount"),Rt(l,p,"channelCountMode"),Rt(l,p,"channelInterpretation")},Ft=l=>"function"==typeof l.getFloatTimeDomainData,It=(l,p,d)=>{let f=p[d];void 0!==f&&f!==l[d].value&&(l[d].value=f)},Vt=l=>{var p;l.start=(p=l.start,(d=0,f=0,_)=>{if("number"==typeof _&&_<0||f<0||d<0)throw RangeError("The parameters can't be negative.");p.call(l,d,f,_)})},Nt=l=>{var p;l.stop=(p=l.stop,(d=0)=>{if(d<0)throw RangeError("The parameter can't be negative.");p.call(l,d)})},Pt=(l,p)=>null===l?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(l*p))))),jt=(l,p)=>{let d=l.createBiquadFilter();return qt(d,p),It(d,p,"Q"),It(d,p,"detune"),It(d,p,"frequency"),It(d,p,"gain"),Rt(d,p,"type"),d},Lt=(l,p)=>{let d=l.createChannelSplitter(p.numberOfOutputs);return qt(d,p),(l=>{let p=l.numberOfOutputs;Object.defineProperty(l,"channelCount",{get:()=>p,set:l=>{if(l!==p)throw At()}}),Object.defineProperty(l,"channelCountMode",{get:()=>"explicit",set:l=>{if("explicit"!==l)throw At()}}),Object.defineProperty(l,"channelInterpretation",{get:()=>"discrete",set:l=>{if("discrete"!==l)throw At()}})})(d),d},zt=(l,p)=>(l.connect=p.connect.bind(p),l.disconnect=p.disconnect.bind(p),l),Wt=(l,p)=>{let d=l.createDelay(p.maxDelayTime);return qt(d,p),It(d,p,"delayTime"),d},Bt=(l,p)=>{let d=l.createGain();return qt(d,p),It(d,p,"gain"),d};function Gt(l,p){var d;let f=[0,0];for(let _=l.length-1;_>=0;_-=1)f=[(d=f)[0]*p[0]-d[1]*p[1],d[0]*p[1]+d[1]*p[0]],f[0]+=l[_];return f}let Qt=(l,p,d,f)=>l.createScriptProcessor(p,d,f),Zt=()=>new DOMException("","NotSupportedError"),e8={numberOfChannels:1},e6={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},e5={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},e9={disableNormalization:!1},e7={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},ss={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},ee=(l,p,d)=>void 0===l.copyFromChannel?l.getChannelData(d)[0]:(l.copyFromChannel(p,d),p[0]),se=l=>{if(null===l)return!1;let p=l.length;return p%2!=0?0!==l[Math.floor(p/2)]:l[p/2-1]+l[p/2]!==0},ne=(l,p,d,f)=>{let _=l;for(;!_.hasOwnProperty(p);)_=Object.getPrototypeOf(_);let{get:m,set:O}=Object.getOwnPropertyDescriptor(_,p);Object.defineProperty(l,p,{get:d(m),set:f(O)})},ie=(l,p,d)=>{try{l.setValueAtTime(p,d)}catch(f){if(9!==f.code)throw f;ie(l,p,d+1e-7)}},oe=l=>{let p=l.createOscillator();try{p.start(-1)}catch(l){return l instanceof RangeError}return!1},re=l=>{let p=l.createBuffer(1,1,44100),d=l.createBufferSource();d.buffer=p,d.start(),d.stop();try{return d.stop(),!0}catch{return!1}},ae=l=>{let p=l.createOscillator();try{p.stop(-1)}catch(l){return l instanceof RangeError}return!1},ce=()=>{try{new DOMException}catch{return!1}return!0},he=()=>new Promise(l=>{let p=new ArrayBuffer(0),{port1:d,port2:f}=new MessageChannel;d.onmessage=({data:p})=>l(null!==p),f.postMessage(p,[p])}),le=(l,p)=>{var d,f;let _;let m=p.createGain();l.connect(m);let O=(d=l.disconnect,()=>{d.call(l,m),l.removeEventListener("ended",O)});l.addEventListener("ended",O),zt(l,m),l.stop=(f=l.stop,_=!1,(p=0)=>{if(_)try{f.call(l,p)}catch{m.gain.setValueAtTime(0,p)}else f.call(l,p),_=!0})},ue=(l,p)=>d=>{let f={value:l};return Object.defineProperties(d,{currentTarget:f,target:f}),"function"==typeof p?p.call(l,d):p.handleEvent.call(l,d)},sn=new WeakMap,sl=(eA=new Map,eC=new WeakMap,(l,p)=>{let d=eC.get(l);if(void 0!==d)return d;let f=eA.get(l);if(void 0!==f)return f;try{let d=p();return d instanceof Promise?(eA.set(l,d),d.catch(()=>!1).then(p=>(eA.delete(l),eC.set(l,p),p))):(eC.set(l,d),d)}catch{return eC.set(l,!1),!1}}),sh="undefined"==typeof window?null:window,we=(l,p)=>{let d=l.createAnalyser();if(qt(d,p),!(p.maxDecibels>p.minDecibels))throw R();return Rt(d,p,"fftSize"),Rt(d,p,"maxDecibels"),Rt(d,p,"minDecibels"),Rt(d,p,"smoothingTimeConstant"),sl(Ft,()=>Ft(d))||(d.getFloatTimeDomainData=l=>{let p=new Uint8Array(l.length);d.getByteTimeDomainData(p);let f=Math.max(p.length,d.fftSize);for(let d=0;d<f;d+=1)l[d]=.0078125*(p[d]-128);return l}),d},be=l=>{let p=j(l);if(null===p.renderer)throw Error("Missing the renderer of the given AudioNode in the audio graph.");return p.renderer},Te=async(l,p,d)=>{let f=j(l);await Promise.all(f.activeInputs.map((f,_)=>Array.from(f).map(async([f,m])=>{let O=be(f),I=await O.render(f,p),V=l.context.destination;st(f)||l===V&&st(l)||I.connect(d,m,_)})).reduce((l,p)=>[...l,...p],[]))},ke=l=>{let p=eP.get(l);if(void 0===p)throw At();return p},su=null===sh?null:sh.hasOwnProperty("OfflineAudioContext")?sh.OfflineAudioContext:sh.hasOwnProperty("webkitOfflineAudioContext")?sh.webkitOfflineAudioContext:null,De=l=>null!==su&&l instanceof su,sp=new WeakMap,sd=class{constructor(l){this._nativeEventTarget=l,this._listeners=new WeakMap}addEventListener(l,p,d){if(null!==p){let f=this._listeners.get(p);void 0===f&&(f=ue(this,p),"function"==typeof p&&this._listeners.set(p,f)),this._nativeEventTarget.addEventListener(l,f,d)}}dispatchEvent(l){return this._nativeEventTarget.dispatchEvent(l)}removeEventListener(l,p,d){let f=null===p?void 0:this._listeners.get(p);this._nativeEventTarget.removeEventListener(l,void 0===f?null:f,d)}},sf=null===sh?null:sh.hasOwnProperty("AudioContext")?sh.AudioContext:sh.hasOwnProperty("webkitAudioContext")?sh.webkitAudioContext:null,Re=l=>null!==sf&&l instanceof sf,qe=l=>null!==sh&&"function"==typeof sh.AudioNode&&l instanceof sh.AudioNode,Fe=l=>null!==sh&&"function"==typeof sh.AudioParam&&l instanceof sh.AudioParam,s_=null===sh?null:sh.hasOwnProperty("AudioWorkletNode")?sh.AudioWorkletNode:null,sm=(f=(l,p,d)=>{let f=[];for(let l=0;l<d.numberOfInputs;l+=1)f.push(new Set);eI.set(l,{activeInputs:f,outputs:new Set,passiveInputs:new WeakMap,renderer:p})},_=((l,p,d,f,_,m,O,I,V,F,P,te,ts)=>{let ti=new WeakMap;return(tn,tl,th,tu,tp)=>{let{activeInputs:td,passiveInputs:tf}=m(tl),{outputs:t_}=m(tn),tm=I(tn),S=m=>{let I=V(tl),F=V(tn);if(m){let p=T(tf,tn,th,tu);l(td,tn,p,!1),tp||te(tn)||d(F,I,th,tu),ts(tl)&&k(tl)}else{let l=f(td,tn,th,tu);p(tf,tu,l,!1),tp||te(tn)||_(F,I,th,tu);let d=O(tl);if(0===d)P(tl)&&D(tl,td);else{let l=ti.get(tl);void 0!==l&&clearTimeout(l),ti.set(tl,setTimeout(()=>{P(tl)&&D(tl,td)},1e3*d))}}};return!!F(t_,[tl,th,tu],l=>l[0]===tl&&l[1]===th&&l[2]===tu,!0)&&(tm.add(S),P(tn)?l(td,tn,[th,tu,S],!0):p(tf,tu,[tn,th,S],!0),!0)}})((l,p,[d,f,_],m)=>{G(l[f],[p,d,_],l=>l[0]===p&&l[1]===d,m)},(l,p,[d,f,_],m)=>{let O=l.get(d);void 0===O?l.set(d,new Set([[f,p,_]])):G(O,[f,p,_],l=>l[0]===f&&l[1]===p,m)},Y,(l,p,d,f)=>b(l[f],l=>l[0]===p&&l[1]===d),K,j,l=>{var p;return null!==(p=sn.get(l))&&void 0!==p?p:0},S,tt,G,N,st,nt),m=l=>(p,d)=>{let f=eB.get(p);if(void 0===f){if(!l&&N(p)){let l=tt(p),{outputs:d}=j(p);for(let p of d)if(U(p)){let d=tt(p[0]);K(l,d,p[1],p[2])}else{let d=et(p[0]);l.disconnect(d,p[1])}}eB.set(p,d)}else eB.set(p,f+d)},O=(l,p)=>{let d=eB.get(l);if(void 0===d)throw Error("Missing the expected cycle count.");let f=ke(l.context),_=De(f);if(d===p){if(eB.delete(l),!_&&N(l)){let p=tt(l),{outputs:d}=j(l);for(let l of d)if(U(l)){let d=tt(l[0]);Y(p,d,l[1],l[2])}else{let d=et(l[0]);p.connect(d,l[1])}}}else eB.set(l,d-p)},I=function n(l,p){let d=B(p)?p:w(sp,p);if("delayTime"in d)return[];if(l[0]===d)return[l];if(l.includes(d))return[];let{outputs:f}=j(d);return Array.from(f).map(p=>n([...l,d],p[0])).reduce((l,p)=>l.concat(p),[])},V=sd,class extends V{constructor(l,p,d,_){super(d),this._context=l,this._nativeAudioNode=d;let m=ke(l);Re(m)&&!0!==sl(it,()=>it(m,s_))&&at(d),eV.set(this,d),ej.set(this,new Set),"closed"!==l.state&&p&&k(this),f(this,_,d)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(l){this._nativeAudioNode.channelCount=l}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(l){this._nativeAudioNode.channelCountMode=l}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(l){this._nativeAudioNode.channelInterpretation=l}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(l,p=0,d=0){if(p<0||p>=this._nativeAudioNode.numberOfOutputs)throw R();let f=ke(this._context),O=De(f);if(qe(l)||Fe(l))throw Ct();if(B(l)){let f=tt(l);try{let _=Y(this._nativeAudioNode,f,p,d),m=nt(this);(O||m)&&this._nativeAudioNode.disconnect(..._),"closed"!==this.context.state&&!m&&nt(l)&&k(l)}catch(l){if(12===l.code)throw Ct();throw l}if(_(this,l,p,d,O)){let p=I([this],l);ot(p,m(O))}return l}let V=et(l);if("playbackRate"===V.name&&1024===V.maxValue)throw Zt();try{this._nativeAudioNode.connect(V,p),(O||nt(this))&&this._nativeAudioNode.disconnect(V,p)}catch(l){if(12===l.code)throw Ct();throw l}if(((l,p,d,f)=>{let{activeInputs:_,passiveInputs:m}=L(p),{outputs:O}=j(l),I=S(l),c=O=>{let I=tt(l),V=et(p);if(O){let p=J(m,l,d);Q(_,l,p,!1),f||st(l)||I.connect(V,d)}else{let p=b(_,p=>p[0]===l&&p[1]===d);Z(m,p,!1),f||st(l)||I.disconnect(V,d)}};return!!G(O,[p,d],l=>l[0]===p&&l[1]===d,!0)&&(I.add(c),N(l)?Q(_,l,[d,c],!0):Z(m,[l,d,c],!0),!0)})(this,l,p,O)){let p=I([this],l);ot(p,m(O))}}disconnect(l,p,d){let f;let _=ke(this._context),m=De(_);if(void 0===l)f=((l,p)=>{let d=j(l),f=[];for(let _ of d.outputs)U(_)?ct(l,p,..._):ht(l,p,..._),f.push(_[0]);return d.outputs.clear(),f})(this,m);else if("number"==typeof l){if(l<0||l>=this.numberOfOutputs)throw R();f=((l,p,d)=>{let f=j(l),_=[];for(let m of f.outputs)m[1]===d&&(U(m)?ct(l,p,...m):ht(l,p,...m),_.push(m[0]),f.outputs.delete(m));return _})(this,m,l)}else{if(void 0!==p&&(p<0||p>=this.numberOfOutputs)||B(l)&&void 0!==d&&(d<0||d>=l.numberOfInputs))throw R();if(0===(f=((l,p,d,f,_)=>{let m=j(l);return Array.from(m.outputs).filter(l=>!(l[0]!==d||void 0!==f&&l[1]!==f||void 0!==_&&l[2]!==_)).map(d=>(U(d)?ct(l,p,...d):ht(l,p,...d),m.outputs.delete(d),d[0]))})(this,m,l,p,d)).length)throw Ct()}for(let l of f){let p=I([this],l);ot(p,O)}}}),sg=(F=sm,P=()=>{let l=new WeakMap;return{render(p,d){let f=l.get(d);return void 0!==f?Promise.resolve(f):(async(p,d)=>{let f=tt(p);if(!M(f,d)){let l={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,fftSize:f.fftSize,maxDecibels:f.maxDecibels,minDecibels:f.minDecibels,smoothingTimeConstant:f.smoothingTimeConstant};f=we(d,l)}return l.set(d,f),await Te(p,d,f),f})(p,d)}}},class extends F{constructor(l,p){let d=ke(l),f={...eZ,...p},_=we(d,f);super(l,!1,_,De(d)?P():null),this._nativeAnalyserNode=_}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(l){this._nativeAnalyserNode.fftSize=l}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(l){let p=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=l,!(l>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=p,R()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(l){let p=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=l,!(this._nativeAnalyserNode.maxDecibels>l))throw this._nativeAnalyserNode.minDecibels=p,R()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(l){this._nativeAnalyserNode.smoothingTimeConstant=l}getByteFrequencyData(l){this._nativeAnalyserNode.getByteFrequencyData(l)}getByteTimeDomainData(l){this._nativeAnalyserNode.getByteTimeDomainData(l)}getFloatFrequencyData(l){this._nativeAnalyserNode.getFloatFrequencyData(l)}getFloatTimeDomainData(l){this._nativeAnalyserNode.getFloatTimeDomainData(l)}}),sv=new WeakSet,sy=null===sh?null:sh.hasOwnProperty("AudioBuffer")?sh.AudioBuffer:null,sx=(eO=new Uint32Array(1),l=>(eO[0]=l,eO[0])),Be=l=>{l.copyFromChannel=(p,d,f=0)=>{let _=sx(f),m=sx(d);if(m>=l.numberOfChannels)throw R();let O=l.length,I=l.getChannelData(m),V=p.length;for(let l=_<0?-_:0;l+_<O&&l<V;l+=1)p[l]=I[l+_]},l.copyToChannel=(p,d,f=0)=>{let _=sx(f),m=sx(d);if(m>=l.numberOfChannels)throw R();let O=l.length,I=l.getChannelData(m),V=p.length;for(let l=_<0?-_:0;l+_<O&&l<V;l+=1)I[l+_]=p[l]}},Ue=l=>{var p,d;l.copyFromChannel=(p=l.copyFromChannel,(d,f,_=0)=>{let m=sx(_),O=sx(f);if(m<l.length)return p.call(l,d,O,m)}),l.copyToChannel=(d=l.copyToChannel,(p,f,_=0)=>{let m=sx(_),O=sx(f);if(m<l.length)return d.call(l,p,O,m)})},sb=(te=()=>{if(null===sy)return!1;try{new sy({length:1,sampleRate:44100})}catch{return!1}return!0},l=null,class h{constructor(p){if(null===su)throw Error("Missing the native OfflineAudioContext constructor.");let{length:d,numberOfChannels:f,sampleRate:_}={...eG,...p};null===l&&(l=new su(1,1,44100));let m=null!==sy&&sl(te,te)?new sy({length:d,numberOfChannels:f,sampleRate:_}):l.createBuffer(f,d,_);if(0===m.numberOfChannels)throw Zt();return"function"!=typeof m.copyFromChannel?(Be(m),q(m)):sl(E,()=>E(m))||Ue(m),sv.add(m),m}static[Symbol.hasInstance](l){return null!==l&&"object"==typeof l&&Object.getPrototypeOf(l)===h.prototype||sv.has(l)}}),Qe=(l,p)=>{let d=Bt(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});p.connect(d).connect(l.destination);let i=()=>{p.removeEventListener("ended",i),p.disconnect(d),d.disconnect()};p.addEventListener("ended",i)},Ze=async(l,p,d)=>{let f=L(l);await Promise.all(Array.from(f.activeInputs).map(async([l,f])=>{let _=be(l),m=await _.render(l,p);st(l)||m.connect(d,f)}))},Xe=(l,p,d)=>Ze(p,l,d),sw=(ts=l=>{let p=l.createBufferSource();p.start();try{p.start()}catch{return!0}return!1},ti=l=>{let p=l.createBufferSource(),d=l.createBuffer(1,1,44100);p.buffer=d;try{p.start(0,1)}catch{return!1}return!0},tn=l=>{let p=l.createBufferSource();p.start();try{p.stop()}catch{return!1}return!0},tl=(l,p)=>{let d=p.createBuffer(1,1,44100);null===l.buffer&&(l.buffer=d),ne(l,"buffer",p=>()=>{let f=p.call(l);return f===d?null:f},p=>f=>p.call(l,null===f?d:f))},(l,p)=>{var d,f;let _;let m=l.createBufferSource();return qt(m,p),It(m,p,"playbackRate"),Rt(m,p,"buffer"),Rt(m,p,"loop"),Rt(m,p,"loopEnd"),Rt(m,p,"loopStart"),sl(ts,()=>ts(l))||(m.start=(d=m.start,_=!1,(l=0,p=0,f)=>{if(_)throw At();d.call(m,l,p,f),_=!0})),sl(ti,()=>ti(l))||(m.start=(f=m.start,(l=0,p=0,d)=>{let _=m.buffer,O=null===_?p:Math.min(_.duration,p);null!==_&&O>_.duration-.5/m.context.sampleRate?f.call(m,l,0,0):f.call(m,l,O,d)})),sl(tn,()=>tn(l))||tl(m,l),sl(oe,()=>oe(l))||Vt(m),sl(re,()=>re(l))||le(m,l),sl(ae,()=>ae(l))||Nt(m),Qe(l,m),m}),sT=(th=l=>{let p=L(l);if(null===p.renderer)throw Error("Missing the renderer of the given AudioParam in the audio graph.");return p.renderer},(l,p,d)=>(th(p).replay(d),Ze(p,l,d))),sS=(tu=(l,p)=>{eF.set(l,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:p})},tp=eE.createCancelAndHoldAutomationEvent,td=eE.createCancelScheduledValuesAutomationEvent,tf=eE.createExponentialRampToValueAutomationEvent,t_=eE.createLinearRampToValueAutomationEvent,tm=eE.createSetTargetAutomationEvent,tg=eE.createSetValueAutomationEvent,tv=eE.createSetValueCurveAutomationEvent,(l,p,d,f=null,_=null)=>{let m=d.value,O=new eE.AutomationEventList(m),I=p?{replay(l){for(let p of O)if("exponentialRampToValue"===p.type){let{endTime:d,value:f}=p;l.exponentialRampToValueAtTime(f,d)}else if("linearRampToValue"===p.type){let{endTime:d,value:f}=p;l.linearRampToValueAtTime(f,d)}else if("setTarget"===p.type){let{startTime:d,target:f,timeConstant:_}=p;l.setTargetAtTime(f,d,_)}else if("setValue"===p.type){let{startTime:d,value:f}=p;l.setValueAtTime(f,d)}else{if("setValueCurve"!==p.type)throw Error("Can't apply an unknown automation.");{let{duration:d,startTime:f,values:_}=p;l.setValueCurveAtTime(_,f,d)}}}}:null,V={get defaultValue(){return m},get maxValue(){return null===f?d.maxValue:f},get minValue(){return null===_?d.minValue:_},get value(){return d.value},set value(t){d.value=t,V.setValueAtTime(t,l.context.currentTime)},cancelAndHoldAtTime(p){if("function"==typeof d.cancelAndHoldAtTime)null===I&&O.flush(l.context.currentTime),O.add(tp(p)),d.cancelAndHoldAtTime(p);else{let f=Array.from(O).pop();null===I&&O.flush(l.context.currentTime),O.add(tp(p));let _=Array.from(O).pop();d.cancelScheduledValues(p),f!==_&&void 0!==_&&("exponentialRampToValue"===_.type?d.exponentialRampToValueAtTime(_.value,_.endTime):"linearRampToValue"===_.type?d.linearRampToValueAtTime(_.value,_.endTime):"setValue"===_.type?d.setValueAtTime(_.value,_.startTime):"setValueCurve"===_.type&&d.setValueCurveAtTime(_.values,_.startTime,_.duration))}return V},cancelScheduledValues:p=>(null===I&&O.flush(l.context.currentTime),O.add(td(p)),d.cancelScheduledValues(p),V),exponentialRampToValueAtTime(p,f){if(0===p||!Number.isFinite(f)||f<0)throw RangeError();let _=l.context.currentTime;return null===I&&O.flush(_),0===Array.from(O).length&&(O.add(tg(m,_)),d.setValueAtTime(m,_)),O.add(tf(p,f)),d.exponentialRampToValueAtTime(p,f),V},linearRampToValueAtTime(p,f){let _=l.context.currentTime;return null===I&&O.flush(_),0===Array.from(O).length&&(O.add(tg(m,_)),d.setValueAtTime(m,_)),O.add(t_(p,f)),d.linearRampToValueAtTime(p,f),V},setTargetAtTime:(p,f,_)=>(null===I&&O.flush(l.context.currentTime),O.add(tm(p,f,_)),d.setTargetAtTime(p,f,_),V),setValueAtTime:(p,f)=>(null===I&&O.flush(l.context.currentTime),O.add(tg(p,f)),d.setValueAtTime(p,f),V),setValueCurveAtTime(p,f,_){let m=p instanceof Float32Array?p:new Float32Array(p);if(null!==sf&&"webkitAudioContext"===sf.name){let p=f+_,F=l.context.sampleRate,P=Math.ceil(f*F),te=Math.floor(p*F),ts=te-P,ti=new Float32Array(ts);for(let l=0;l<ts;l+=1){let p=(m.length-1)/_*((P+l)/F-f),d=Math.floor(p),O=Math.ceil(p);ti[l]=d===O?m[d]:(1-(p-d))*m[d]+(1-(O-p))*m[O]}null===I&&O.flush(l.context.currentTime),O.add(tv(ti,f,_)),d.setValueCurveAtTime(ti,f,_);let tn=te/F;tn<p&&ie(V,ti[ti.length-1],tn),ie(V,m[m.length-1],p)}else null===I&&O.flush(l.context.currentTime),O.add(tv(m,f,_)),d.setValueCurveAtTime(m,f,_);return V}};return eN.set(V,d),sp.set(V,l),tu(V,I),V}),sk=(ty=sm,tx=()=>{let l=new WeakMap,p=null,d=null;return{set start(t){p=t},set stop(t){d=t},render(f,_){let m=l.get(_);return void 0!==m?Promise.resolve(m):(async(f,_)=>{let m=tt(f),O=M(m,_);if(!O){let l={buffer:m.buffer,channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,loop:m.loop,loopEnd:m.loopEnd,loopStart:m.loopStart,playbackRate:m.playbackRate.value};m=sw(_,l),null!==p&&m.start(...p),null!==d&&m.stop(d)}return l.set(_,m),O?await Xe(_,f.playbackRate,m.playbackRate):await sT(_,f.playbackRate,m.playbackRate),await Te(f,_,m),m})(f,_)}}},class extends ty{constructor(l,p){let d=ke(l),f={...eY,...p},_=sw(d,f),m=De(d),O=m?tx():null;super(l,!1,_,O),this._audioBufferSourceNodeRenderer=O,this._isBufferNullified=!1,this._isBufferSet=null!==f.buffer,this._nativeAudioBufferSourceNode=_,this._onended=null,this._playbackRate=sS(this,m,_.playbackRate,34028234663852886e22,-34028234663852886e22)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(l){if(this._nativeAudioBufferSourceNode.buffer=l,null!==l){if(this._isBufferSet)throw At();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(l){this._nativeAudioBufferSourceNode.loop=l}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(l){this._nativeAudioBufferSourceNode.loopEnd=l}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(l){this._nativeAudioBufferSourceNode.loopStart=l}get onended(){return this._onended}set onended(l){let p="function"==typeof l?ue(this,l):null;this._nativeAudioBufferSourceNode.onended=p;let d=this._nativeAudioBufferSourceNode.onended;this._onended=null!==d&&d===p?l:d}get playbackRate(){return this._playbackRate}start(l=0,p=0,d){if(this._nativeAudioBufferSourceNode.start(l,p,d),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===d?[l,p]:[l,p,d]),"closed"!==this.context.state){k(this);let t=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",t),N(this)&&C(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",t)}}stop(l=0){this._nativeAudioBufferSourceNode.stop(l),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=l)}}),sA=(tb=sm,tw=(l,p,d)=>{let f=l.destination;if(f.channelCount!==p)try{f.channelCount=p}catch{}d&&"explicit"!==f.channelCountMode&&(f.channelCountMode="explicit"),0===f.maxChannelCount&&Object.defineProperty(f,"maxChannelCount",{value:p});let _=Bt(l,{channelCount:p,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,gain:1});return ne(_,"channelCount",l=>()=>l.call(_),l=>p=>{l.call(_,p);try{f.channelCount=p}catch(l){if(p>f.maxChannelCount)throw l}}),ne(_,"channelCountMode",l=>()=>l.call(_),l=>p=>{l.call(_,p),f.channelCountMode=p}),ne(_,"channelInterpretation",l=>()=>l.call(_),l=>p=>{l.call(_,p),f.channelInterpretation=p}),Object.defineProperty(_,"maxChannelCount",{get:()=>f.maxChannelCount}),_.connect(f),_},class extends tb{constructor(l,p){let d=ke(l),f=De(d),_=tw(d,p,f);super(l,!1,_,f?(l=>{let p=new WeakMap;return{render(d,f){let _=p.get(f);return void 0!==_?Promise.resolve(_):(async(d,f)=>{let _=f.destination;return p.set(f,_),await l(d,f,_),_})(d,f)}}})(Te):null),this._isNodeOfNativeOfflineAudioContext=f,this._nativeAudioDestinationNode=_}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(l){if(this._isNodeOfNativeOfflineAudioContext)throw At();if(l>this._nativeAudioDestinationNode.maxChannelCount)throw R();this._nativeAudioDestinationNode.channelCount=l}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(l){if(this._isNodeOfNativeOfflineAudioContext)throw At();this._nativeAudioDestinationNode.channelCountMode=l}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}}),ns=(l,p)=>sn.set(l,p),sC=(tT=sm,tS=()=>{let l=new WeakMap;return{render(p,d){let f=l.get(d);return void 0!==f?Promise.resolve(f):(async(p,d)=>{let f=tt(p),_=M(f,d);if(!_){let l={Q:f.Q.value,channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,gain:f.gain.value,type:f.type};f=jt(d,l)}return l.set(d,f),_?(await Xe(d,p.Q,f.Q),await Xe(d,p.detune,f.detune),await Xe(d,p.frequency,f.frequency),await Xe(d,p.gain,f.gain)):(await sT(d,p.Q,f.Q),await sT(d,p.detune,f.detune),await sT(d,p.frequency,f.frequency),await sT(d,p.gain,f.gain)),await Te(p,d,f),f})(p,d)}}},class extends tT{constructor(l,p){let d=ke(l),f={...eQ,...p},_=jt(d,f),m=De(d);super(l,!1,_,m?tS():null),this._Q=sS(this,m,_.Q,34028234663852886e22,-34028234663852886e22),this._detune=sS(this,m,_.detune,1200*Math.log2(34028234663852886e22),-1200*Math.log2(34028234663852886e22)),this._frequency=sS(this,m,_.frequency,l.sampleRate/2,0),this._gain=sS(this,m,_.gain,40*Math.log10(34028234663852886e22),-34028234663852886e22),this._nativeBiquadFilterNode=_,ns(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(l){this._nativeBiquadFilterNode.type=l}getFrequencyResponse(l,p,d){try{this._nativeBiquadFilterNode.getFrequencyResponse(l,p,d)}catch(l){if(11===l.code)throw Ct();throw l}if(l.length!==p.length||p.length!==d.length)throw Ct()}}),os=(l,p,d)=>{var f,_;let m=new Set;return l.connect=(f=l.connect,(d,_=0,O=0)=>{let I=0===m.size;if(qe(d))return f.call(l,d,_,O),G(m,[d,_,O],l=>l[0]===d&&l[1]===_&&l[2]===O,!0),I&&p(),d;f.call(l,d,_),G(m,[d,_],l=>l[0]===d&&l[1]===_,!0),I&&p()}),l.disconnect=(_=l.disconnect,(p,f,O)=>{let I=m.size>0;if(void 0===p)_.apply(l),m.clear();else if("number"==typeof p)for(let d of(_.call(l,p),m))d[1]===p&&m.delete(d);else for(let d of(qe(p)?_.call(l,p,f,O):_.call(l,p,f),m))d[0]!==p||void 0!==f&&d[1]!==f||void 0!==O&&d[2]!==O||m.delete(d);let V=0===m.size;I&&V&&d()}),l},sO=(tk=(l,p)=>{p.channelCount=1,p.channelCountMode="explicit",Object.defineProperty(p,"channelCount",{get:()=>1,set:()=>{throw At()}}),Object.defineProperty(p,"channelCountMode",{get:()=>"explicit",set:()=>{throw At()}});let d=l.createBufferSource();os(p,()=>{let l=p.numberOfInputs;for(let f=0;f<l;f+=1)d.connect(p,0,f)},()=>d.disconnect(p))},(l,p)=>{let d=l.createChannelMerger(p.numberOfInputs);return null!==sf&&"webkitAudioContext"===sf.name&&tk(l,d),qt(d,p),d}),sD=(tA=sm,tC=()=>{let l=new WeakMap;return{render(p,d){let f=l.get(d);return void 0!==f?Promise.resolve(f):(async(p,d)=>{let f=tt(p);if(!M(f,d)){let l={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,numberOfInputs:f.numberOfInputs};f=sO(d,l)}return l.set(d,f),await Te(p,d,f),f})(p,d)}}},class extends tA{constructor(l,p){let d=ke(l),f={...eH,...p};super(l,!1,sO(d,f),De(d)?tC():null)}}),sM=(tO=sm,tD=()=>{let l=new WeakMap;return{render(p,d){let f=l.get(d);return void 0!==f?Promise.resolve(f):(async(p,d)=>{let f=tt(p);if(!M(f,d)){let l={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,numberOfOutputs:f.numberOfOutputs};f=Lt(d,l)}return l.set(d,f),await Te(p,d,f),f})(p,d)}}},class extends tO{constructor(l,p){var d;let f=ke(l),_={...d={...e$,...p},channelCount:d.numberOfOutputs};super(l,!1,Lt(f,_),De(f)?tD():null)}}),sR=(tM=(l,{offset:p,...d})=>{let f=l.createBuffer(1,2,44100),_=sw(l,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),m=Bt(l,{...d,gain:p}),O=f.getChannelData(0);return O[0]=1,O[1]=1,_.buffer=f,_.loop=!0,Qe(l,_),os(zt({get bufferSize(){},get channelCount(){return m.channelCount},set channelCount(t){m.channelCount=t},get channelCountMode(){return m.channelCountMode},set channelCountMode(t){m.channelCountMode=t},get channelInterpretation(){return m.channelInterpretation},set channelInterpretation(t){m.channelInterpretation=t},get context(){return m.context},get inputs(){return[]},get numberOfInputs(){return _.numberOfInputs},get numberOfOutputs(){return m.numberOfOutputs},get offset(){return m.gain},get onended(){return _.onended},set onended(t){_.onended=t},addEventListener:(...l)=>_.addEventListener(l[0],l[1],l[2]),dispatchEvent:(...l)=>_.dispatchEvent(l[0]),removeEventListener:(...l)=>_.removeEventListener(l[0],l[1],l[2]),start(l=0){_.start.call(_,l)},stop(l=0){_.stop.call(_,l)}},m),()=>_.connect(m),()=>_.disconnect(m))},(l,p)=>{if(void 0===l.createConstantSource)return tM(l,p);let d=l.createConstantSource();return qt(d,p),It(d,p,"offset"),sl(oe,()=>oe(l))||Vt(d),sl(ae,()=>ae(l))||Nt(d),Qe(l,d),d}),sE=(tR=sm,tE=()=>{let l=new WeakMap,p=null,d=null;return{set start(t){p=t},set stop(t){d=t},render(f,_){let m=l.get(_);return void 0!==m?Promise.resolve(m):(async(f,_)=>{let m=tt(f),O=M(m,_);if(!O){let l={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,offset:m.offset.value};m=sR(_,l),null!==p&&m.start(p),null!==d&&m.stop(d)}return l.set(_,m),O?await Xe(_,f.offset,m.offset):await sT(_,f.offset,m.offset),await Te(f,_,m),m})(f,_)}}},class extends tR{constructor(l,p){let d=ke(l),f={...eK,...p},_=sR(d,f),m=De(d),O=m?tE():null;super(l,!1,_,O),this._constantSourceNodeRenderer=O,this._nativeConstantSourceNode=_,this._offset=sS(this,m,_.offset,34028234663852886e22,-34028234663852886e22),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(l){let p="function"==typeof l?ue(this,l):null;this._nativeConstantSourceNode.onended=p;let d=this._nativeConstantSourceNode.onended;this._onended=null!==d&&d===p?l:d}start(l=0){if(this._nativeConstantSourceNode.start(l),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=l),"closed"!==this.context.state){k(this);let t=()=>{this._nativeConstantSourceNode.removeEventListener("ended",t),N(this)&&C(this)};this._nativeConstantSourceNode.addEventListener("ended",t)}}stop(l=0){this._nativeConstantSourceNode.stop(l),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=l)}}),ms=(l,p)=>{let d=l.createConvolver();if(qt(d,p),p.disableNormalization===d.normalize&&(d.normalize=!p.disableNormalization),Rt(d,p,"buffer"),p.channelCount>2||(ne(d,"channelCount",l=>()=>l.call(d),l=>p=>{if(p>2)throw Zt();return l.call(d,p)}),"max"===p.channelCountMode))throw Zt();return ne(d,"channelCountMode",l=>()=>l.call(d),l=>p=>{if("max"===p)throw Zt();return l.call(d,p)}),d},sq=(tq=sm,tI=()=>{let l=new WeakMap;return{render(p,d){let f=l.get(d);return void 0!==f?Promise.resolve(f):(async(p,d)=>{let f=tt(p);if(!M(f,d)){let l={buffer:f.buffer,channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,disableNormalization:!f.normalize};f=ms(d,l)}return l.set(d,f),X(f)?await Te(p,d,f.inputs[0]):await Te(p,d,f),f})(p,d)}}},class extends tq{constructor(l,p){let d=ke(l),f={...eJ,...p},_=ms(d,f);super(l,!1,_,De(d)?tI():null),this._isBufferNullified=!1,this._nativeConvolverNode=_,null!==f.buffer&&ns(this,f.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(l){if(this._nativeConvolverNode.buffer=l,null===l&&null!==this._nativeConvolverNode.buffer){let l=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=l.createBuffer(1,1,l.sampleRate),this._isBufferNullified=!0,ns(this,0)}else this._isBufferNullified=!1,ns(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(l){this._nativeConvolverNode.normalize=l}}),sI=(tV=sm,tF=l=>{let p=new WeakMap;return{render(d,f){let _=p.get(f);return void 0!==_?Promise.resolve(_):(async(d,f)=>{let _=tt(d),m=M(_,f);if(!m){let p={channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,delayTime:_.delayTime.value,maxDelayTime:l};_=Wt(f,p)}return p.set(f,_),m?await Xe(f,d.delayTime,_.delayTime):await sT(f,d.delayTime,_.delayTime),await Te(d,f,_),_})(d,f)}}},class extends tV{constructor(l,p){let d=ke(l),f={...e0,...p},_=Wt(d,f),m=De(d);super(l,!1,_,m?tF(f.maxDelayTime):null),this._delayTime=sS(this,m,_.delayTime),ns(this,f.maxDelayTime)}get delayTime(){return this._delayTime}}),ws=(l,p)=>{let d=l.createDynamicsCompressor();if(qt(d,p),p.channelCount>2||"max"===p.channelCountMode)throw Zt();return It(d,p,"attack"),It(d,p,"knee"),It(d,p,"ratio"),It(d,p,"release"),It(d,p,"threshold"),d},sV=(tN=sm,tP=()=>{let l=new WeakMap;return{render(p,d){let f=l.get(d);return void 0!==f?Promise.resolve(f):(async(p,d)=>{let f=tt(p),_=M(f,d);if(!_){let l={attack:f.attack.value,channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,knee:f.knee.value,ratio:f.ratio.value,release:f.release.value,threshold:f.threshold.value};f=ws(d,l)}return l.set(d,f),_?(await Xe(d,p.attack,f.attack),await Xe(d,p.knee,f.knee),await Xe(d,p.ratio,f.ratio),await Xe(d,p.release,f.release),await Xe(d,p.threshold,f.threshold)):(await sT(d,p.attack,f.attack),await sT(d,p.knee,f.knee),await sT(d,p.ratio,f.ratio),await sT(d,p.release,f.release),await sT(d,p.threshold,f.threshold)),await Te(p,d,f),f})(p,d)}}},class extends tN{constructor(l,p){let d=ke(l),f={...e1,...p},_=ws(d,f),m=De(d);super(l,!1,_,m?tP():null),this._attack=sS(this,m,_.attack),this._knee=sS(this,m,_.knee),this._nativeDynamicsCompressorNode=_,this._ratio=sS(this,m,_.ratio),this._release=sS(this,m,_.release),this._threshold=sS(this,m,_.threshold),ns(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(l){let p=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=l,l>2)throw this._nativeDynamicsCompressorNode.channelCount=p,Zt()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(l){let p=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=l,"max"===l)throw this._nativeDynamicsCompressorNode.channelCountMode=p,Zt()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}}),sF=(tj=sm,tB=()=>{let l=new WeakMap;return{render(p,d){let f=l.get(d);return void 0!==f?Promise.resolve(f):(async(p,d)=>{let f=tt(p),_=M(f,d);if(!_){let l={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,gain:f.gain.value};f=Bt(d,l)}return l.set(d,f),_?await Xe(d,p.gain,f.gain):await sT(d,p.gain,f.gain),await Te(p,d,f),f})(p,d)}}},class extends tj{constructor(l,p){let d=ke(l),f={...e2,...p},_=Bt(d,f),m=De(d);super(l,!1,_,m?tB():null),this._gain=sS(this,m,_.gain,34028234663852886e22,-34028234663852886e22)}get gain(){return this._gain}}),sN=(tL=()=>{if(null===su)return Promise.resolve(!1);let l=new su(1,1,44100),p=Bt(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(d=>{l.oncomplete=()=>{p.disconnect(),d(0!==l.currentTime)},l.startRendering()})},l=>sl(Et,()=>Et(l))?Promise.resolve(sl(tL,tL)).then(p=>{if(!p){let p=Qt(l,512,0,1);l.oncomplete=()=>{p.onaudioprocess=null,p.disconnect()},p.onaudioprocess=()=>l.currentTime,p.connect(l.destination)}return l.startRendering()}):new Promise(p=>{let d=Bt(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});l.oncomplete=l=>{d.disconnect(),p(l.renderedBuffer)},d.connect(l.destination),l.startRendering()})),sP=(tz=(l,p,{channelCount:d,channelCountMode:f,channelInterpretation:_,feedback:m,feedforward:O})=>{let I=Pt(p,l.sampleRate),V=m instanceof Float64Array?m:new Float64Array(m),F=O instanceof Float64Array?O:new Float64Array(O),P=V.length,te=F.length,ts=Math.min(P,te);if(0===P||P>20)throw Zt();if(0===V[0])throw At();if(0===te||te>20)throw Zt();if(0===F[0])throw At();if(1!==V[0]){for(let l=0;l<te;l+=1)F[l]/=V[0];for(let l=1;l<P;l+=1)V[l]/=V[0]}let ti=Qt(l,I,d,d);ti.channelCount=d,ti.channelCountMode=f,ti.channelInterpretation=_;let tn=[],tl=[],th=[];for(let l=0;l<d;l+=1){tn.push(0);let l=new Float32Array(32),p=new Float32Array(32);l.fill(0),p.fill(0),tl.push(l),th.push(p)}ti.onaudioprocess=l=>{let p=l.inputBuffer,d=l.outputBuffer,f=p.numberOfChannels;for(let l=0;l<f;l+=1){let f=p.getChannelData(l),_=d.getChannelData(l);tn[l]=Ot(V,P,F,te,ts,tl[l],th[l],tn[l],32,f,_)}};let tu=l.sampleRate/2;return zt({get bufferSize(){return I},get channelCount(){return ti.channelCount},set channelCount(t){ti.channelCount=t},get channelCountMode(){return ti.channelCountMode},set channelCountMode(t){ti.channelCountMode=t},get channelInterpretation(){return ti.channelInterpretation},set channelInterpretation(t){ti.channelInterpretation=t},get context(){return ti.context},get inputs(){return[ti]},get numberOfInputs(){return ti.numberOfInputs},get numberOfOutputs(){return ti.numberOfOutputs},addEventListener:(...l)=>ti.addEventListener(l[0],l[1],l[2]),dispatchEvent:(...l)=>ti.dispatchEvent(l[0]),getFrequencyResponse(l,p,d){if(l.length!==p.length||p.length!==d.length)throw Ct();let f=l.length;for(let _=0;_<f;_+=1){let f=-Math.PI*(l[_]/tu),m=[Math.cos(f),Math.sin(f)],O=function(l,p){let d=p[0]*p[0]+p[1]*p[1];return[(l[0]*p[0]+l[1]*p[1])/d,(l[1]*p[0]-l[0]*p[1])/d]}(Gt(F,m),Gt(V,m));p[_]=Math.sqrt(O[0]*O[0]+O[1]*O[1]),d[_]=Math.atan2(O[1],O[0])}},removeEventListener:(...l)=>ti.removeEventListener(l[0],l[1],l[2])},ti)},(l,p,d)=>{if(void 0===l.createIIRFilter)return tz(l,p,d);let f=l.createIIRFilter(d.feedforward,d.feedback);return qt(f,d),f}),sj=(tW=sm,tU=(l,p)=>{let d=new WeakMap,f=null;return{render(_,m){let O=d.get(m);return void 0!==O?Promise.resolve(O):(async(_,m)=>{let O=null,I=tt(_),V=M(I,m);if(void 0===m.createIIRFilter?O=sw(m,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):V||(I=m.createIIRFilter(p,l)),d.set(m,null===O?I:O),null!==O){if(null===f){if(null===su)throw Error("Missing the native OfflineAudioContext constructor.");let d=new su(_.context.destination.channelCount,_.context.length,m.sampleRate);f=(async()=>(await Te(_,d,d.destination),((l,p,d,f)=>{let _=d instanceof Float64Array?d:new Float64Array(d),m=f instanceof Float64Array?f:new Float64Array(f),O=_.length,I=m.length,V=Math.min(O,I);if(1!==_[0]){for(let l=0;l<O;l+=1)m[l]/=_[0];for(let l=1;l<I;l+=1)_[l]/=_[0]}let F=new Float32Array(32),P=new Float32Array(32),te=p.createBuffer(l.numberOfChannels,l.length,l.sampleRate),ts=l.numberOfChannels;for(let p=0;p<ts;p+=1){let d=l.getChannelData(p),f=te.getChannelData(p);F.fill(0),P.fill(0),Ot(_,O,m,I,V,F,P,0,32,d,f)}return te})(await sN(d),m,l,p)))()}let d=await f;return O.buffer=d,O.start(0),O}return await Te(_,m,I),I})(_,m)}}},class extends tW{constructor(l,p){var d;let f=ke(l),_=De(f),m={...e3,...p},O=sP(f,_?null:l.baseLatency,m);super(l,!1,O,_?tU(m.feedback,m.feedforward):null),O.getFrequencyResponse=(d=O.getFrequencyResponse,(l,p,f)=>{if(l.length!==p.length||p.length!==f.length)throw Ct();return d.call(O,l,p,f)}),this._nativeIIRFilterNode=O,ns(this,1)}getFrequencyResponse(l,p,d){return this._nativeIIRFilterNode.getFrequencyResponse(l,p,d)}}),sB=new WeakMap,sL=(tZ=(l,p)=>{let d=p.listener,{forwardX:f,forwardY:_,forwardZ:m,positionX:O,positionY:I,positionZ:V,upX:F,upY:P,upZ:te}=void 0===d.forwardX?(()=>{let f=new Float32Array(1),_=sO(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),m=De(p),O=!1,I=[0,0,-1,0,1,0],V=[0,0,0],g=()=>{if(O)return;O=!0;let l=Qt(p,256,9,0);l.onaudioprocess=({inputBuffer:l})=>{let p=[ee(l,f,0),ee(l,f,1),ee(l,f,2),ee(l,f,3),ee(l,f,4),ee(l,f,5)];p.some((l,p)=>l!==I[p])&&(d.setOrientation(...p),I=p);let _=[ee(l,f,6),ee(l,f,7),ee(l,f,8)];_.some((l,p)=>l!==V[p])&&(d.setPosition(..._),V=_)},_.connect(l)},v=l=>p=>{p!==I[l]&&(I[l]=p,d.setOrientation(...I))},y=l=>p=>{p!==V[l]&&(V[l]=p,d.setPosition(...V))},x=(d,f,O)=>{var I,V,F,P,te,ts,ti;let tn=sR(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:f});tn.connect(_,0,d),tn.start(),Object.defineProperty(tn.offset,"defaultValue",{get:()=>f});let tl=sS({context:l},m,tn.offset,34028234663852886e22,-34028234663852886e22);return ne(tl,"value",l=>()=>l.call(tl),l=>p=>{try{l.call(tl,p)}catch(l){if(9!==l.code)throw l}g(),m&&O(p)}),tl.cancelAndHoldAtTime=(I=tl.cancelAndHoldAtTime,m?()=>{throw Zt()}:(...l)=>{let p=I.apply(tl,l);return g(),p}),tl.cancelScheduledValues=(V=tl.cancelScheduledValues,m?()=>{throw Zt()}:(...l)=>{let p=V.apply(tl,l);return g(),p}),tl.exponentialRampToValueAtTime=(F=tl.exponentialRampToValueAtTime,m?()=>{throw Zt()}:(...l)=>{let p=F.apply(tl,l);return g(),p}),tl.linearRampToValueAtTime=(P=tl.linearRampToValueAtTime,m?()=>{throw Zt()}:(...l)=>{let p=P.apply(tl,l);return g(),p}),tl.setTargetAtTime=(te=tl.setTargetAtTime,m?()=>{throw Zt()}:(...l)=>{let p=te.apply(tl,l);return g(),p}),tl.setValueAtTime=(ts=tl.setValueAtTime,m?()=>{throw Zt()}:(...l)=>{let p=ts.apply(tl,l);return g(),p}),tl.setValueCurveAtTime=(ti=tl.setValueCurveAtTime,m?()=>{throw Zt()}:(...l)=>{let p=ti.apply(tl,l);return g(),p}),tl};return{forwardX:x(0,0,v(0)),forwardY:x(1,0,v(1)),forwardZ:x(2,-1,v(2)),positionX:x(6,0,y(0)),positionY:x(7,0,y(1)),positionZ:x(8,0,y(2)),upX:x(3,0,v(3)),upY:x(4,1,v(4)),upZ:x(5,0,v(5))}})():d;return{get forwardX(){return f},get forwardY(){return _},get forwardZ(){return m},get positionX(){return O},get positionY(){return I},get positionZ(){return V},get upX(){return F},get upY(){return P},get upZ(){return te}}},tG=sd,class extends tG{constructor(l,p){super(l),this._nativeContext=l,eP.set(this,l),De(l)&&sB.set(l,new Set),this._destination=new sA(this,p),this._listener=tZ(this,l),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(l){let p="function"==typeof l?ue(this,l):null;this._nativeContext.onstatechange=p;let d=this._nativeContext.onstatechange;this._onstatechange=null!==d&&d===p?l:d}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}}),Fs=(l,p)=>{let d=l.createOscillator();return qt(d,p),It(d,p,"detune"),It(d,p,"frequency"),void 0!==p.periodicWave?d.setPeriodicWave(p.periodicWave):Rt(d,p,"type"),sl(oe,()=>oe(l))||Vt(d),sl(re,()=>re(l))||le(d,l),sl(ae,()=>ae(l))||Nt(d),Qe(l,d),d},sz=(tY=sm,tX=()=>{let l=new WeakMap,p=null,d=null,f=null;return{set periodicWave(t){p=t},set start(t){d=t},set stop(t){f=t},render(_,m){let O=l.get(m);return void 0!==O?Promise.resolve(O):(async(_,m)=>{let O=tt(_),I=M(O,m);if(!I){let l={channelCount:O.channelCount,channelCountMode:O.channelCountMode,channelInterpretation:O.channelInterpretation,detune:O.detune.value,frequency:O.frequency.value,periodicWave:null===p?void 0:p,type:O.type};O=Fs(m,l),null!==d&&O.start(d),null!==f&&O.stop(f)}return l.set(m,O),I?(await Xe(m,_.detune,O.detune),await Xe(m,_.frequency,O.frequency)):(await sT(m,_.detune,O.detune),await sT(m,_.frequency,O.frequency)),await Te(_,m,O),O})(_,m)}}},class extends tY{constructor(l,p){let d=ke(l),f={...e6,...p},_=Fs(d,f),m=De(d),O=m?tX():null,I=l.sampleRate/2;super(l,!1,_,O),this._detune=sS(this,m,_.detune,153600,-153600),this._frequency=sS(this,m,_.frequency,I,-I),this._nativeOscillatorNode=_,this._onended=null,this._oscillatorNodeRenderer=O,null!==this._oscillatorNodeRenderer&&void 0!==f.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=f.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(l){let p="function"==typeof l?ue(this,l):null;this._nativeOscillatorNode.onended=p;let d=this._nativeOscillatorNode.onended;this._onended=null!==d&&d===p?l:d}get type(){return this._nativeOscillatorNode.type}set type(l){this._nativeOscillatorNode.type=l,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(l){this._nativeOscillatorNode.setPeriodicWave(l),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=l)}start(l=0){if(this._nativeOscillatorNode.start(l),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=l),"closed"!==this.context.state){k(this);let t=()=>{this._nativeOscillatorNode.removeEventListener("ended",t),N(this)&&C(this)};this._nativeOscillatorNode.addEventListener("ended",t)}}stop(l=0){this._nativeOscillatorNode.stop(l),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=l)}}),Ns=(l,p)=>{let d=sw(l,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),f=l.createBuffer(1,2,44100);return d.buffer=f,d.loop=!0,d.connect(p),d.start(),()=>{d.stop(),d.disconnect(p)}},sW=(tQ=(l,{curve:p,oversample:d,...f})=>{let _=l.createWaveShaper(),m=l.createWaveShaper();qt(_,f),qt(m,f);let O=Bt(l,{...f,gain:1}),I=Bt(l,{...f,gain:-1}),V=Bt(l,{...f,gain:1}),F=Bt(l,{...f,gain:-1}),P=null,te=!1,ts=null,ti={get bufferSize(){},get channelCount(){return _.channelCount},set channelCount(t){O.channelCount=t,I.channelCount=t,_.channelCount=t,V.channelCount=t,m.channelCount=t,F.channelCount=t},get channelCountMode(){return _.channelCountMode},set channelCountMode(t){O.channelCountMode=t,I.channelCountMode=t,_.channelCountMode=t,V.channelCountMode=t,m.channelCountMode=t,F.channelCountMode=t},get channelInterpretation(){return _.channelInterpretation},set channelInterpretation(t){O.channelInterpretation=t,I.channelInterpretation=t,_.channelInterpretation=t,V.channelInterpretation=t,m.channelInterpretation=t,F.channelInterpretation=t},get context(){return _.context},get curve(){return ts},set curve(s){if(null!==s&&s.length<2)throw At();if(null===s)_.curve=s,m.curve=s;else{let l=s.length,p=new Float32Array(l+2-l%2),d=new Float32Array(l+2-l%2);p[0]=s[0],d[0]=-s[l-1];let f=Math.ceil((l+1)/2),O=(l+1)/2-1;for(let _=1;_<f;_+=1){let m=_/f*O,I=Math.floor(m),V=Math.ceil(m);p[_]=I===V?s[I]:(1-(m-I))*s[I]+(1-(V-m))*s[V],d[_]=I===V?-s[l-1-I]:-(1-(m-I))*s[l-1-I]-(1-(V-m))*s[l-1-V]}p[f]=l%2==1?s[f-1]:(s[f-2]+s[f-1])/2,_.curve=p,m.curve=d}ts=s,te&&(se(ts)&&null===P?P=Ns(l,O):null!==P&&(P(),P=null))},get inputs(){return[O]},get numberOfInputs(){return _.numberOfInputs},get numberOfOutputs(){return _.numberOfOutputs},get oversample(){return _.oversample},set oversample(t){_.oversample=t,m.oversample=t},addEventListener:(...l)=>O.addEventListener(l[0],l[1],l[2]),dispatchEvent:(...l)=>O.dispatchEvent(l[0]),removeEventListener:(...l)=>O.removeEventListener(l[0],l[1],l[2])};return null!==p&&(ti.curve=p instanceof Float32Array?p:new Float32Array(p)),d!==ti.oversample&&(ti.oversample=d),os(zt(ti,V),()=>{O.connect(_).connect(V),O.connect(I).connect(m).connect(F).connect(V),te=!0,se(ts)&&(P=Ns(l,O))},()=>{O.disconnect(_),_.disconnect(V),O.disconnect(I),I.disconnect(m),m.disconnect(F),F.disconnect(V),te=!1,null!==P&&(P(),P=null)})},(l,p)=>{let d=l.createWaveShaper();if(null!==sf&&"webkitAudioContext"===sf.name&&void 0===l.createGain().gain.automationRate)return tQ(l,p);qt(d,p);let f=null===p.curve||p.curve instanceof Float32Array?p.curve:new Float32Array(p.curve);if(null!==f&&f.length<2)throw At();Rt(d,{curve:f},"curve"),Rt(d,p,"oversample");let _=null,m=!1;return ne(d,"curve",l=>()=>l.call(d),p=>f=>(p.call(d,f),m&&(se(f)&&null===_?_=Ns(l,d):se(f)||null===_||(_(),_=null)),f)),os(d,()=>{m=!0,se(d.curve)&&(_=Ns(l,d))},()=>{m=!1,null!==_&&(_(),_=null)})}),sU=(tH=(l,{coneInnerAngle:p,coneOuterAngle:d,coneOuterGain:f,distanceModel:_,maxDistance:m,orientationX:O,orientationY:I,orientationZ:V,panningModel:F,positionX:P,positionY:te,positionZ:ts,refDistance:ti,rolloffFactor:tn,...tl})=>{let th=l.createPanner();if(tl.channelCount>2||"max"===tl.channelCountMode)throw Zt();qt(th,tl);let tu={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},tp=sO(l,{...tu,channelInterpretation:"speakers",numberOfInputs:6}),td=Bt(l,{...tl,gain:1}),tf=Bt(l,{...tu,gain:1}),t_=Bt(l,{...tu,gain:0}),tm=Bt(l,{...tu,gain:0}),tg=Bt(l,{...tu,gain:0}),tv=Bt(l,{...tu,gain:0}),ty=Bt(l,{...tu,gain:0}),tx=Qt(l,256,6,1),tb=sW(l,{...tu,curve:new Float32Array([1,1]),oversample:"none"}),tw=[O,I,V],tT=[P,te,ts],tS=new Float32Array(1);tx.onaudioprocess=({inputBuffer:l})=>{let p=[ee(l,tS,0),ee(l,tS,1),ee(l,tS,2)];p.some((l,p)=>l!==tw[p])&&(th.setOrientation(...p),tw=p);let d=[ee(l,tS,3),ee(l,tS,4),ee(l,tS,5)];d.some((l,p)=>l!==tT[p])&&(th.setPosition(...d),tT=d)},Object.defineProperty(t_.gain,"defaultValue",{get:()=>0}),Object.defineProperty(tm.gain,"defaultValue",{get:()=>0}),Object.defineProperty(tg.gain,"defaultValue",{get:()=>0}),Object.defineProperty(tv.gain,"defaultValue",{get:()=>0}),Object.defineProperty(ty.gain,"defaultValue",{get:()=>0});let tk={get bufferSize(){},get channelCount(){return th.channelCount},set channelCount(t){if(t>2)throw Zt();td.channelCount=t,th.channelCount=t},get channelCountMode(){return th.channelCountMode},set channelCountMode(t){if("max"===t)throw Zt();td.channelCountMode=t,th.channelCountMode=t},get channelInterpretation(){return th.channelInterpretation},set channelInterpretation(t){td.channelInterpretation=t,th.channelInterpretation=t},get coneInnerAngle(){return th.coneInnerAngle},set coneInnerAngle(t){th.coneInnerAngle=t},get coneOuterAngle(){return th.coneOuterAngle},set coneOuterAngle(t){th.coneOuterAngle=t},get coneOuterGain(){return th.coneOuterGain},set coneOuterGain(t){if(t<0||t>1)throw At();th.coneOuterGain=t},get context(){return th.context},get distanceModel(){return th.distanceModel},set distanceModel(t){th.distanceModel=t},get inputs(){return[td]},get maxDistance(){return th.maxDistance},set maxDistance(t){if(t<0)throw RangeError();th.maxDistance=t},get numberOfInputs(){return th.numberOfInputs},get numberOfOutputs(){return th.numberOfOutputs},get orientationX(){return tf.gain},get orientationY(){return t_.gain},get orientationZ(){return tm.gain},get panningModel(){return th.panningModel},set panningModel(t){th.panningModel=t},get positionX(){return tg.gain},get positionY(){return tv.gain},get positionZ(){return ty.gain},get refDistance(){return th.refDistance},set refDistance(t){if(t<0)throw RangeError();th.refDistance=t},get rolloffFactor(){return th.rolloffFactor},set rolloffFactor(t){if(t<0)throw RangeError();th.rolloffFactor=t},addEventListener:(...l)=>td.addEventListener(l[0],l[1],l[2]),dispatchEvent:(...l)=>td.dispatchEvent(l[0]),removeEventListener:(...l)=>td.removeEventListener(l[0],l[1],l[2])};return p!==tk.coneInnerAngle&&(tk.coneInnerAngle=p),d!==tk.coneOuterAngle&&(tk.coneOuterAngle=d),f!==tk.coneOuterGain&&(tk.coneOuterGain=f),_!==tk.distanceModel&&(tk.distanceModel=_),m!==tk.maxDistance&&(tk.maxDistance=m),O!==tk.orientationX.value&&(tk.orientationX.value=O),I!==tk.orientationY.value&&(tk.orientationY.value=I),V!==tk.orientationZ.value&&(tk.orientationZ.value=V),F!==tk.panningModel&&(tk.panningModel=F),P!==tk.positionX.value&&(tk.positionX.value=P),te!==tk.positionY.value&&(tk.positionY.value=te),ts!==tk.positionZ.value&&(tk.positionZ.value=ts),ti!==tk.refDistance&&(tk.refDistance=ti),tn!==tk.rolloffFactor&&(tk.rolloffFactor=tn),1===tw[0]&&0===tw[1]&&0===tw[2]||th.setOrientation(...tw),0===tT[0]&&0===tT[1]&&0===tT[2]||th.setPosition(...tT),os(zt(tk,th),()=>{td.connect(th),Y(td,tb,0,0),tb.connect(tf).connect(tp,0,0),tb.connect(t_).connect(tp,0,1),tb.connect(tm).connect(tp,0,2),tb.connect(tg).connect(tp,0,3),tb.connect(tv).connect(tp,0,4),tb.connect(ty).connect(tp,0,5),tp.connect(tx).connect(l.destination)},()=>{td.disconnect(th),K(td,tb,0,0),tb.disconnect(tf),tf.disconnect(tp),tb.disconnect(t_),t_.disconnect(tp),tb.disconnect(tm),tm.disconnect(tp),tb.disconnect(tg),tg.disconnect(tp),tb.disconnect(tv),tv.disconnect(tp),tb.disconnect(ty),ty.disconnect(tp),tp.disconnect(tx),tx.disconnect(l.destination)})},(l,p)=>{let d=l.createPanner();return void 0===d.orientationX?tH(l,p):(qt(d,p),It(d,p,"orientationX"),It(d,p,"orientationY"),It(d,p,"orientationZ"),It(d,p,"positionX"),It(d,p,"positionY"),It(d,p,"positionZ"),Rt(d,p,"coneInnerAngle"),Rt(d,p,"coneOuterAngle"),Rt(d,p,"coneOuterGain"),Rt(d,p,"distanceModel"),Rt(d,p,"maxDistance"),Rt(d,p,"panningModel"),Rt(d,p,"refDistance"),Rt(d,p,"rolloffFactor"),d)}),sZ=(t$=sm,tK=()=>{let l=new WeakMap,p=null;return{render(d,f){let _=l.get(f);return void 0!==_?Promise.resolve(_):(async(d,f)=>{let _=null,m=tt(d),O={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation},I={...O,coneInnerAngle:m.coneInnerAngle,coneOuterAngle:m.coneOuterAngle,coneOuterGain:m.coneOuterGain,distanceModel:m.distanceModel,maxDistance:m.maxDistance,panningModel:m.panningModel,refDistance:m.refDistance,rolloffFactor:m.rolloffFactor},V=M(m,f);if("bufferSize"in m)_=Bt(f,{...O,gain:1});else if(!V){let l={...I,orientationX:m.orientationX.value,orientationY:m.orientationY.value,orientationZ:m.orientationZ.value,positionX:m.positionX.value,positionY:m.positionY.value,positionZ:m.positionZ.value};m=sU(f,l)}if(l.set(f,null===_?m:_),null!==_){if(null===p){if(null===su)throw Error("Missing the native OfflineAudioContext constructor.");let l=new su(6,d.context.length,f.sampleRate),_=sO(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});_.connect(l.destination),p=(async()=>{let p=await Promise.all([d.orientationX,d.orientationY,d.orientationZ,d.positionX,d.positionY,d.positionZ].map(async(p,d)=>{let f=sR(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===d?1:0});return await sT(l,p,f.offset),f}));for(let l=0;l<6;l+=1)p[l].connect(_,0,l),p[l].start(0);return sN(l)})()}let l=await p,m=Bt(f,{...O,gain:1});await Te(d,f,m);let V=[];for(let p=0;p<l.numberOfChannels;p+=1)V.push(l.getChannelData(p));let F=[V[0][0],V[1][0],V[2][0]],P=[V[3][0],V[4][0],V[5][0]],te=Bt(f,{...O,gain:1}),ts=sU(f,{...I,orientationX:F[0],orientationY:F[1],orientationZ:F[2],positionX:P[0],positionY:P[1],positionZ:P[2]});m.connect(te).connect(ts.inputs[0]),ts.connect(_);for(let p=128;p<l.length;p+=128){let l=[V[0][p],V[1][p],V[2][p]],d=[V[3][p],V[4][p],V[5][p]];if(l.some((l,p)=>l!==F[p])||d.some((l,p)=>l!==P[p])){F=l,P=d;let V=p/f.sampleRate;te.gain.setValueAtTime(0,V),te=Bt(f,{...O,gain:0}),ts=sU(f,{...I,orientationX:F[0],orientationY:F[1],orientationZ:F[2],positionX:P[0],positionY:P[1],positionZ:P[2]}),te.gain.setValueAtTime(1,V),m.connect(te).connect(ts.inputs[0]),ts.connect(_)}}return _}return V?(await Xe(f,d.orientationX,m.orientationX),await Xe(f,d.orientationY,m.orientationY),await Xe(f,d.orientationZ,m.orientationZ),await Xe(f,d.positionX,m.positionX),await Xe(f,d.positionY,m.positionY),await Xe(f,d.positionZ,m.positionZ)):(await sT(f,d.orientationX,m.orientationX),await sT(f,d.orientationY,m.orientationY),await sT(f,d.orientationZ,m.orientationZ),await sT(f,d.positionX,m.positionX),await sT(f,d.positionY,m.positionY),await sT(f,d.positionZ,m.positionZ)),X(m)?await Te(d,f,m.inputs[0]):await Te(d,f,m),m})(d,f)}}},class extends t${constructor(l,p){let d=ke(l),f={...e5,...p},_=sU(d,f),m=De(d);super(l,!1,_,m?tK():null),this._nativePannerNode=_,this._orientationX=sS(this,m,_.orientationX,34028234663852886e22,-34028234663852886e22),this._orientationY=sS(this,m,_.orientationY,34028234663852886e22,-34028234663852886e22),this._orientationZ=sS(this,m,_.orientationZ,34028234663852886e22,-34028234663852886e22),this._positionX=sS(this,m,_.positionX,34028234663852886e22,-34028234663852886e22),this._positionY=sS(this,m,_.positionY,34028234663852886e22,-34028234663852886e22),this._positionZ=sS(this,m,_.positionZ,34028234663852886e22,-34028234663852886e22),ns(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(l){this._nativePannerNode.coneInnerAngle=l}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(l){this._nativePannerNode.coneOuterAngle=l}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(l){this._nativePannerNode.coneOuterGain=l}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(l){this._nativePannerNode.distanceModel=l}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(l){this._nativePannerNode.maxDistance=l}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(l){this._nativePannerNode.panningModel=l}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(l){this._nativePannerNode.refDistance=l}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(l){this._nativePannerNode.rolloffFactor=l}}),sG=(tJ=(l,{disableNormalization:p,imag:d,real:f})=>{let _=d instanceof Float32Array?d:new Float32Array(d),m=f instanceof Float32Array?f:new Float32Array(f),O=l.createPeriodicWave(m,_,{disableNormalization:p});if(Array.from(d).length<2)throw R();return O},t0=new WeakSet,class n{constructor(l,p){let d=ke(l),f=(l=>{let{imag:p,real:d}=l;return void 0===p?void 0===d?{...l,imag:[0,0],real:[0,0]}:{...l,imag:Array.from(d,()=>0),real:d}:void 0===d?{...l,imag:p,real:Array.from(p,()=>0)}:{...l,imag:p,real:d}})({...e9,...p}),_=tJ(d,f);return t0.add(_),_}static[Symbol.hasInstance](l){return null!==l&&"object"==typeof l&&Object.getPrototypeOf(l)===n.prototype||t0.has(l)}}),sY=((l,p,d,f,_,m)=>{let O=new Float32Array([1,1]),I=Math.PI/2,V={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},F={...V,oversample:"none"},u=(l,m,P,te,ts)=>{if(1===m)return((l,p,_,m)=>{let P=new Float32Array(16385),te=new Float32Array(16385);for(let l=0;l<16385;l+=1){let p=l/16384*I;P[l]=Math.cos(p),te[l]=Math.sin(p)}let ts=d(l,{...V,gain:0}),ti=f(l,{...F,curve:P}),tn=f(l,{...F,curve:O}),tl=d(l,{...V,gain:0}),th=f(l,{...F,curve:te});return{connectGraph(){p.connect(ts),p.connect(void 0===tn.inputs?tn:tn.inputs[0]),p.connect(tl),tn.connect(_),_.connect(void 0===ti.inputs?ti:ti.inputs[0]),_.connect(void 0===th.inputs?th:th.inputs[0]),ti.connect(ts.gain),th.connect(tl.gain),ts.connect(m,0,0),tl.connect(m,0,1)},disconnectGraph(){p.disconnect(ts),p.disconnect(void 0===tn.inputs?tn:tn.inputs[0]),p.disconnect(tl),tn.disconnect(_),_.disconnect(void 0===ti.inputs?ti:ti.inputs[0]),_.disconnect(void 0===th.inputs?th:th.inputs[0]),ti.disconnect(ts.gain),th.disconnect(tl.gain),ts.disconnect(m,0,0),tl.disconnect(m,0,1)}}})(l,P,te,ts);if(2===m)return((l,_,m,P)=>{let te=new Float32Array(16385),ts=new Float32Array(16385),ti=new Float32Array(16385),tn=new Float32Array(16385),tl=Math.floor(8192.5);for(let l=0;l<16385;l+=1)if(l>tl){let p=(l-tl)/(16384-tl)*I;te[l]=Math.cos(p),ts[l]=Math.sin(p),ti[l]=0,tn[l]=1}else{let p=l/(16384-tl)*I;te[l]=1,ts[l]=0,ti[l]=Math.cos(p),tn[l]=Math.sin(p)}let th=p(l,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),tu=d(l,{...V,gain:0}),tp=f(l,{...F,curve:te}),td=d(l,{...V,gain:0}),tf=f(l,{...F,curve:ts}),t_=f(l,{...F,curve:O}),tm=d(l,{...V,gain:0}),tg=f(l,{...F,curve:ti}),tv=d(l,{...V,gain:0}),ty=f(l,{...F,curve:tn});return{connectGraph(){_.connect(th),_.connect(void 0===t_.inputs?t_:t_.inputs[0]),th.connect(tu,0),th.connect(td,0),th.connect(tm,1),th.connect(tv,1),t_.connect(m),m.connect(void 0===tp.inputs?tp:tp.inputs[0]),m.connect(void 0===tf.inputs?tf:tf.inputs[0]),m.connect(void 0===tg.inputs?tg:tg.inputs[0]),m.connect(void 0===ty.inputs?ty:ty.inputs[0]),tp.connect(tu.gain),tf.connect(td.gain),tg.connect(tm.gain),ty.connect(tv.gain),tu.connect(P,0,0),tm.connect(P,0,0),td.connect(P,0,1),tv.connect(P,0,1)},disconnectGraph(){_.disconnect(th),_.disconnect(void 0===t_.inputs?t_:t_.inputs[0]),th.disconnect(tu,0),th.disconnect(td,0),th.disconnect(tm,1),th.disconnect(tv,1),t_.disconnect(m),m.disconnect(void 0===tp.inputs?tp:tp.inputs[0]),m.disconnect(void 0===tf.inputs?tf:tf.inputs[0]),m.disconnect(void 0===tg.inputs?tg:tg.inputs[0]),m.disconnect(void 0===ty.inputs?ty:ty.inputs[0]),tp.disconnect(tu.gain),tf.disconnect(td.gain),tg.disconnect(tm.gain),ty.disconnect(tv.gain),tu.disconnect(P,0,0),tm.disconnect(P,0,0),td.disconnect(P,0,1),tv.disconnect(P,0,1)}}})(l,P,te,ts);throw _()};return(p,{channelCount:f,channelCountMode:O,pan:I,...V})=>{if("max"===O)throw _();let F=l(p,{...V,channelCount:1,channelCountMode:O,numberOfInputs:2}),P=d(p,{...V,channelCount:f,channelCountMode:O,gain:1}),te=d(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:I}),{connectGraph:ts,disconnectGraph:ti}=u(p,f,P,te,F);Object.defineProperty(te.gain,"defaultValue",{get:()=>0}),Object.defineProperty(te.gain,"maxValue",{get:()=>1}),Object.defineProperty(te.gain,"minValue",{get:()=>-1});let tn=!1;return m(zt({get bufferSize(){},get channelCount(){return P.channelCount},set channelCount(t){P.channelCount!==t&&(tn&&ti(),{connectGraph:ts,disconnectGraph:ti}=u(p,t,P,te,F),tn&&ts()),P.channelCount=t},get channelCountMode(){return P.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw _();P.channelCountMode=t},get channelInterpretation(){return P.channelInterpretation},set channelInterpretation(t){P.channelInterpretation=t},get context(){return P.context},get inputs(){return[P]},get numberOfInputs(){return P.numberOfInputs},get numberOfOutputs(){return P.numberOfOutputs},get pan(){return te.gain},addEventListener:(...l)=>P.addEventListener(l[0],l[1],l[2]),dispatchEvent:(...l)=>P.dispatchEvent(l[0]),removeEventListener:(...l)=>P.removeEventListener(l[0],l[1],l[2])},F),()=>{ts(),tn=!0},()=>{ti(),tn=!1})}})(sO,Lt,Bt,sW,Zt,os),Zs=(l,p)=>{let d=p.channelCountMode;if("clamped-max"===d)throw Zt();if(void 0===l.createStereoPanner)return sY(l,p);let f=l.createStereoPanner();return qt(f,p),It(f,p,"pan"),Object.defineProperty(f,"channelCountMode",{get:()=>d,set:l=>{if(l!==d)throw Zt()}}),f},sX=(t1=sm,t2=()=>{let l=new WeakMap;return{render(p,d){let f=l.get(d);return void 0!==f?Promise.resolve(f):(async(p,d)=>{let f=tt(p),_=M(f,d);if(!_){let l={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,pan:f.pan.value};f=Zs(d,l)}return l.set(d,f),_?await Xe(d,p.pan,f.pan):await sT(d,p.pan,f.pan),X(f)?await Te(p,d,f.inputs[0]):await Te(p,d,f),f})(p,d)}}},class extends t1{constructor(l,p){let d=ke(l),f={...e7,...p},_=Zs(d,f),m=De(d);super(l,!1,_,m?t2():null),this._pan=sS(this,m,_.pan)}get pan(){return this._pan}}),sQ=(t3=sm,t4=()=>{let l=new WeakMap;return{render(p,d){let f=l.get(d);return void 0!==f?Promise.resolve(f):(async(p,d)=>{let f=tt(p);if(!M(f,d)){let l={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,curve:f.curve,oversample:f.oversample};f=sW(d,l)}return l.set(d,f),X(f)?await Te(p,d,f.inputs[0]):await Te(p,d,f),f})(p,d)}}},class extends t3{constructor(l,p){let d=ke(l),f={...ss,...p},_=sW(d,f);super(l,!0,_,De(d)?t4():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=_,ns(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(l){if(null===l)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(l.length<2)throw At();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=l}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(l){this._nativeWaveShaperNode.oversample=l}}),sH=null!==sh&&sh.isSecureContext,Ks=(l,p,d)=>{Object.defineProperties(sh,{currentFrame:{configurable:!0,get:()=>Math.round(l*p)},currentTime:{configurable:!0,get:()=>l}});try{return d()}finally{null!==sh&&(delete sh.currentFrame,delete sh.currentTime)}},s$=new WeakMap,sK=sH?(t8=l=>new Promise((p,d)=>{if(null===sh)return void d(SyntaxError());let f=sh.document.head;if(null===f)d(SyntaxError());else{let _=sh.document.createElement("script"),m=new Blob([l],{type:"application/javascript"}),O=URL.createObjectURL(m),I=sh.onerror,h=()=>{sh.onerror=I,URL.revokeObjectURL(O)};sh.onerror=(l,p,f,_,m)=>p===O||p===sh.location.href&&1===f&&1===_?(h(),d(m),!1):null!==I?I(l,p,f,_,m):void 0,_.onerror=()=>{h(),d(SyntaxError())},_.onload=()=>{h(),p()},_.src=O,_.type="module",f.appendChild(_)}}),t6=async l=>{try{let p=await fetch(l);if(p.ok)return[await p.text(),p.url]}catch{}throw new DOMException("","AbortError")},t5=l=>{let p=s$.get(l);if(void 0!==p)return p;if(null===su)throw Error("Missing the native OfflineAudioContext constructor.");return p=new su(1,1,44100),s$.set(l,p),p},t9=new WeakMap,t7=new WeakMap,es=async()=>{if(null===s_)return!0;if(null===su)return!1;let l=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),p=new su(1,128,44100),d=URL.createObjectURL(l),f=!1,_=!1;try{await p.audioWorklet.addModule(d);let l=new s_(p,"a",{numberOfOutputs:0}),m=p.createOscillator();l.port.onmessage=()=>f=!0,l.onprocessorerror=()=>_=!0,m.connect(l),m.start(0),await p.startRendering(),await new Promise(l=>setTimeout(l))}catch{}finally{URL.revokeObjectURL(d)}return f&&!_},p=0,(l,d,f={credentials:"omit"})=>{let _=t7.get(l);if(void 0!==_&&_.has(d))return Promise.resolve();let m=t9.get(l);if(void 0!==m){let l=m.get(d);if(void 0!==l)return l}let O=ke(l),I=void 0===O.audioWorklet?t6(d).then(([l,p])=>{let[d,f]=v(l,p);return t8(`${d};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${f}
})})(window,'_AWGS')`)}).then(()=>{let l=sh._AWGS.pop();if(void 0===l)throw SyntaxError();Ks(O.currentTime,O.sampleRate,()=>l(class{},void 0,(l,p)=>{if(""===l.trim())throw Zt();let d=eL.get(O);if(void 0!==d){if(d.has(l))throw Zt();x(p),y(p.parameterDescriptors),d.set(l,p)}else x(p),y(p.parameterDescriptors),eL.set(O,new Map([[l,p]]))},O.sampleRate,void 0,void 0))}):Promise.all([t6(d),Promise.resolve(sl(es,es))]).then(([[l,d],_])=>{let m=p+1;p=m;let[I,V]=v(l,d),F=new Blob([`${I};((AudioWorkletProcessor,registerProcessor)=>{${V}
})(${_?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${_?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${_?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${m}',class extends AudioWorkletProcessor{process(){return !1}})`],{type:"application/javascript; charset=utf-8"}),P=URL.createObjectURL(F);return O.audioWorklet.addModule(P,f).then(()=>{if(De(O))return O;let l=t5(O);return l.audioWorklet.addModule(P,f).then(()=>l)}).then(l=>{if(null===s_)throw SyntaxError();try{new s_(l,`__sac${m}`)}catch{throw SyntaxError()}}).finally(()=>URL.revokeObjectURL(P))});return void 0===m?t9.set(l,new Map([[d,I]])):m.set(d,I),I.then(()=>{let p=t7.get(l);void 0===p?t7.set(l,new Set([d])):p.add(d)}).finally(()=>{let p=t9.get(l);void 0!==p&&p.delete(d)}),I}):void 0,sJ=(ei=new WeakSet,en=l=>Re(l)||De(l),(l,p)=>{let d=en(l)?l:ke(l);if(ei.has(p)){let l=new DOMException("","DataCloneError");return Promise.reject(l)}try{ei.add(p)}catch{}return sl(Et,()=>Et(d))?d.decodeAudioData(p).then(l=>(wt(p).catch(()=>{}),sl(E,()=>E(l))||Ue(l),sv.add(l),l)):new Promise((l,f)=>{let i=async()=>{try{await wt(p)}catch{}},o=l=>{f(l),i()};try{d.decodeAudioData(p,p=>{"function"!=typeof p.copyFromChannel&&(Be(p),q(p)),sv.add(p),i().then(()=>l(p))},l=>{o(null===l?new DOMException("","EncodingError"):l)})}catch(l){o(l)}})}),s0=(er=sL,class extends er{constructor(l,p){super(l,p),this._nativeContext=l,this._audioWorklet=void 0===sK?void 0:{addModule:(l,p)=>sK(this,l,p)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new sg(this)}createBiquadFilter(){return new sC(this)}createBuffer(l,p,d){return new sb({length:p,numberOfChannels:l,sampleRate:d})}createBufferSource(){return new sk(this)}createChannelMerger(l=6){return new sD(this,{numberOfInputs:l})}createChannelSplitter(l=6){return new sM(this,{numberOfOutputs:l})}createConstantSource(){return new sE(this)}createConvolver(){return new sq(this)}createDelay(l=1){return new sI(this,{maxDelayTime:l})}createDynamicsCompressor(){return new sV(this)}createGain(){return new sF(this)}createIIRFilter(l,p){return new sj(this,{feedback:p,feedforward:l})}createOscillator(){return new sz(this)}createPanner(){return new sZ(this)}createPeriodicWave(l,p,d={disableNormalization:!1}){return new sG(this,{...d,imag:p,real:l})}createStereoPanner(){return new sX(this)}createWaveShaper(){return new sQ(this)}decodeAudioData(l,p,d){return sJ(this._nativeContext,l).then(l=>("function"==typeof p&&p(l),l),l=>{throw"function"==typeof d&&d(l),l})}}),s1=(el=sm,class extends el{constructor(l,p){let d=ke(l),f=d.createMediaElementSource(p.mediaElement);if(De(d))throw TypeError();super(l,!0,f,null),this._nativeMediaElementAudioSourceNode=f}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}}),s2=(eh=sm,class extends eh{constructor(l,p){let d=ke(l);if(De(d))throw TypeError();let f=((l,p)=>{let d=l.createMediaStreamDestination();return qt(d,p),1===d.numberOfOutputs&&Object.defineProperty(d,"numberOfOutputs",{get:()=>0}),d})(d,{...e4,...p});super(l,!1,f,null),this._nativeMediaStreamAudioDestinationNode=f}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}}),s3=(eu=sm,class extends eu{constructor(l,p){let d=ke(l),f=((l,{mediaStream:p})=>{let d=p.getAudioTracks();d.sort((l,p)=>l.id<p.id?-1:l.id>p.id?1:0);let f=d.slice(0,1),_=l.createMediaStreamSource(new MediaStream(f));return Object.defineProperty(_,"mediaStream",{value:p}),_})(d,p);if(De(d))throw TypeError();super(l,!0,f,null),this._nativeMediaStreamAudioSourceNode=f}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}}),s4=(ep=sm,ed=(l,{mediaStreamTrack:p})=>{if("function"==typeof l.createMediaStreamTrackSource)return l.createMediaStreamTrackSource(p);let d=new MediaStream([p]),f=l.createMediaStreamSource(d);if("audio"!==p.kind)throw At();if(De(l))throw TypeError();return f},class extends ep{constructor(l,p){let d=ke(l);super(l,!0,ed(d,p),null)}}),s8=(ef=s0,e_=()=>new DOMException("","UnknownError"),class extends ef{constructor(l={}){var p;let d;if(null===sf)throw Error("Missing the native AudioContext constructor.");try{d=new sf(l)}catch(l){if(12===l.code&&"sampleRate is not in range"===l.message)throw Zt();throw l}if(null===d)throw e_();if(void 0!==(p=l.latencyHint)&&"number"!=typeof p&&("string"!=typeof p||"balanced"!==p&&"interactive"!==p&&"playback"!==p))throw TypeError(`The provided value '${l.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==l.sampleRate&&d.sampleRate!==l.sampleRate)throw Zt();super(d,2);let{latencyHint:f}=l,{sampleRate:_}=d;if(this._baseLatency="number"==typeof d.baseLatency?d.baseLatency:"balanced"===f?512/_:"interactive"===f||void 0===f?256/_:"playback"===f?1024/_:128*Math.max(2,Math.min(128,Math.round(f*_/128)))/_,this._nativeAudioContext=d,"webkitAudioContext"===sf.name?(this._nativeGainNode=d.createGain(),this._nativeOscillatorNode=d.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(d.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===d.state){this._state="suspended";let t=()=>{"suspended"===this._state&&(this._state=null),d.removeEventListener("statechange",t)};d.addEventListener("statechange",t)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then(()=>{throw At()}):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then(()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),W(this)}))}createMediaElementSource(l){return new s1(this,{mediaElement:l})}createMediaStreamDestination(){return new s2(this)}createMediaStreamSource(l){return new s3(this,{mediaStream:l})}createMediaStreamTrackSource(l){return new s4(this,{mediaStreamTrack:l})}resume(){return"suspended"===this._state?new Promise((l,p)=>{let s=()=>{this._nativeAudioContext.removeEventListener("statechange",s),"running"===this._nativeAudioContext.state?l():this.resume().then(l,p)};this._nativeAudioContext.addEventListener("statechange",s)}):this._nativeAudioContext.resume().catch(l=>{if(void 0===l||15===l.code)throw At();throw l})}suspend(){return this._nativeAudioContext.suspend().catch(l=>{if(void 0===l)throw At();throw l})}}),dn=l=>{let p=sB.get(l);if(void 0===p)throw Error("The context has no set of AudioWorkletNodes.");return p},_n=(l,p,d=0,f=0)=>{let _=l[d];if(void 0===_)throw R();return rt(p)?_.connect(p,0,f):_.connect(p,0)},gn=(l,p,d,f=0)=>void 0===p?l.forEach(l=>l.disconnect()):"number"==typeof p?Tt(R,l,p).disconnect():rt(p)?void 0===d?l.forEach(l=>l.disconnect(p)):void 0===f?Tt(R,l,d).disconnect(p,0):Tt(R,l,d).disconnect(p,0,f):void 0===d?l.forEach(l=>l.disconnect(p)):Tt(R,l,d).disconnect(p,0),s6=new WeakMap,s5=(em=l=>w(s6,l),(l,p,d,f)=>{var _,m;if(0===f.numberOfInputs&&0===f.numberOfOutputs)throw Zt();let O=Array.isArray(f.outputChannelCount)?f.outputChannelCount:Array.from(f.outputChannelCount);if(O.some(l=>l<1))throw Zt();if(O.length!==f.numberOfOutputs)throw R();if("explicit"!==f.channelCountMode)throw Zt();let I=f.channelCount*f.numberOfInputs,V=O.reduce((l,p)=>l+p,0),F=void 0===d.parameterDescriptors?0:d.parameterDescriptors.length;if(I+F>6||V>6)throw Zt();let P=new MessageChannel,te=[],ts=[];for(let p=0;p<f.numberOfInputs;p+=1)te.push(Bt(l,{channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,gain:1})),ts.push(Lt(l,{channelCount:f.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:f.channelCount}));let ti=[];if(void 0!==d.parameterDescriptors)for(let{defaultValue:p,maxValue:_,minValue:m,name:O}of d.parameterDescriptors){let d=sR(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==f.parameterData[O]?f.parameterData[O]:void 0===p?0:p});Object.defineProperties(d.offset,{defaultValue:{get:()=>void 0===p?0:p},maxValue:{get:()=>void 0===_?34028234663852886e22:_},minValue:{get:()=>void 0===m?-34028234663852886e22:m}}),ti.push(d)}let tn=sO(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,I+F)}),tl=Pt(p,l.sampleRate),th=Qt(l,tl,I+F,Math.max(1,V)),tu=Lt(l,{channelCount:Math.max(1,V),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,V)}),tp=[];for(let p=0;p<f.numberOfOutputs;p+=1)tp.push(sO(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:O[p]}));for(let l=0;l<f.numberOfInputs;l+=1){te[l].connect(ts[l]);for(let p=0;p<f.channelCount;p+=1)ts[l].connect(tn,p,l*f.channelCount+p)}let td=new lt(void 0===d.parameterDescriptors?[]:d.parameterDescriptors.map(({name:l},p)=>{let d=ti[p];return d.connect(tn,0,I+p),d.start(0),[l,d.offset]}));tn.connect(th);let tf=f.channelInterpretation,t_=null,tm=0===f.numberOfOutputs?[th]:tp,tg={get bufferSize(){return tl},get channelCount(){return f.channelCount},set channelCount(t){throw At()},get channelCountMode(){return f.channelCountMode},set channelCountMode(t){throw At()},get channelInterpretation(){return tf},set channelInterpretation(t){for(let l of te)l.channelInterpretation=t;tf=t},get context(){return th.context},get inputs(){return te},get numberOfInputs(){return f.numberOfInputs},get numberOfOutputs(){return f.numberOfOutputs},get onprocessorerror(){return t_},set onprocessorerror(t){"function"==typeof t_&&tg.removeEventListener("processorerror",t_),"function"==typeof(t_="function"==typeof t?t:null)&&tg.addEventListener("processorerror",t_)},get parameters(){return td},get port(){return P.port2},addEventListener:(...l)=>th.addEventListener(l[0],l[1],l[2]),connect:_n.bind(null,tm),disconnect:gn.bind(null,tm),dispatchEvent:(...l)=>th.dispatchEvent(l[0]),removeEventListener:(...l)=>th.removeEventListener(l[0],l[1],l[2])},tv=new Map;P.port1.addEventListener=(_=P.port1.addEventListener,(...p)=>{if("message"===p[0]){let d="function"==typeof p[1]?p[1]:"object"==typeof p[1]&&null!==p[1]&&"function"==typeof p[1].handleEvent?p[1].handleEvent:null;if(null!==d){let f=tv.get(p[1]);void 0!==f?p[1]=f:(p[1]=p=>{Ks(l.currentTime,l.sampleRate,()=>d(p))},tv.set(d,p[1]))}}return _.call(P.port1,p[0],p[1],p[2])}),P.port1.removeEventListener=(m=P.port1.removeEventListener,(...l)=>{if("message"===l[0]){let p=tv.get(l[1]);void 0!==p&&(tv.delete(l[1]),l[1]=p)}return m.call(P.port1,l[0],l[1],l[2])});let ty=null;Object.defineProperty(P.port1,"onmessage",{get:()=>ty,set:l=>{"function"==typeof ty&&P.port1.removeEventListener("message",ty),"function"==typeof(ty="function"==typeof l?l:null)&&(P.port1.addEventListener("message",ty),P.port1.start())}}),d.prototype.port=P.port1;let tx=null,tb=((l,p,d,f)=>{let _=ez.get(l);void 0===_&&(_=new WeakMap,ez.set(l,_));let m=(async(l,p)=>{let d=await new Promise((l,d)=>{let{port1:f,port2:_}=new MessageChannel;f.onmessage=({data:p})=>{f.close(),_.close(),l(p)},f.onmessageerror=({data:l})=>{f.close(),_.close(),d(l)},_.postMessage(p)});return new l(d)})(d,f);return _.set(p,m),m})(l,tg,d,f);tb.then(l=>tx=l);let tw=ft(f.numberOfInputs,f.channelCount),tT=ft(f.numberOfOutputs,O),tS=void 0===d.parameterDescriptors?[]:d.parameterDescriptors.reduce((l,{name:p})=>({...l,[p]:new Float32Array(128)}),{}),tk=!0,X=()=>{f.numberOfOutputs>0&&th.disconnect(tu);for(let l=0,p=0;l<f.numberOfOutputs;l+=1){let d=tp[l];for(let f=0;f<O[l];f+=1)tu.disconnect(d,p+f,f);p+=O[l]}},tA=new Map;th.onaudioprocess=({inputBuffer:p,outputBuffer:_})=>{if(null!==tx){let m=em(tg);for(let V=0;V<tl;V+=128){for(let l=0;l<f.numberOfInputs;l+=1)for(let d=0;d<f.channelCount;d+=1)pt(p,tw[l],d,d,V);void 0!==d.parameterDescriptors&&d.parameterDescriptors.forEach(({name:l},d)=>{pt(p,tS,l,I+d,V)});for(let l=0;l<f.numberOfInputs;l+=1)for(let p=0;p<O[l];p+=1)0===tT[l][p].byteLength&&(tT[l][p]=new Float32Array(128));try{let p=tw.map((l,p)=>{if(m[p].size>0)return tA.set(p,tl/128),l;let d=tA.get(p);return void 0===d?[]:(l.every(l=>l.every(l=>0===l))&&(1===d?tA.delete(p):tA.set(p,d-1)),l)}),d=Ks(l.currentTime+V/l.sampleRate,l.sampleRate,()=>tx.process(p,tT,tS));tk=d;for(let l=0,p=0;l<f.numberOfOutputs;l+=1){for(let d=0;d<O[l];d+=1)dt(_,tT[l],d,p+d,V);p+=O[l]}}catch(l){tk=!1,tg.dispatchEvent(new ErrorEvent("processorerror",{colno:l.colno,filename:l.filename,lineno:l.lineno,message:l.message}))}if(!tk){for(let l=0;l<f.numberOfInputs;l+=1){te[l].disconnect(ts[l]);for(let p=0;p<f.channelCount;p+=1)ts[V].disconnect(tn,p,l*f.channelCount+p)}if(void 0!==d.parameterDescriptors){let l=d.parameterDescriptors.length;for(let p=0;p<l;p+=1){let l=ti[p];l.disconnect(tn,0,I+p),l.stop()}}tn.disconnect(th),th.onaudioprocess=null,tC?X():K();break}}}};let tC=!1,tO=Bt(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),J=()=>th.connect(tO).connect(l.destination),K=()=>{th.disconnect(tO),tO.disconnect()};return J(),os(tg,()=>{if(tk){K(),f.numberOfOutputs>0&&th.connect(tu);for(let l=0,p=0;l<f.numberOfOutputs;l+=1){let d=tp[l];for(let f=0;f<O[l];f+=1)tu.connect(d,p+f,f);p+=O[l]}}tC=!0},()=>{tk&&(J(),X()),tC=!1})}),s9=(eg=(l,p)=>{dn(l).delete(p)},(l,p,d)=>{let f=new WeakMap,_=null;return{render(m,O){eg(O,m);let I=f.get(O);return void 0!==I?Promise.resolve(I):(async(m,O)=>{let I=tt(m),V=null,F=M(I,O),P=Array.isArray(p.outputChannelCount)?p.outputChannelCount:Array.from(p.outputChannelCount);if(null===s_){let l=P.reduce((l,p)=>l+p,0),d=Lt(O,{channelCount:Math.max(1,l),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,l)}),f=[];for(let l=0;l<m.numberOfOutputs;l+=1)f.push(sO(O,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:P[l]}));let _=Bt(O,{channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,gain:1});_.connect=_n.bind(null,f),_.disconnect=gn.bind(null,f),V=[d,f,_]}else F||(I=new s_(O,l));if(f.set(O,null===V?I:V[2]),null!==V){if(null===_){if(void 0===d)throw Error("Missing the processor constructor.");if(null===su)throw Error("Missing the native OfflineAudioContext constructor.");let l=m.channelCount*m.numberOfInputs,f=void 0===d.parameterDescriptors?0:d.parameterDescriptors.length,I=l+f,c=async()=>{let d=new su(I,128*Math.ceil(m.context.length/128),O.sampleRate),_=[],V=[];for(let l=0;l<p.numberOfInputs;l+=1)_.push(Bt(d,{channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,gain:1})),V.push(Lt(d,{channelCount:p.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:p.channelCount}));let F=await Promise.all(Array.from(m.parameters.values()).map(async l=>{let p=sR(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:l.value});return await sT(d,l,p.offset),p})),P=sO(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,l+f)});for(let l=0;l<p.numberOfInputs;l+=1){_[l].connect(V[l]);for(let d=0;d<p.channelCount;d+=1)V[l].connect(P,d,l*p.channelCount+d)}for(let[p,d]of F.entries())d.connect(P,0,l+p),d.start(0);return P.connect(d.destination),await Promise.all(_.map(l=>Te(m,d,l))),sN(d)};_=_t(m,0===I?null:await c(),O,p,P,d,Ks)}let l=await _,f=sw(O,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[I,F,te]=V;null!==l&&(f.buffer=l,f.start(0)),f.connect(I);for(let l=0,p=0;l<m.numberOfOutputs;l+=1){let d=F[l];for(let f=0;f<P[l];f+=1)I.connect(d,p+f,f);p+=P[l]}return te}if(F)for(let[l,p]of m.parameters.entries())await Xe(O,p,I.parameters.get(l));else for(let[l,p]of m.parameters.entries())await sT(O,p,I.parameters.get(l));return await Te(m,O,I),I})(m,O)}}}),s7=sH?(ev=(l,p)=>{dn(l).add(p)},ey=sm,ex=(l,p,d,f,_,m)=>{var O,I;if(null!==d)try{let p=new d(l,f,m),_=new Map,V=null;if(Object.defineProperties(p,{channelCount:{get:()=>m.channelCount,set:()=>{throw At()}},channelCountMode:{get:()=>"explicit",set:()=>{throw At()}},onprocessorerror:{get:()=>V,set:l=>{"function"==typeof V&&p.removeEventListener("processorerror",V),V="function"==typeof l?l:null,"function"==typeof V&&p.addEventListener("processorerror",V)}}}),p.addEventListener=(I=p.addEventListener,(...l)=>{if("processorerror"===l[0]){let p="function"==typeof l[1]?l[1]:"object"==typeof l[1]&&null!==l[1]&&"function"==typeof l[1].handleEvent?l[1].handleEvent:null;if(null!==p){let d=_.get(l[1]);void 0!==d?l[1]=d:(l[1]=d=>{"error"===d.type?(Object.defineProperties(d,{type:{value:"processorerror"}}),p(d)):p(new ErrorEvent(l[0],{...d}))},_.set(p,l[1]))}}return I.call(p,"error",l[1],l[2]),I.call(p,...l)}),p.removeEventListener=(O=p.removeEventListener,(...l)=>{if("processorerror"===l[0]){let p=_.get(l[1]);void 0!==p&&(_.delete(l[1]),l[1]=p)}return O.call(p,"error",l[1],l[2]),O.call(p,l[0],l[1],l[2])}),0!==m.numberOfOutputs){let d=Bt(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return p.connect(d).connect(l.destination),os(p,()=>d.disconnect(),()=>d.connect(l.destination))}return p}catch(l){if(11===l.code)throw Zt();throw l}if(void 0===_)throw Zt();return(l=>{let{port1:p}=new MessageChannel;try{p.postMessage(l)}finally{p.close()}})(m),s5(l,p,_,m)},eb=l=>s$.get(l),ew=(l,p)=>{s6.set(l,p)},class extends ey{constructor(l,p,d){var f,_;let m=ke(l),O=De(m),I={..._={...eX,...d},outputChannelCount:void 0!==_.outputChannelCount?_.outputChannelCount:1===_.numberOfInputs&&1===_.numberOfOutputs?[_.channelCount]:Array.from({length:_.numberOfOutputs},()=>1)};(l=>{let{port1:p,port2:d}=new MessageChannel;try{p.postMessage(l)}finally{p.close(),d.close()}})(I);let V=eL.get(m),F=null==V?void 0:V.get(p),P=O||"closed"!==m.state?m:null!==(f=eb(m))&&void 0!==f?f:m,te=ex(P,O?null:l.baseLatency,s_,p,F,I);super(l,!0,te,O?s9(p,I,F):null);let ts=[];te.parameters.forEach((l,p)=>{let d=sS(this,O,l);ts.push([p,d])}),this._nativeAudioWorkletNode=te,this._onprocessorerror=null,this._parameters=new lt(ts),O&&ev(m,this);let{activeInputs:ti}=j(this);ew(te,ti)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(l){let p="function"==typeof l?ue(this,l):null;this._nativeAudioWorkletNode.onprocessorerror=p;let d=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==d&&d===p?l:d}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}}):void 0,is=(eT=s0,eS=(l,p,d)=>{if(null===su)throw Error("Missing the native OfflineAudioContext constructor.");try{return new su(l,p,d)}catch(l){if("SyntaxError"===l.name)throw Zt();throw l}},ek=(l,p)=>be(l).render(l,p).then(()=>Promise.all(Array.from(dn(p)).map(l=>be(l).render(l,p)))).then(()=>sN(p)).then(l=>("function"!=typeof l.copyFromChannel?(Be(l),q(l)):sl(E,()=>E(l))||Ue(l),sv.add(l),l)),class extends eT{constructor(l,p,d){let f;if("number"==typeof l&&void 0!==p&&void 0!==d)f={length:p,numberOfChannels:l,sampleRate:d};else{if("object"!=typeof l)throw Error("The given parameters are not valid.");f=l}let{length:_,numberOfChannels:m,sampleRate:O}={...e8,...f},I=eS(m,_,O);sl(Et,()=>Et(I))||I.addEventListener("statechange",(()=>{let l=0,e=p=>{"running"===this._state&&(l>0?(I.removeEventListener("statechange",e),p.stopImmediatePropagation(),this._waitForThePromiseToSettle(p)):l+=1)};return e})()),super(I,m),this._length=_,this._nativeOfflineAudioContext=I,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(At()):(this._state="running",ek(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,W(this)}))}_waitForThePromiseToSettle(l){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(l):setTimeout(()=>this._waitForThePromiseToSettle(l))}}),On=l=>{let p=eP.get(l);return Re(p)||Re(l)},Mn=l=>eV.has(l)||qe(l),En=l=>eN.has(l)||Fe(l),Rn=l=>{let p=eP.get(l);return De(p)||De(l)},qn=()=>(async(l,p,d,f,_,m,O,I,V,F,P,te,ts,ti,tn,tl)=>!!(l(p,p)&&l(d,d)&&l(_,_)&&l(m,m)&&l(I,I)&&l(V,V)&&l(F,F)&&l(P,P)&&l(te,te)&&l(ts,ts)&&l(ti,ti))&&(await Promise.all([l(f,f),l(O,O),l(tn,tn),l(tl,tl)])).every(l=>l))(sl,()=>{if(null===su)return!1;let l=new su(1,1,44100).createBuffer(1,1,44100);if(void 0===l.copyToChannel)return!0;let p=new Float32Array(2);try{l.copyFromChannel(p,0,0)}catch{return!1}return!0},()=>{if(null===sf)return!1;if(void 0!==sf.prototype&&void 0!==sf.prototype.close)return!0;let l=new sf,p=void 0!==l.close;try{l.close()}catch{}return p},()=>{if(null===su)return Promise.resolve(!1);let l=new su(1,1,44100);return new Promise(p=>{let d,f=!0,n=d=>{f&&(f=!1,l.startRendering(),p(d instanceof TypeError))};try{d=l.decodeAudioData(null,()=>{},n)}catch(l){n(l)}void 0!==d&&d.catch(n)})},()=>{let l;if(null===sf)return!1;try{l=new sf({latencyHint:"balanced"})}catch{return!1}return l.close(),!0},()=>{if(null===su)return!1;let l=new su(1,1,44100).createGain(),p=l.connect(l)===l;return l.disconnect(l),p},async()=>{if(null===s_)return!0;if(null===su)return!1;let l=new Blob(['let c,p;class A extends AudioWorkletProcessor{constructor(){super();this.port.onmessage=(e)=>{p=e.data;p.onmessage=()=>{p.postMessage(c);p.close()};this.port.postMessage(0)}}process(){c=1}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),p=new MessageChannel,d=new su(1,128,44100),f=URL.createObjectURL(l),_=!1;try{await d.audioWorklet.addModule(f);let l=new s_(d,"a",{numberOfOutputs:0}),m=d.createOscillator();await new Promise(d=>{l.port.onmessage=()=>d(),l.port.postMessage(p.port2,[p.port2])}),l.port.onmessage=()=>_=!0,m.connect(l),m.start(0),await d.startRendering(),_=await new Promise(l=>{p.port1.onmessage=({data:p})=>l(1===p),p.port1.postMessage(0)})}catch{}finally{p.port1.close(),URL.revokeObjectURL(f)}return _},()=>{if(null===su)return!1;let l=new su(1,1,44100).createChannelMerger();if("max"===l.channelCountMode)return!0;try{l.channelCount=2}catch{return!0}return!1},()=>{if(null===su)return!1;let l=new su(1,1,44100);return void 0===l.createConstantSource||l.createConstantSource().offset.maxValue!==Number.POSITIVE_INFINITY},()=>{if(null===su)return!1;let l=new su(1,1,44100),p=l.createConvolver();p.buffer=l.createBuffer(1,1,l.sampleRate);try{p.buffer=l.createBuffer(1,1,l.sampleRate)}catch{return!1}return!0},()=>{if(null===su)return!1;let l=new su(1,1,44100).createConvolver();try{l.channelCount=1}catch{return!1}return!0},ce,()=>null!==sh&&sh.hasOwnProperty("isSecureContext"),()=>{if(null===sf)return!1;let l=new sf;try{return l.createMediaStreamSource(new MediaStream),!1}catch(l){return!0}finally{l.close()}},()=>{if(null===su)return Promise.resolve(!1);let l=new su(1,1,44100);if(void 0===l.createStereoPanner||void 0===l.createConstantSource)return Promise.resolve(!0);let p=l.createConstantSource(),d=l.createStereoPanner();return p.channelCount=1,p.offset.value=1,d.channelCount=1,p.start(),p.connect(d).connect(l.destination),l.startRendering().then(l=>1!==l.getChannelData(0)[0])},he);function Fn(l){return void 0===l}function In(l){return void 0!==l}function Vn(l){return"function"==typeof l}function Nn(l){return"number"==typeof l}function Pn(l){return"[object Object]"===Object.prototype.toString.call(l)&&l.constructor===Object}function jn(l){return"boolean"==typeof l}function Ln(l){return Array.isArray(l)}function zn(l){return"string"==typeof l}function Wn(l){return zn(l)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(l)}function Bn(l,p){if(!l)throw Error(p)}function Un(l,p,d=1/0){if(!(p<=l&&l<=d))throw RangeError(`Value must be within [${p}, ${d}], got: ${l}`)}function Gn(l){l.isOffline||"running"===l.state||Kn('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let il=!1,ih=!1;function Xn(l){il=l}function Yn(l){Fn(l)&&il&&!ih&&(ih=!0,Kn("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing"))}let iu=console;function Hn(l){iu=l}function Jn(...l){iu.log(...l)}function Kn(...l){iu.warn(...l)}let ip="object"==typeof self?self:null,id=ip&&(ip.hasOwnProperty("AudioContext")||ip.hasOwnProperty("webkitAudioContext"));function si(l,p,d,f){var _,m=arguments.length,O=m<3?p:null===f?f=Object.getOwnPropertyDescriptor(p,d):f;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)O=Reflect.decorate(l,p,d,f);else for(var I=l.length-1;I>=0;I--)(_=l[I])&&(O=(m<3?_(O):m>3?_(p,d,O):_(p,d))||O);return m>3&&O&&Object.defineProperty(p,d,O),O}function ni(l,p,d,f){return new(d||(d=Promise))(function(_,m){function r(l){try{c(f.next(l))}catch(l){m(l)}}function a(l){try{c(f.throw(l))}catch(l){m(l)}}function c(l){var p;l.done?_(l.value):((p=l.value)instanceof d?p:new d(function(l){l(p)})).then(r,a)}c((f=f.apply(l,p||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;let ii=class ii{constructor(l,p,d,f){this._callback=l,this._type=p,this._minimumUpdateInterval=Math.max(128/(f||44100),.001),this.updateInterval=d,this._createClock()}_createWorker(){let l=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),p=URL.createObjectURL(l),d=new Worker(p);d.onmessage=this._callback.bind(this),this._worker=d}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(l){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(l){var p;this._updateInterval=Math.max(l,this._minimumUpdateInterval),"worker"===this._type&&(null===(p=this._worker)||void 0===p||p.postMessage(1e3*this._updateInterval))}get type(){return this._type}set type(l){this._disposeClock(),this._type=l,this._createClock()}dispose(){this._disposeClock()}};function li(l,...p){if(!p.length)return l;let d=p.shift();if(Pn(l)&&Pn(d))for(let p in d){var f;(f=d[p],"value"===p||En(f)||Mn(f)||f instanceof sb)?l[p]=d[p]:Pn(d[p])?(l[p]||Object.assign(l,{[p]:{}}),li(l[p],d[p])):Object.assign(l,{[p]:d[p]})}return li(l,...p)}function ui(l,p,d=[],f){let _={},m=Array.from(p);if(Pn(m[0])&&f&&!Reflect.has(m[0],f)&&(Object.keys(m[0]).some(p=>Reflect.has(l,p))||(li(_,{[f]:m[0]}),d.splice(d.indexOf(f),1),m.shift())),1===m.length&&Pn(m[0]))li(_,m[0]);else for(let l=0;l<d.length;l++)In(m[l])&&(_[d[l]]=m[l]);return li(l,_)}function pi(l,p){return Fn(l)?p:l}function di(l,p){return p.forEach(p=>{Reflect.has(l,p)&&delete l[p]}),l}let fi=class fi{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...l){(this.debug||ip&&this.toString()===ip.TONE_DEBUG_CLASS)&&Jn(this,...l)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}};function mi(l,p){return l>p+1e-6}function gi(l,p){return mi(l,p)||yi(l,p)}function vi(l,p){return l+1e-6<p}function yi(l,p){return 1e-6>Math.abs(l-p)}function xi(l,p,d){return Math.max(Math.min(l,d),p)}fi.version=eR;let wi=class wi extends fi{constructor(){super(),this.name="Timeline",this._timeline=[];let l=ui(wi.getDefaults(),arguments,["memory"]);this.memory=l.memory,this.increasing=l.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(l){if(Bn(Reflect.has(l,"time"),"Timeline: events must have a time attribute"),l.time=l.time.valueOf(),this.increasing&&this.length){let p=this._timeline[this.length-1];Bn(gi(l.time,p.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(l)}else{let p=this._search(l.time);this._timeline.splice(p+1,0,l)}if(this.length>this.memory){let l=this.length-this.memory;this._timeline.splice(0,l)}return this}remove(l){let p=this._timeline.indexOf(l);return -1!==p&&this._timeline.splice(p,1),this}get(l,p="time"){let d=this._search(l,p);return -1!==d?this._timeline[d]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(l,p="time"){let d=this._search(l,p);return d+1<this._timeline.length?this._timeline[d+1]:null}getBefore(l){let p=this._timeline.length;if(p>0&&this._timeline[p-1].time<l)return this._timeline[p-1];let d=this._search(l);return d-1>=0?this._timeline[d-1]:null}cancel(l){if(this._timeline.length>1){let p=this._search(l);if(p>=0){if(yi(this._timeline[p].time,l)){for(let d=p;d>=0&&yi(this._timeline[d].time,l);d--)p=d;this._timeline=this._timeline.slice(0,p)}else this._timeline=this._timeline.slice(0,p+1)}else this._timeline=[]}else 1===this._timeline.length&&gi(this._timeline[0].time,l)&&(this._timeline=[]);return this}cancelBefore(l){let p=this._search(l);return p>=0&&(this._timeline=this._timeline.slice(p+1)),this}previousEvent(l){let p=this._timeline.indexOf(l);return p>0?this._timeline[p-1]:null}_search(l,p="time"){if(0===this._timeline.length)return -1;let d=0,f=this._timeline.length,_=f;if(f>0&&this._timeline[f-1][p]<=l)return f-1;for(;d<_;){let f=Math.floor(d+(_-d)/2),m=this._timeline[f],O=this._timeline[f+1];if(yi(m[p],l)){for(let d=f;d<this._timeline.length&&yi(this._timeline[d][p],l);d++)f=d;return f}if(vi(m[p],l)&&mi(O[p],l))return f;mi(m[p],l)?_=f:d=f+1}return -1}_iterate(l,p=0,d=this._timeline.length-1){this._timeline.slice(p,d+1).forEach(l)}forEach(l){return this._iterate(l),this}forEachBefore(l,p){let d=this._search(l);return -1!==d&&this._iterate(p,0,d),this}forEachAfter(l,p){let d=this._search(l);return this._iterate(p,d+1),this}forEachBetween(l,p,d){let f=this._search(l),_=this._search(p);return -1!==f&&-1!==_?(this._timeline[f].time!==l&&(f+=1),this._timeline[_].time===p&&(_-=1),this._iterate(d,f,_)):-1===f&&this._iterate(d,0,_),this}forEachFrom(l,p){let d=this._search(l);for(;d>=0&&this._timeline[d].time>=l;)d--;return this._iterate(p,d+1),this}forEachAtTime(l,p){let d=this._search(l);if(-1!==d&&yi(this._timeline[d].time,l)){let f=d;for(let p=d;p>=0&&yi(this._timeline[p].time,l);p--)f=p;this._iterate(l=>{p(l)},f,d)}return this}dispose(){return super.dispose(),this._timeline=[],this}};let i_=[];function Ti(l){i_.push(l)}let im=[];function ki(l){im.push(l)}let Ai=class Ai extends fi{constructor(){super(...arguments),this.name="Emitter"}on(l,p){return l.split(/\W+/).forEach(l=>{Fn(this._events)&&(this._events={}),this._events.hasOwnProperty(l)||(this._events[l]=[]),this._events[l].push(p)}),this}once(l,p){let s=(...d)=>{p(...d),this.off(l,s)};return this.on(l,s),this}off(l,p){return l.split(/\W+/).forEach(l=>{if(Fn(this._events)&&(this._events={}),this._events.hasOwnProperty(l)){if(Fn(p))this._events[l]=[];else{let d=this._events[l];for(let l=d.length-1;l>=0;l--)d[l]===p&&d.splice(l,1)}}}),this}emit(l,...p){if(this._events&&this._events.hasOwnProperty(l)){let d=this._events[l].slice(0);for(let l=0,f=d.length;l<f;l++)d[l].apply(this,p)}return this}static mixin(l){["on","once","off","emit"].forEach(p=>{let d=Object.getOwnPropertyDescriptor(Ai.prototype,p);Object.defineProperty(l.prototype,p,d)})}dispose(){return super.dispose(),this._events=void 0,this}};let Ci=class Ci extends Ai{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}};let Di=class Di extends Ci{constructor(){var l,p,d;super(),this.name="Context",this._constants=new Map,this._timeouts=new wi,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;let f=ui(Di.getDefaults(),arguments,["context"]);f.context?(this._context=f.context,this._latencyHint=(null===(l=arguments[0])||void 0===l?void 0:l.latencyHint)||""):(this._context=(d={latencyHint:f.latencyHint},new s8(d)),this._latencyHint=f.latencyHint),this._ticker=new ii(this.emit.bind(this,"tick"),f.clockSource,f.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[(null===(p=arguments[0])||void 0===p?void 0:p.hasOwnProperty("updateInterval"))?"_lookAhead":"lookAhead"]=f.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var l;return this._initialized||(l=this,i_.forEach(p=>p(l)),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(l,p,d){return this._context.createBuffer(l,p,d)}createChannelMerger(l){return this._context.createChannelMerger(l)}createChannelSplitter(l){return this._context.createChannelSplitter(l)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(l){return this._context.createDelay(l)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(l,p){return this._context.createIIRFilter(l,p)}createPanner(){return this._context.createPanner()}createPeriodicWave(l,p,d){return this._context.createPeriodicWave(l,p,d)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(l){return Bn(On(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(l)}createMediaElementSource(l){return Bn(On(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(l)}createMediaStreamDestination(){return Bn(On(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(l){return this._context.decodeAudioData(l)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(l){Bn(!this._initialized,"The listener cannot be set after initialization."),this._listener=l}get transport(){return this.initialize(),this._transport}set transport(l){Bn(!this._initialized,"The transport cannot be set after initialization."),this._transport=l}get draw(){return this.initialize(),this._draw}set draw(l){Bn(!this._initialized,"Draw cannot be set after initialization."),this._draw=l}get destination(){return this.initialize(),this._destination}set destination(l){Bn(!this._initialized,"The destination cannot be set after initialization."),this._destination=l}createAudioWorkletNode(l,p){var d;return d=this.rawContext,Bn(In(s7),"This node only works in a secure context (https or localhost)"),new s7(d,l,p)}addAudioWorkletModule(l){return ni(this,void 0,void 0,function*(){Bn(In(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(l)),yield this._workletPromise})}workletsAreReady(){return ni(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(l){this._ticker.updateInterval=l}get clockSource(){return this._ticker.type}set clockSource(l){this._ticker.type=l}get lookAhead(){return this._lookAhead}set lookAhead(l){this._lookAhead=l,this.updateInterval=l?l/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return On(this._context)?this._context.resume():Promise.resolve()}close(){return ni(this,void 0,void 0,function*(){var l;On(this._context)&&"closed"!==this.state&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&(l=this,im.forEach(p=>p(l)))})}getConstant(l){if(this._constants.has(l))return this._constants.get(l);{let p=this._context.createBuffer(1,128,this._context.sampleRate),d=p.getChannelData(0);for(let p=0;p<d.length;p++)d[p]=l;let f=this._context.createBufferSource();return f.channelCount=1,f.channelCountMode="explicit",f.buffer=p,f.loop=!0,f.start(0),this._constants.set(l,f),f}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(l=>this._constants[l].disconnect()),this.close(),this}_timeoutLoop(){let l=this.now(),p=this._timeouts.peek();for(;this._timeouts.length&&p&&p.time<=l;)p.callback(),this._timeouts.shift(),p=this._timeouts.peek()}setTimeout(l,p){this._timeoutIds++;let d=this.now();return this._timeouts.add({callback:l,id:this._timeoutIds,time:d+p}),this._timeoutIds}clearTimeout(l){return this._timeouts.forEach(p=>{p.id===l&&this._timeouts.remove(p)}),this}clearInterval(l){return this.clearTimeout(l)}setInterval(l,p){let d=++this._timeoutIds,n=()=>{let f=this.now();this._timeouts.add({callback:()=>{l(),n()},id:d,time:f+p})};return n(),d}};function Oi(l,p){Ln(p)?p.forEach(p=>Oi(l,p)):Object.defineProperty(l,p,{enumerable:!0,writable:!1})}function Mi(l,p){Ln(p)?p.forEach(p=>Mi(l,p)):Object.defineProperty(l,p,{writable:!0})}let Ei=()=>{};let Ri=class Ri extends fi{constructor(){super(),this.name="ToneAudioBuffer",this.onload=Ei;let l=ui(Ri.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=l.reverse,this.onload=l.onload,zn(l.url)?this.load(l.url).catch(l.onerror):l.url&&this.set(l.url)}static getDefaults(){return{onerror:Ei,onload:Ei,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Vi().sampleRate}set(l){return l instanceof Ri?l.loaded?this._buffer=l.get():l.onload=()=>{this.set(l),this.onload(this)}:this._buffer=l,this._reversed&&this._reverse(),this}get(){return this._buffer}load(l){return ni(this,void 0,void 0,function*(){let p=Ri.load(l).then(l=>{this.set(l),this.onload(this)});Ri.downloads.push(p);try{yield p}finally{let l=Ri.downloads.indexOf(p);Ri.downloads.splice(l,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(l){let p=Ln(l)&&l[0].length>0,d=p?l.length:1,f=p?l[0].length:l.length,_=Vi(),m=_.createBuffer(d,f,_.sampleRate),O=p||1!==d?l:[l];for(let l=0;l<d;l++)m.copyToChannel(O[l],l);return this._buffer=m,this}toMono(l){if(Nn(l))this.fromArray(this.toArray(l));else{let l=new Float32Array(this.length),p=this.numberOfChannels;for(let d=0;d<p;d++){let p=this.toArray(d);for(let d=0;d<p.length;d++)l[d]+=p[d]}l=l.map(l=>l/p),this.fromArray(l)}return this}toArray(l){if(Nn(l))return this.getChannelData(l);if(1===this.numberOfChannels)return this.toArray(0);{let l=[];for(let p=0;p<this.numberOfChannels;p++)l[p]=this.getChannelData(p);return l}}getChannelData(l){return this._buffer?this._buffer.getChannelData(l):new Float32Array(0)}slice(l,p=this.duration){Bn(this.loaded,"Buffer is not loaded");let d=Math.floor(l*this.sampleRate),f=Math.floor(p*this.sampleRate);Bn(d<f,"The start time must be less than the end time");let _=f-d,m=Vi().createBuffer(this.numberOfChannels,_,this.sampleRate);for(let l=0;l<this.numberOfChannels;l++)m.copyToChannel(this.getChannelData(l).subarray(d,f),l);return new Ri(m)}_reverse(){if(this.loaded)for(let l=0;l<this.numberOfChannels;l++)this.getChannelData(l).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(l){this._reversed!==l&&(this._reversed=l,this._reverse())}static fromArray(l){return(new Ri).fromArray(l)}static fromUrl(l){return ni(this,void 0,void 0,function*(){let p=new Ri;return yield p.load(l)})}static load(l){return ni(this,void 0,void 0,function*(){let p=l.match(/\[([^\]\[]+\|.+)\]$/);if(p){let d=p[1].split("|"),f=d[0];for(let l of d)if(Ri.supportsType(l)){f=l;break}l=l.replace(p[0],f)}let d=""===Ri.baseUrl||Ri.baseUrl.endsWith("/")?Ri.baseUrl:Ri.baseUrl+"/",f=document.createElement("a");f.href=d+l,f.pathname=(f.pathname+f.hash).split("/").map(encodeURIComponent).join("/");let _=yield fetch(f.href);if(!_.ok)throw Error(`could not load url: ${l}`);let m=yield _.arrayBuffer();return yield Vi().decodeAudioData(m)})}static supportsType(l){let p=l.split("."),d=p[p.length-1];return""!==document.createElement("audio").canPlayType("audio/"+d)}static loaded(){return ni(this,void 0,void 0,function*(){for(yield Promise.resolve();Ri.downloads.length;)yield Ri.downloads[0]})}};Ri.baseUrl="",Ri.downloads=[];let qi=class qi extends Di{constructor(){var l,p,d,f,_,m;super({clockSource:"offline",context:(f=arguments[0],Rn(f))?arguments[0]:(l=arguments[0],p=arguments[1]*arguments[2],d=arguments[2],new is(l,p,d)),lookAhead:0,updateInterval:(_=arguments[0],Rn(_))?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,m=arguments[0],this._duration=Rn(m)?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(l){return ni(this,void 0,void 0,function*(){let p=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,p++;let d=Math.floor(this.sampleRate/128);l&&p%d==0&&(yield new Promise(l=>setTimeout(l,1)))}})}render(l=!0){return ni(this,void 0,void 0,function*(){yield this.workletsAreReady(),yield this._renderClock(l);let p=yield this._context.startRendering();return new Ri(p)})}close(){return Promise.resolve()}};let ig=new class extends Ci{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(l,p,d){return{}}createChannelMerger(l){return{}}createChannelSplitter(l){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(l){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(l,p){return{}}createPanner(){return{}}createPeriodicWave(l,p,d){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(l){return{}}createMediaElementSource(l){return{}}createMediaStreamDestination(){return{}}decodeAudioData(l){return Promise.resolve({})}createAudioWorkletNode(l,p){return{}}get rawContext(){return{}}addAudioWorkletModule(l){return ni(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(l,p){return 0}clearTimeout(l){return this}setInterval(l,p){return 0}clearInterval(l){return this}getConstant(l){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(l){}get destination(){return{}}set destination(l){}now(){return 0}immediate(){return 0}},iv=ig;function Vi(){return iv===ig&&id&&Ni(new Di),iv}function Ni(l,p=!1){p&&iv.dispose(),iv=On(l)?new Di(l):Rn(l)?new qi(l):l}function Pi(){return iv.resume()}if(ip&&!ip.TONE_SILENCE_LOGGING){let l="v";"dev"===eR&&(l="");let p=` * Tone.js ${l}${eR} * `;console.log(`%c${p}`,"background: #000; color: #fff")}function ji(l){return Math.pow(10,l/20)}function Li(l){return Math.log(l)/Math.LN10*20}function zi(l){return Math.pow(2,l/12)}let iy=440;function Bi(l){return Math.round(Ui(l))}function Ui(l){return 69+12*Math.log2(l/iy)}function Gi(l){return iy*Math.pow(2,(l-69)/12)}let Qi=class Qi extends fi{constructor(l,p,d){super(),this.defaultUnits="s",this._val=p,this._units=d,this.context=l,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:l=>this._frequencyToUnits(parseFloat(l)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:l=>this._ticksToUnits(parseInt(l,10)),regexp:/^(\d+)i$/i},m:{method:l=>this._beatsToUnits(parseInt(l,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(l,p)=>{let d=parseInt(l,10),f="."===p?1.5:1;return 1===d?this._beatsToUnits(this._getTimeSignature())*f:this._beatsToUnits(4/d)*f},regexp:/^(\d+)n(\.?)$/i},number:{method:l=>this._expressions[this.defaultUnits].method.call(this,l),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:l=>this._secondsToUnits(parseFloat(l)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:l=>parseInt(l,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:l=>{let p=parseInt(l,10);return this._beatsToUnits(8/(3*Math.floor(p)))},regexp:/^(\d+)t$/i},tr:{method:(l,p,d)=>{let f=0;return l&&"0"!==l&&(f+=this._beatsToUnits(this._getTimeSignature()*parseFloat(l))),p&&"0"!==p&&(f+=this._beatsToUnits(parseFloat(p))),d&&"0"!==d&&(f+=this._beatsToUnits(parseFloat(d)/4)),f},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof Qi&&this.fromType(this._val),Fn(this._val))return this._noArg();if(zn(this._val)&&Fn(this._units)){for(let l in this._expressions)if(this._expressions[l].regexp.test(this._val.trim())){this._units=l;break}}else if(Pn(this._val)){let l=0;for(let p in this._val)if(In(this._val[p])){let d=this._val[p];l+=new this.constructor(this.context,p).valueOf()*d}return l}if(In(this._units)){let l=this._expressions[this._units],p=this._val.toString().trim().match(l.regexp);return p?l.method.apply(this,p.slice(1)):l.method.call(this,this._val)}return zn(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(l){return 1/l}_beatsToUnits(l){return 60/this._getBpm()*l}_secondsToUnits(l){return l}_ticksToUnits(l){return l*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(l){switch(this._units=void 0,this.defaultUnits){case"s":this._val=l.toSeconds();break;case"i":this._val=l.toTicks();break;case"hz":this._val=l.toFrequency();break;case"midi":this._val=l.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}};let Zi=class Zi extends Qi{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:l=>this._now()+new this.constructor(this.context,l).valueOf(),regexp:/^\+(.+)/},quantize:{method:l=>{let p=new Zi(this.context,l).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(p))},regexp:/^@(.+)/}})}quantize(l,p=1){let d=new this.constructor(this.context,l).valueOf(),f=this.valueOf();return f+(Math.round(f/d)*d-f)*p}toNotation(){let l=this.toSeconds(),p=["1m"];for(let l=1;l<9;l++){let d=Math.pow(2,l);p.push(d+"n."),p.push(d+"n"),p.push(d+"t")}p.push("0");let d=p[0],f=new Zi(this.context,p[0]).toSeconds();return p.forEach(p=>{let _=new Zi(this.context,p).toSeconds();Math.abs(_-l)<Math.abs(f-l)&&(d=p,f=_)}),d}toBarsBeatsSixteenths(){let l=this._beatsToUnits(1),p=this.valueOf()/l;p=parseFloat(p.toFixed(4));let d=Math.floor(p/this._getTimeSignature()),f=p%1*4;p=Math.floor(p)%this._getTimeSignature();let _=f.toString();return _.length>3&&(f=parseFloat(parseFloat(_).toFixed(3))),[d,p,f].join(":")}toTicks(){let l=this._beatsToUnits(1);return this.valueOf()/l*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return Bi(this.toFrequency())}_now(){return this.context.now()}};function Xi(l,p){return new Zi(Vi(),l,p)}let Yi=class Yi extends Zi{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return iy}static set A4(l){iy=l}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(l){return"midi"===this.defaultUnits?l:Yi.mtof(l)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(l,p){let d=ix[l.toLowerCase()]+12*(parseInt(p,10)+1);return"midi"===this.defaultUnits?d:Yi.mtof(d)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(l,p,d){let f=1;return l&&"0"!==l&&(f*=this._beatsToUnits(this._getTimeSignature()*parseFloat(l))),p&&"0"!==p&&(f*=this._beatsToUnits(parseFloat(p))),d&&"0"!==d&&(f*=this._beatsToUnits(parseFloat(d)/4)),f}}})}transpose(l){return new Yi(this.context,this.valueOf()*zi(l))}harmonize(l){return l.map(l=>this.transpose(l))}toMidi(){return Bi(this.valueOf())}toNote(){let l=this.toFrequency(),p=Math.log2(l/Yi.A4),d=Math.round(12*p)+57,f=Math.floor(d/12);return f<0&&(d+=-12*f),ib[d%12]+f.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){let l=this._beatsToUnits(1),p=this.valueOf()/l;return Math.floor(p*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(l){return l}_ticksToUnits(l){return 1/(60*l/(this._getBpm()*this._getPPQ()))}_beatsToUnits(l){return 1/super._beatsToUnits(l)}_secondsToUnits(l){return 1/l}static mtof(l){return Gi(l)}static ftom(l){return Bi(l)}};let ix={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},ib=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function Ji(l,p){return new Yi(Vi(),l,p)}let Ki=class Ki extends Zi{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}};function to(l,p){return new Ki(Vi(),l,p)}let eo=class eo extends fi{constructor(){super();let l=ui(eo.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=l.context}static getDefaults(){return{context:Vi()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(l){return Yn(l),new Zi(this.context,l).toSeconds()}toFrequency(l){return new Yi(this.context,l).toFrequency()}toTicks(l){return new Ki(this.context,l).toTicks()}_getPartialProperties(l){let p=this.get();return Object.keys(p).forEach(d=>{Fn(l[d])&&delete p[d]}),p}get(){let l=this.constructor.getDefaults();return Object.keys(l).forEach(p=>{if(Reflect.has(this,p)){let d=this[p];In(d)&&In(d.value)&&In(d.setValueAtTime)?l[p]=d.value:d instanceof eo?l[p]=d._getPartialProperties(l[p]):Ln(d)||Nn(d)||zn(d)||jn(d)?l[p]=d:delete l[p]}}),l}set(l){return Object.keys(l).forEach(p=>{Reflect.has(this,p)&&In(this[p])&&(this[p]&&In(this[p].value)&&In(this[p].setValueAtTime)?this[p].value!==l[p]&&(this[p].value=l[p]):this[p]instanceof eo?this[p].set(l[p]):this[p]=l[p])}),this}};let so=class so extends wi{constructor(l="stopped"){super(),this.name="StateTimeline",this._initial=l,this.setStateAtTime(this._initial,0)}getValueAtTime(l){let p=this.get(l);return null!==p?p.state:this._initial}setStateAtTime(l,p,d){return Un(p,0),this.add(Object.assign({},d,{state:l,time:p})),this}getLastState(l,p){for(let d=this._search(p);d>=0;d--){let p=this._timeline[d];if(p.state===l)return p}}getNextState(l,p){let d=this._search(p);if(-1!==d)for(let p=d;p<this._timeline.length;p++){let d=this._timeline[p];if(d.state===l)return d}}};let no=class no extends eo{constructor(){super(ui(no.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;let l=ui(no.getDefaults(),arguments,["param","units","convert"]);for(Bn(In(l.param)&&(En(l.param)||l.param instanceof no),"param must be an AudioParam");!En(l.param);)l.param=l.param._param;this._swappable=!!In(l.swappable)&&l.swappable,this._swappable?(this.input=this.context.createGain(),this._param=l.param,this.input.connect(this._param)):this._param=this.input=l.param,this._events=new wi(1e3),this._initialValue=this._param.defaultValue,this.units=l.units,this.convert=l.convert,this._minValue=l.minValue,this._maxValue=l.maxValue,In(l.value)&&l.value!==this._toType(this._initialValue)&&this.setValueAtTime(l.value,0)}static getDefaults(){return Object.assign(eo.getDefaults(),{convert:!0,units:"number"})}get value(){let l=this.now();return this.getValueAtTime(l)}set value(l){this.cancelScheduledValues(this.now()),this.setValueAtTime(l,this.now())}get minValue(){return In(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return In(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(l,p){return this.units===p}_assertRange(l){return In(this.maxValue)&&In(this.minValue)&&Un(l,this._fromType(this.minValue),this._fromType(this.maxValue)),l}_fromType(l){return this.convert&&!this.overridden?this._is(l,"time")?this.toSeconds(l):this._is(l,"decibels")?ji(l):this._is(l,"frequency")?this.toFrequency(l):l:this.overridden?0:l}_toType(l){return this.convert&&"decibels"===this.units?Li(l):l}setValueAtTime(l,p){let d=this.toSeconds(p),f=this._fromType(l);return Bn(isFinite(f)&&isFinite(d),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(l)}, ${JSON.stringify(p)}`),this._assertRange(f),this.log(this.units,"setValueAtTime",l,d),this._events.add({time:d,type:"setValueAtTime",value:f}),this._param.setValueAtTime(f,d),this}getValueAtTime(l){let p=Math.max(this.toSeconds(l),0),d=this._events.getAfter(p),f=this._events.get(p),_=this._initialValue;if(null===f)_=this._initialValue;else if("setTargetAtTime"!==f.type||null!==d&&"setValueAtTime"!==d.type){if(null===d)_=f.value;else if("linearRampToValueAtTime"===d.type||"exponentialRampToValueAtTime"===d.type){let l=f.value;if("setTargetAtTime"===f.type){let p=this._events.getBefore(f.time);l=null===p?this._initialValue:p.value}_="linearRampToValueAtTime"===d.type?this._linearInterpolate(f.time,l,d.time,d.value,p):this._exponentialInterpolate(f.time,l,d.time,d.value,p)}else _=f.value}else{let l;let d=this._events.getBefore(f.time);l=null===d?this._initialValue:d.value,"setTargetAtTime"===f.type&&(_=this._exponentialApproach(f.time,l,f.value,f.constant,p))}return this._toType(_)}setRampPoint(l){l=this.toSeconds(l);let p=this.getValueAtTime(l);return this.cancelAndHoldAtTime(l),0===this._fromType(p)&&(p=this._toType(this._minOutput)),this.setValueAtTime(p,l),this}linearRampToValueAtTime(l,p){let d=this._fromType(l),f=this.toSeconds(p);return Bn(isFinite(d)&&isFinite(f),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(l)}, ${JSON.stringify(p)}`),this._assertRange(d),this._events.add({time:f,type:"linearRampToValueAtTime",value:d}),this.log(this.units,"linearRampToValueAtTime",l,f),this._param.linearRampToValueAtTime(d,f),this}exponentialRampToValueAtTime(l,p){let d=this._fromType(l);d=yi(d,0)?this._minOutput:d,this._assertRange(d);let f=this.toSeconds(p);return Bn(isFinite(d)&&isFinite(f),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(l)}, ${JSON.stringify(p)}`),this._events.add({time:f,type:"exponentialRampToValueAtTime",value:d}),this.log(this.units,"exponentialRampToValueAtTime",l,f),this._param.exponentialRampToValueAtTime(d,f),this}exponentialRampTo(l,p,d){return d=this.toSeconds(d),this.setRampPoint(d),this.exponentialRampToValueAtTime(l,d+this.toSeconds(p)),this}linearRampTo(l,p,d){return d=this.toSeconds(d),this.setRampPoint(d),this.linearRampToValueAtTime(l,d+this.toSeconds(p)),this}targetRampTo(l,p,d){return d=this.toSeconds(d),this.setRampPoint(d),this.exponentialApproachValueAtTime(l,d,p),this}exponentialApproachValueAtTime(l,p,d){p=this.toSeconds(p),d=this.toSeconds(d);let f=Math.log(d+1)/Math.log(200);return this.setTargetAtTime(l,p,f),this.cancelAndHoldAtTime(p+.9*d),this.linearRampToValueAtTime(l,p+d),this}setTargetAtTime(l,p,d){let f=this._fromType(l);Bn(isFinite(d)&&d>0,"timeConstant must be a number greater than 0");let _=this.toSeconds(p);return this._assertRange(f),Bn(isFinite(f)&&isFinite(_),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(l)}, ${JSON.stringify(p)}`),this._events.add({constant:d,time:_,type:"setTargetAtTime",value:f}),this.log(this.units,"setTargetAtTime",l,_,d),this._param.setTargetAtTime(f,_,d),this}setValueCurveAtTime(l,p,d,f=1){d=this.toSeconds(d),p=this.toSeconds(p);let _=this._fromType(l[0])*f;this.setValueAtTime(this._toType(_),p);let m=d/(l.length-1);for(let d=1;d<l.length;d++){let _=this._fromType(l[d])*f;this.linearRampToValueAtTime(this._toType(_),p+d*m)}return this}cancelScheduledValues(l){let p=this.toSeconds(l);return Bn(isFinite(p),`Invalid argument to cancelScheduledValues: ${JSON.stringify(l)}`),this._events.cancel(p),this._param.cancelScheduledValues(p),this.log(this.units,"cancelScheduledValues",p),this}cancelAndHoldAtTime(l){let p=this.toSeconds(l),d=this._fromType(this.getValueAtTime(p));Bn(isFinite(p),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(l)}`),this.log(this.units,"cancelAndHoldAtTime",p,"value="+d);let f=this._events.get(p),_=this._events.getAfter(p);return f&&yi(f.time,p)?_?(this._param.cancelScheduledValues(_.time),this._events.cancel(_.time)):(this._param.cancelAndHoldAtTime(p),this._events.cancel(p+this.sampleTime)):_&&(this._param.cancelScheduledValues(_.time),this._events.cancel(_.time),"linearRampToValueAtTime"===_.type?this.linearRampToValueAtTime(this._toType(d),p):"exponentialRampToValueAtTime"===_.type&&this.exponentialRampToValueAtTime(this._toType(d),p)),this._events.add({time:p,type:"setValueAtTime",value:d}),this._param.setValueAtTime(d,p),this}rampTo(l,p=.1,d){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(l,p,d):this.linearRampTo(l,p,d),this}apply(l){let p=this.context.currentTime;l.setValueAtTime(this.getValueAtTime(p),p);let d=this._events.get(p);if(d&&"setTargetAtTime"===d.type){let f=this._events.getAfter(d.time),_=f?f.time:p+2,m=(_-p)/10;for(let d=p;d<_;d+=m)l.linearRampToValueAtTime(this.getValueAtTime(d),d)}return this._events.forEachAfter(this.context.currentTime,p=>{"cancelScheduledValues"===p.type?l.cancelScheduledValues(p.time):"setTargetAtTime"===p.type?l.setTargetAtTime(p.value,p.time,p.constant):l[p.type](p.value,p.time)}),this}setParam(l){Bn(this._swappable,"The Param must be assigned as 'swappable' in the constructor");let p=this.input;return p.disconnect(this._param),this.apply(l),this._param=l,p.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(l,p,d,f,_){return d+(p-d)*Math.exp(-(_-l)/f)}_linearInterpolate(l,p,d,f,_){return p+(_-l)/(d-l)*(f-p)}_exponentialInterpolate(l,p,d,f,_){return p*Math.pow(f/p,(_-l)/(d-l))}};let io=class io extends eo{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return In(this.input)?En(this.input)||this.input instanceof no?1:this.input.numberOfInputs:0}get numberOfOutputs(){return In(this.output)?this.output.numberOfOutputs:0}_isAudioNode(l){return In(l)&&(l instanceof io||Mn(l))}_getInternalNodes(){let l=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&l.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&l.push(this.output),l}_setChannelProperties(l){this._getInternalNodes().forEach(p=>{p.channelCount=l.channelCount,p.channelCountMode=l.channelCountMode,p.channelInterpretation=l.channelInterpretation})}_getChannelProperties(){let l=this._getInternalNodes();Bn(l.length>0,"ToneAudioNode does not have any internal nodes");let p=l[0];return{channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(l){let p=this._getChannelProperties();this._setChannelProperties(Object.assign(p,{channelCount:l}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(l){let p=this._getChannelProperties();this._setChannelProperties(Object.assign(p,{channelCountMode:l}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(l){let p=this._getChannelProperties();this._setChannelProperties(Object.assign(p,{channelInterpretation:l}))}connect(l,p=0,d=0){return ro(this,l,p,d),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return Kn("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(l,p=0,d=0){return ao(this,l,p,d),this}chain(...l){return oo(this,...l),this}fan(...l){return l.forEach(l=>this.connect(l)),this}dispose(){return super.dispose(),In(this.input)&&(this.input instanceof io?this.input.dispose():Mn(this.input)&&this.input.disconnect()),In(this.output)&&(this.output instanceof io?this.output.dispose():Mn(this.output)&&this.output.disconnect()),this._internalChannels=[],this}};function oo(...l){let p=l.shift();l.reduce((l,p)=>(l instanceof io?l.connect(p):Mn(l)&&ro(l,p),p),p)}function ro(l,p,d=0,f=0){for(Bn(In(l),"Cannot connect from undefined node"),Bn(In(p),"Cannot connect to undefined node"),(p instanceof io||Mn(p))&&Bn(p.numberOfInputs>0,"Cannot connect to node with no inputs"),Bn(l.numberOfOutputs>0,"Cannot connect from node with no outputs");p instanceof io||p instanceof no;)In(p.input)&&(p=p.input);for(;l instanceof io;)In(l.output)&&(l=l.output);En(p)?l.connect(p,d):l.connect(p,d,f)}function ao(l,p,d=0,f=0){if(In(p))for(;p instanceof io;)p=p.input;for(;!Mn(l);)In(l.output)&&(l=l.output);En(p)?l.disconnect(p,d):Mn(p)?l.disconnect(p,d,f):l.disconnect()}function co(...l){let p=l.pop();In(p)&&l.forEach(l=>ro(l,p))}let ho=class ho extends io{constructor(){super(ui(ho.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;let l=ui(ho.getDefaults(),arguments,["gain","units"]);this.gain=new no({context:this.context,convert:l.convert,param:this._gainNode.gain,units:l.units,value:l.gain,minValue:l.minValue,maxValue:l.maxValue}),Oi(this,"gain")}static getDefaults(){return Object.assign(io.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}};let lo=class lo extends io{constructor(l){super(l),this.onended=Ei,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new ho({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(l){let p=this.toSeconds(l);return -1!==this._startTime&&p>=this._startTime&&(-1===this._stopTime||p<=this._stopTime)?"started":"stopped"},this._fadeIn=l.fadeIn,this._fadeOut=l.fadeOut,this._curve=l.curve,this.onended=l.onended}static getDefaults(){return Object.assign(io.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Ei})}_startGain(l,p=1){Bn(-1===this._startTime,"Source cannot be started more than once");let d=this.toSeconds(this._fadeIn);return this._startTime=l+d,this._startTime=Math.max(this._startTime,this.context.currentTime),d>0?(this._gainNode.gain.setValueAtTime(0,l),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(p,l+d):this._gainNode.gain.exponentialApproachValueAtTime(p,l,d)):this._gainNode.gain.setValueAtTime(p,l),this}stop(l){return this.log("stop",l),this._stopGain(this.toSeconds(l)),this}_stopGain(l){Bn(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();let p=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(l)+p,this._stopTime=Math.max(this._stopTime,this.now()),p>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,p,l):this._gainNode.gain.targetRampTo(0,p,l):(this._gainNode.gain.cancelAndHoldAtTime(l),this._gainNode.gain.setValueAtTime(0,l)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{let l="exponential"===this._curve?2*p:0;this._stopSource(this.now()+l),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Ei&&(this.onended(this),this.onended=Ei,!this.context.isOffline)){let t=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),Bn(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=Ei,this}};let uo=class uo extends lo{constructor(){super(ui(uo.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();let l=ui(uo.getDefaults(),arguments,["offset"]);ro(this._source,this._gainNode),this.offset=new no({context:this.context,convert:l.convert,param:this._source.offset,units:l.units,value:l.offset,minValue:l.minValue,maxValue:l.maxValue})}static getDefaults(){return Object.assign(lo.getDefaults(),{convert:!0,offset:1,units:"number"})}start(l){let p=this.toSeconds(l);return this.log("start",p),this._startGain(p),this._source.start(p),this}_stopSource(l){this._source.stop(l)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}};let po=class po extends io{constructor(){super(ui(po.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;let l=ui(po.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new uo({context:this.context,convert:l.convert,offset:l.value,units:l.units,minValue:l.minValue,maxValue:l.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(io.getDefaults(),{convert:!0,units:"number",value:0})}connect(l,p=0,d=0){return fo(this,l,p,d),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(l,p){return this._param.setValueAtTime(l,p),this}getValueAtTime(l){return this._param.getValueAtTime(l)}setRampPoint(l){return this._param.setRampPoint(l),this}linearRampToValueAtTime(l,p){return this._param.linearRampToValueAtTime(l,p),this}exponentialRampToValueAtTime(l,p){return this._param.exponentialRampToValueAtTime(l,p),this}exponentialRampTo(l,p,d){return this._param.exponentialRampTo(l,p,d),this}linearRampTo(l,p,d){return this._param.linearRampTo(l,p,d),this}targetRampTo(l,p,d){return this._param.targetRampTo(l,p,d),this}exponentialApproachValueAtTime(l,p,d){return this._param.exponentialApproachValueAtTime(l,p,d),this}setTargetAtTime(l,p,d){return this._param.setTargetAtTime(l,p,d),this}setValueCurveAtTime(l,p,d,f){return this._param.setValueCurveAtTime(l,p,d,f),this}cancelScheduledValues(l){return this._param.cancelScheduledValues(l),this}cancelAndHoldAtTime(l){return this._param.cancelAndHoldAtTime(l),this}rampTo(l,p,d){return this._param.rampTo(l,p,d),this}get value(){return this._param.value}set value(l){this._param.value=l}get convert(){return this._param.convert}set convert(l){this._param.convert=l}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(l){this._param.overridden=l}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(l){return this._param.apply(l),this}};function fo(l,p,d,f){(p instanceof no||En(p)||p instanceof po&&p.override)&&(p.cancelScheduledValues(0),p.setValueAtTime(0,0),p instanceof po&&(p.overridden=!0)),ro(l,p,d,f)}let _o=class _o extends no{constructor(){super(ui(_o.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new wi(1/0),this._multiplier=1;let l=ui(_o.getDefaults(),arguments,["value"]);this._multiplier=l.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(l.value)}),this.setValueAtTime(l.value,0)}static getDefaults(){return Object.assign(no.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(l,p,d){p=this.toSeconds(p),this.setRampPoint(p);let f=this._fromType(l),_=this._events.get(p),m=Math.round(Math.max(1/d,1));for(let l=0;l<=m;l++){let m=d*l+p,O=this._exponentialApproach(_.time,_.value,f,d,m);this.linearRampToValueAtTime(this._toType(O),m)}return this}setValueAtTime(l,p){let d=this.toSeconds(p);super.setValueAtTime(l,p);let f=this._events.get(d),_=this._events.previousEvent(f),m=this._getTicksUntilEvent(_,d);return f.ticks=Math.max(m,0),this}linearRampToValueAtTime(l,p){let d=this.toSeconds(p);super.linearRampToValueAtTime(l,p);let f=this._events.get(d),_=this._events.previousEvent(f),m=this._getTicksUntilEvent(_,d);return f.ticks=Math.max(m,0),this}exponentialRampToValueAtTime(l,p){p=this.toSeconds(p);let d=this._fromType(l),f=this._events.get(p),_=Math.round(Math.max(10*(p-f.time),1)),m=(p-f.time)/_;for(let l=0;l<=_;l++){let _=m*l+f.time,O=this._exponentialInterpolate(f.time,f.value,p,d,_);this.linearRampToValueAtTime(this._toType(O),_)}return this}_getTicksUntilEvent(l,p){if(null===l)l={ticks:0,time:0,type:"setValueAtTime",value:0};else if(Fn(l.ticks)){let p=this._events.previousEvent(l);l.ticks=this._getTicksUntilEvent(p,l.time)}let d=this._fromType(this.getValueAtTime(l.time)),f=this._fromType(this.getValueAtTime(p)),_=this._events.get(p);return _&&_.time===p&&"setValueAtTime"===_.type&&(f=this._fromType(this.getValueAtTime(p-this.sampleTime))),.5*(p-l.time)*(d+f)+l.ticks}getTicksAtTime(l){let p=this.toSeconds(l),d=this._events.get(p);return Math.max(this._getTicksUntilEvent(d,p),0)}getDurationOfTicks(l,p){let d=this.toSeconds(p),f=this.getTicksAtTime(p);return this.getTimeOfTick(f+l)-d}getTimeOfTick(l){let p=this._events.get(l,"ticks"),d=this._events.getAfter(l,"ticks");if(p&&p.ticks===l)return p.time;if(p&&d&&"linearRampToValueAtTime"===d.type&&p.value!==d.value){let f=this._fromType(this.getValueAtTime(p.time)),_=(this._fromType(this.getValueAtTime(d.time))-f)/(d.time-p.time),m=Math.sqrt(Math.pow(f,2)-2*_*(p.ticks-l)),O=(-f+m)/_;return(O>0?O:(-f-m)/_)+p.time}return p?0===p.value?1/0:p.time+(l-p.ticks)/p.value:l/this._initialValue}ticksToTime(l,p){return this.getDurationOfTicks(l,p)}timeToTicks(l,p){let d=this.toSeconds(p),f=this.toSeconds(l),_=this.getTicksAtTime(d);return this.getTicksAtTime(d+f)-_}_fromType(l){return"bpm"===this.units&&this.multiplier?1/(60/l/this.multiplier):super._fromType(l)}_toType(l){return"bpm"===this.units&&this.multiplier?l/this.multiplier*60:super._toType(l)}get multiplier(){return this._multiplier}set multiplier(l){let p=this.value;this._multiplier=l,this.cancelScheduledValues(0),this.setValueAtTime(p,0)}};let mo=class mo extends po{constructor(){super(ui(mo.getDefaults(),arguments,["value"])),this.name="TickSignal";let l=ui(mo.getDefaults(),arguments,["value"]);this.input=this._param=new _o({context:this.context,convert:l.convert,multiplier:l.multiplier,param:this._constantSource.offset,units:l.units,value:l.value})}static getDefaults(){return Object.assign(po.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(l,p){return this._param.ticksToTime(l,p)}timeToTicks(l,p){return this._param.timeToTicks(l,p)}getTimeOfTick(l){return this._param.getTimeOfTick(l)}getDurationOfTicks(l,p){return this._param.getDurationOfTicks(l,p)}getTicksAtTime(l){return this._param.getTicksAtTime(l)}get multiplier(){return this._param.multiplier}set multiplier(l){this._param.multiplier=l}dispose(){return super.dispose(),this._param.dispose(),this}};let go=class go extends eo{constructor(){super(ui(go.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new so,this._tickOffset=new wi,this._ticksAtTime=new wi,this._secondsAtTime=new wi;let l=ui(go.getDefaults(),arguments,["frequency"]);this.frequency=new mo({context:this.context,units:l.units,value:l.frequency}),Oi(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},eo.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(l,p){let d=this.toSeconds(l);return"started"!==this._state.getValueAtTime(d)&&(this._state.setStateAtTime("started",d),In(p)&&this.setTicksAtTime(p,d),this._ticksAtTime.cancel(d),this._secondsAtTime.cancel(d)),this}stop(l){let p=this.toSeconds(l);if("stopped"===this._state.getValueAtTime(p)){let l=this._state.get(p);l&&l.time>0&&(this._tickOffset.cancel(l.time),this._state.cancel(l.time))}return this._state.cancel(p),this._state.setStateAtTime("stopped",p),this.setTicksAtTime(0,p),this._ticksAtTime.cancel(p),this._secondsAtTime.cancel(p),this}pause(l){let p=this.toSeconds(l);return"started"===this._state.getValueAtTime(p)&&(this._state.setStateAtTime("paused",p),this._ticksAtTime.cancel(p),this._secondsAtTime.cancel(p)),this}cancel(l){return l=this.toSeconds(l),this._state.cancel(l),this._tickOffset.cancel(l),this._ticksAtTime.cancel(l),this._secondsAtTime.cancel(l),this}getTicksAtTime(l){let p=this.toSeconds(l),d=this._state.getLastState("stopped",p),f=this._ticksAtTime.get(p),_={state:"paused",time:p};this._state.add(_);let m=f||d,O=f?f.ticks:0,I=null;return this._state.forEachBetween(m.time,p+this.sampleTime,l=>{let p=m.time,d=this._tickOffset.get(l.time);d&&d.time>=m.time&&(O=d.ticks,p=d.time),"started"===m.state&&"started"!==l.state&&(O+=this.frequency.getTicksAtTime(l.time)-this.frequency.getTicksAtTime(p),l.time!==_.time&&(I={state:l.state,time:l.time,ticks:O})),m=l}),this._state.remove(_),I&&this._ticksAtTime.add(I),O}get ticks(){return this.getTicksAtTime(this.now())}set ticks(l){this.setTicksAtTime(l,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(l){let p=this.now(),d=this.frequency.timeToTicks(l,p);this.setTicksAtTime(d,p)}getSecondsAtTime(l){l=this.toSeconds(l);let p=this._state.getLastState("stopped",l),d={state:"paused",time:l};this._state.add(d);let f=this._secondsAtTime.get(l),_=f||p,m=f?f.seconds:0,O=null;return this._state.forEachBetween(_.time,l+this.sampleTime,l=>{let p=_.time,f=this._tickOffset.get(l.time);f&&f.time>=_.time&&(m=f.seconds,p=f.time),"started"===_.state&&"started"!==l.state&&(m+=l.time-p,l.time!==d.time&&(O={state:l.state,time:l.time,seconds:m})),_=l}),this._state.remove(d),O&&this._secondsAtTime.add(O),m}setTicksAtTime(l,p){return p=this.toSeconds(p),this._tickOffset.cancel(p),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(l,p),ticks:l,time:p}),this._ticksAtTime.cancel(p),this._secondsAtTime.cancel(p),this}getStateAtTime(l){return l=this.toSeconds(l),this._state.getValueAtTime(l)}getTimeOfTick(l,p=this.now()){let d=this._tickOffset.get(p),f=this._state.get(p),_=Math.max(d.time,f.time),m=this.frequency.getTicksAtTime(_)+l-d.ticks;return this.frequency.getTimeOfTick(m)}forEachTickBetween(l,p,d){let f=this._state.get(l);this._state.forEachBetween(l,p,p=>{f&&"started"===f.state&&"started"!==p.state&&this.forEachTickBetween(Math.max(f.time,l),p.time-this.sampleTime,d),f=p});let _=null;if(f&&"started"===f.state){let m=Math.max(f.time,l),O=this.frequency.getTicksAtTime(m),I=O-this.frequency.getTicksAtTime(f.time),V=Math.ceil(I)-I;V=yi(V,1)?0:V;let F=this.frequency.getTimeOfTick(O+V);for(;F<p;){try{d(F,Math.round(this.getTicksAtTime(F)))}catch(l){_=l;break}F+=this.frequency.getDurationOfTicks(1,F)}}if(_)throw _;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}};let vo=class vo extends eo{constructor(){super(ui(vo.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=Ei,this._lastUpdate=0,this._state=new so("stopped"),this._boundLoop=this._loop.bind(this);let l=ui(vo.getDefaults(),arguments,["callback","frequency"]);this.callback=l.callback,this._tickSource=new go({context:this.context,frequency:l.frequency,units:l.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,Oi(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(eo.getDefaults(),{callback:Ei,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(l,p){Gn(this.context);let d=this.toSeconds(l);return this.log("start",d),"started"!==this._state.getValueAtTime(d)&&(this._state.setStateAtTime("started",d),this._tickSource.start(d,p),d<this._lastUpdate&&this.emit("start",d,p)),this}stop(l){let p=this.toSeconds(l);return this.log("stop",p),this._state.cancel(p),this._state.setStateAtTime("stopped",p),this._tickSource.stop(p),p<this._lastUpdate&&this.emit("stop",p),this}pause(l){let p=this.toSeconds(l);return"started"===this._state.getValueAtTime(p)&&(this._state.setStateAtTime("paused",p),this._tickSource.pause(p),p<this._lastUpdate&&this.emit("pause",p)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(l){this._tickSource.ticks=l}get seconds(){return this._tickSource.seconds}set seconds(l){this._tickSource.seconds=l}getSecondsAtTime(l){return this._tickSource.getSecondsAtTime(l)}setTicksAtTime(l,p){return this._tickSource.setTicksAtTime(l,p),this}getTimeOfTick(l,p=this.now()){return this._tickSource.getTimeOfTick(l,p)}getTicksAtTime(l){return this._tickSource.getTicksAtTime(l)}nextTickTime(l,p){let d=this.toSeconds(p),f=this.getTicksAtTime(d);return this._tickSource.getTimeOfTick(f+l,d)}_loop(){let l=this._lastUpdate,p=this.now();this._lastUpdate=p,this.log("loop",l,p),l!==p&&(this._state.forEachBetween(l,p,l=>{switch(l.state){case"started":let p=this._tickSource.getTicksAtTime(l.time);this.emit("start",l.time,p);break;case"stopped":0!==l.time&&this.emit("stop",l.time);break;case"paused":this.emit("pause",l.time)}}),this._tickSource.forEachTickBetween(l,p,(l,p)=>{this.callback(l,p)}))}getStateAtTime(l){let p=this.toSeconds(l);return this._state.getValueAtTime(p)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}};Ai.mixin(vo);let yo=class yo extends io{constructor(){super(ui(yo.getDefaults(),arguments,["delayTime","maxDelay"])),this.name="Delay";let l=ui(yo.getDefaults(),arguments,["delayTime","maxDelay"]),p=this.toSeconds(l.maxDelay);this._maxDelay=Math.max(p,this.toSeconds(l.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(p),this.delayTime=new no({context:this.context,param:this._delayNode.delayTime,units:"time",value:l.delayTime,minValue:0,maxValue:this.maxDelay}),Oi(this,"delayTime")}static getDefaults(){return Object.assign(io.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}};function xo(l,p,d=2,f=Vi().sampleRate){return ni(this,void 0,void 0,function*(){let _=Vi(),m=new qi(d,p,f);Ni(m),yield l(m);let O=m.render();Ni(_);let I=yield O;return new Ri(I)})}let wo=class wo extends fi{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;let l=ui(wo.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=l.baseUrl,Object.keys(l.urls).forEach(p=>{this._loadingCount++;let d=l.urls[p];this.add(p,d,this._bufferLoaded.bind(this,l.onload),l.onerror)})}static getDefaults(){return{baseUrl:"",onerror:Ei,onload:Ei,urls:{}}}has(l){return this._buffers.has(l.toString())}get(l){return Bn(this.has(l),`ToneAudioBuffers has no buffer named: ${l}`),this._buffers.get(l.toString())}_bufferLoaded(l){this._loadingCount--,0===this._loadingCount&&l&&l()}get loaded(){return Array.from(this._buffers).every(([l,p])=>p.loaded)}add(l,p,d=Ei,f=Ei){return zn(p)?(this.baseUrl&&"data:audio/"===p.trim().substring(0,11).toLowerCase()&&(this.baseUrl=""),this._buffers.set(l.toString(),new Ri(this.baseUrl+p,d,f))):this._buffers.set(l.toString(),new Ri(p,d,f)),this}dispose(){return super.dispose(),this._buffers.forEach(l=>l.dispose()),this._buffers.clear(),this}};let bo=class bo extends Yi{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(l){return Bi(super._frequencyToUnits(l))}_ticksToUnits(l){return Bi(super._ticksToUnits(l))}_beatsToUnits(l){return Bi(super._beatsToUnits(l))}_secondsToUnits(l){return Bi(super._secondsToUnits(l))}toMidi(){return this.valueOf()}toFrequency(){return Gi(this.toMidi())}transpose(l){return new bo(this.context,this.toMidi()+l)}};function To(l,p){return new bo(Vi(),l,p)}let So=class So extends Ki{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(l){return this._getPPQ()*l}_secondsToUnits(l){return Math.floor(l/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(l){return l}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}};function ko(l,p){return new So(Vi(),l,p)}let Ao=class Ao extends eo{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new wi,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(l,p){return this._events.add({callback:l,time:this.toSeconds(p)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(l){return this._events.cancel(this.toSeconds(l)),this}_drawLoop(){let l=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=l;){let p=this._events.shift();p&&l-p.time<=this.expiration&&p.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}};Ti(l=>{l.draw=new Ao({context:l})}),ki(l=>{l.draw.dispose()});let Co=class Co extends fi{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(l){Bn(In(l.time),"Events must have a time property"),Bn(In(l.duration),"Events must have a duration parameter"),l.time=l.time.valueOf();let p=new Do(l.time,l.time+l.duration,l);for(null===this._root?this._root=p:this._root.insert(p),this._length++;null!==p;)p.updateHeight(),p.updateMax(),this._rebalance(p),p=p.parent;return this}remove(l){if(null!==this._root){let p=[];for(let d of(this._root.search(l.time,p),p))if(d.event===l){this._removeNode(d),this._length--;break}}return this}get length(){return this._length}cancel(l){return this.forEachFrom(l,l=>this.remove(l)),this}_setRoot(l){this._root=l,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(l,p){null!==l.parent?(l.isLeftChild()?l.parent.left=p:l.parent.right=p,this._rebalance(l.parent)):this._setRoot(p)}_removeNode(l){if(null===l.left&&null===l.right)this._replaceNodeInParent(l,null);else if(null===l.right)this._replaceNodeInParent(l,l.left);else if(null===l.left)this._replaceNodeInParent(l,l.right);else{let p,d=null;if(l.getBalance()>0){if(null===l.left.right)(p=l.left).right=l.right,d=p;else{for(p=l.left.right;null!==p.right;)p=p.right;p.parent&&(p.parent.right=p.left,d=p.parent,p.left=l.left,p.right=l.right)}}else if(null===l.right.left)(p=l.right).left=l.left,d=p;else{for(p=l.right.left;null!==p.left;)p=p.left;p.parent&&(p.parent.left=p.right,d=p.parent,p.left=l.left,p.right=l.right)}null!==l.parent?l.isLeftChild()?l.parent.left=p:l.parent.right=p:this._setRoot(p),d&&this._rebalance(d)}l.dispose()}_rotateLeft(l){let p=l.parent,d=l.isLeftChild(),f=l.right;f&&(l.right=f.left,f.left=l),null!==p?d?p.left=f:p.right=f:this._setRoot(f)}_rotateRight(l){let p=l.parent,d=l.isLeftChild(),f=l.left;f&&(l.left=f.right,f.right=l),null!==p?d?p.left=f:p.right=f:this._setRoot(f)}_rebalance(l){let p=l.getBalance();p>1&&l.left?0>l.left.getBalance()?this._rotateLeft(l.left):this._rotateRight(l):p<-1&&l.right&&(l.right.getBalance()>0?this._rotateRight(l.right):this._rotateLeft(l))}get(l){if(null!==this._root){let p=[];if(this._root.search(l,p),p.length>0){let l=p[0];for(let d=1;d<p.length;d++)p[d].low>l.low&&(l=p[d]);return l.event}}return null}forEach(l){if(null!==this._root){let p=[];this._root.traverse(l=>p.push(l)),p.forEach(p=>{p.event&&l(p.event)})}return this}forEachAtTime(l,p){if(null!==this._root){let d=[];this._root.search(l,d),d.forEach(l=>{l.event&&p(l.event)})}return this}forEachFrom(l,p){if(null!==this._root){let d=[];this._root.searchAfter(l,d),d.forEach(l=>{l.event&&p(l.event)})}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse(l=>l.dispose()),this._root=null,this}};let Do=class Do{constructor(l,p,d){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=d,this.low=l,this.high=p,this.max=this.high}insert(l){l.low<=this.low?null===this.left?this.left=l:this.left.insert(l):null===this.right?this.right=l:this.right.insert(l)}search(l,p){l>this.max||(null!==this.left&&this.left.search(l,p),this.low<=l&&this.high>l&&p.push(this),this.low>l||null!==this.right&&this.right.search(l,p))}searchAfter(l,p){this.low>=l&&(p.push(this),null!==this.left&&this.left.searchAfter(l,p)),null!==this.right&&this.right.searchAfter(l,p)}traverse(l){l(this),null!==this.left&&this.left.traverse(l),null!==this.right&&this.right.traverse(l)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let l=0;return null!==this.left&&null!==this.right?l=this.left.height-this.right.height:null!==this.left?l=this.left.height+1:null!==this.right&&(l=-(this.right.height+1)),l}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(l){this._left=l,null!==l&&(l.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(l){this._right=l,null!==l&&(l.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}};let Oo=class Oo extends io{constructor(){super(ui(Oo.getDefaults(),arguments,["volume"])),this.name="Volume";let l=ui(Oo.getDefaults(),arguments,["volume"]);this.input=this.output=new ho({context:this.context,gain:l.volume,units:"decibels"}),this.volume=this.output.gain,Oi(this,"volume"),this._unmutedVolume=l.volume,this.mute=l.mute}static getDefaults(){return Object.assign(io.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(l){!this.mute&&l?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!l&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}};let Mo=class Mo extends io{constructor(){super(ui(Mo.getDefaults(),arguments)),this.name="Destination",this.input=new Oo({context:this.context}),this.output=new ho({context:this.context}),this.volume=this.input.volume;let l=ui(Mo.getDefaults(),arguments);oo(this.input,this.output,this.context.rawContext.destination),this.mute=l.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(io.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(l){this.input.mute=l}chain(...l){return this.input.disconnect(),l.unshift(this.input),l.push(this.output),oo(...l),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}};Ti(l=>{l.destination=new Mo({context:l})}),ki(l=>{l.destination.dispose()});let Eo=class Eo extends fi{constructor(l){super(),this.name="TimelineValue",this._timeline=new wi({memory:10}),this._initialValue=l}set(l,p){return this._timeline.add({value:l,time:p}),this}get(l){let p=this._timeline.get(l);return p?p.value:this._initialValue}};let Ro=class Ro extends io{constructor(){super(Object.assign(ui(Ro.getDefaults(),arguments,["context"])))}connect(l,p=0,d=0){return fo(this,l,p,d),this}};let qo=class qo extends Ro{constructor(){super(Object.assign(ui(qo.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;let l=ui(qo.getDefaults(),arguments,["mapping","length"]);Ln(l.mapping)||l.mapping instanceof Float32Array?this.curve=Float32Array.from(l.mapping):Vn(l.mapping)&&this.setMap(l.mapping,l.length)}static getDefaults(){return Object.assign(po.getDefaults(),{length:1024})}setMap(l,p=1024){let d=new Float32Array(p);for(let f=0;f<p;f++){let _=f/(p-1)*2-1;d[f]=l(_,f)}return this.curve=d,this}get curve(){return this._shaper.curve}set curve(l){this._shaper.curve=l}get oversample(){return this._shaper.oversample}set oversample(l){Bn(["none","2x","4x"].some(p=>p.includes(l)),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=l}dispose(){return super.dispose(),this._shaper.disconnect(),this}};let Fo=class Fo extends Ro{constructor(){super(Object.assign(ui(Fo.getDefaults(),arguments,["value"]))),this.name="Pow";let l=ui(Fo.getDefaults(),arguments,["value"]);this._exponentScaler=this.input=this.output=new qo({context:this.context,mapping:this._expFunc(l.value),length:8192}),this._exponent=l.value}static getDefaults(){return Object.assign(Ro.getDefaults(),{value:1})}_expFunc(l){return p=>Math.pow(Math.abs(p),l)}get value(){return this._exponent}set value(l){this._exponent=l,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}};let Io=class Io{constructor(l,p){this.id=Io._eventId++,this._remainderTime=0;let d=Object.assign(Io.getDefaults(),p);this.transport=l,this.callback=d.callback,this._once=d.once,this.time=Math.floor(d.time),this._remainderTime=d.time-this.time}static getDefaults(){return{callback:Ei,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(l){if(this.callback){let p=this.transport.bpm.getDurationOfTicks(1,l);this.callback(l+this._remainderTime*p),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}};Io._eventId=0;let Vo=class Vo extends Io{constructor(l,p){super(l,p),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);let d=Object.assign(Vo.getDefaults(),p);this.duration=d.duration,this._interval=d.interval,this._nextTick=d.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},Io.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(l){this._createEvents(l),super.invoke(l)}_createEvent(){return vi(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new So(this.context,this._nextTick).toSeconds()):-1}_createEvents(l){vi(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new So(this.context,this._nextTick).toSeconds()))}_restart(l){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;let p=this.transport.getTicksAtTime(l);mi(p,this.time)&&(this._nextTick=this.floatTime+Math.ceil((p-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}};let No=class No extends eo{constructor(){super(ui(No.getDefaults(),arguments)),this.name="Transport",this._loop=new Eo(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new wi,this._repeatedEvents=new Co,this._syncedSignals=[],this._swingAmount=0;let l=ui(No.getDefaults(),arguments);this._ppq=l.ppq,this._clock=new vo({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=l.ppq,this.bpm.setValueAtTime(l.bpm,0),Oi(this,"bpm"),this._timeSignature=l.timeSignature,this._swingTicks=l.ppq/2}static getDefaults(){return Object.assign(eo.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(l,p){if(this._loop.get(l)&&p>=this._loopEnd&&(this.emit("loopEnd",l),this._clock.setTicksAtTime(this._loopStart,l),p=this._loopStart,this.emit("loopStart",l,this._clock.getSecondsAtTime(l)),this.emit("loop",l)),this._swingAmount>0&&p%this._ppq!=0&&p%(2*this._swingTicks)!=0){let d=p%(2*this._swingTicks)/(2*this._swingTicks),f=Math.sin(d*Math.PI)*this._swingAmount;l+=new So(this.context,2*this._swingTicks/3).toSeconds()*f}il=!0,this._timeline.forEachAtTime(p,p=>p.invoke(l)),il=!1}schedule(l,p){let d=new Io(this,{callback:l,time:new Ki(this.context,p).toTicks()});return this._addEvent(d,this._timeline)}scheduleRepeat(l,p,d,f=1/0){let _=new Vo(this,{callback:l,duration:new Zi(this.context,f).toTicks(),interval:new Zi(this.context,p).toTicks(),time:new Ki(this.context,d).toTicks()});return this._addEvent(_,this._repeatedEvents)}scheduleOnce(l,p){let d=new Io(this,{callback:l,once:!0,time:new Ki(this.context,p).toTicks()});return this._addEvent(d,this._timeline)}clear(l){if(this._scheduledEvents.hasOwnProperty(l)){let p=this._scheduledEvents[l.toString()];p.timeline.remove(p.event),p.event.dispose(),delete this._scheduledEvents[l.toString()]}return this}_addEvent(l,p){return this._scheduledEvents[l.id.toString()]={event:l,timeline:p},p.add(l),l.id}cancel(l=0){let p=this.toTicks(l);return this._timeline.forEachFrom(p,l=>this.clear(l.id)),this._repeatedEvents.forEachFrom(p,l=>this.clear(l.id)),this}_bindClockEvents(){this._clock.on("start",(l,p)=>{p=new So(this.context,p).toSeconds(),this.emit("start",l,p)}),this._clock.on("stop",l=>{this.emit("stop",l)}),this._clock.on("pause",l=>{this.emit("pause",l)})}get state(){return this._clock.getStateAtTime(this.now())}start(l,p){let d;return this.context.resume(),In(p)&&(d=this.toTicks(p)),this._clock.start(l,d),this}stop(l){return this._clock.stop(l),this}pause(l){return this._clock.pause(l),this}toggle(l){return l=this.toSeconds(l),"started"!==this._clock.getStateAtTime(l)?this.start(l):this.stop(l),this}get timeSignature(){return this._timeSignature}set timeSignature(l){Ln(l)&&(l=l[0]/l[1]*4),this._timeSignature=l}get loopStart(){return new Zi(this.context,this._loopStart,"i").toSeconds()}set loopStart(l){this._loopStart=this.toTicks(l)}get loopEnd(){return new Zi(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(l){this._loopEnd=this.toTicks(l)}get loop(){return this._loop.get(this.now())}set loop(l){this._loop.set(l,this.now())}setLoopPoints(l,p){return this.loopStart=l,this.loopEnd=p,this}get swing(){return this._swingAmount}set swing(l){this._swingAmount=l}get swingSubdivision(){return new So(this.context,this._swingTicks).toNotation()}set swingSubdivision(l){this._swingTicks=this.toTicks(l)}get position(){let l=this.now(),p=this._clock.getTicksAtTime(l);return new So(this.context,p).toBarsBeatsSixteenths()}set position(l){let p=this.toTicks(l);this.ticks=p}get seconds(){return this._clock.seconds}set seconds(l){let p=this.now(),d=this._clock.frequency.timeToTicks(l,p);this.ticks=d}get progress(){if(this.loop){let l=this.now();return(this._clock.getTicksAtTime(l)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(l){if(this._clock.ticks!==l){let p=this.now();if("started"===this.state){let d=this._clock.getTicksAtTime(p),f=p+this._clock.frequency.getDurationOfTicks(Math.ceil(d)-d,p);this.emit("stop",f),this._clock.setTicksAtTime(l,f),this.emit("start",f,this._clock.getSecondsAtTime(f))}else this.emit("ticks",p),this._clock.setTicksAtTime(l,p)}}getTicksAtTime(l){return this._clock.getTicksAtTime(l)}getSecondsAtTime(l){return this._clock.getSecondsAtTime(l)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(l){this._clock.frequency.multiplier=l}nextSubdivision(l){if(l=this.toTicks(l),"started"!==this.state)return 0;{let p=this.now(),d=l-this.getTicksAtTime(p)%l;return this._clock.nextTickTime(d,p)}}syncSignal(l,p){let d=this.now(),f=this.bpm,_=1/(60/f.getValueAtTime(d)/this.PPQ),m=[];if("time"===l.units){let l=1/64/_,p=new ho(l),d=new Fo(-1),O=new ho(l);f.chain(p,d,O),f=O,_=1/_,m=[p,d,O]}p||(p=0!==l.getValueAtTime(d)?l.getValueAtTime(d)/_:0);let O=new ho(p);return f.connect(O),O.connect(l._param),m.push(O),this._syncedSignals.push({initial:l.value,nodes:m,signal:l}),l.value=0,this}unsyncSignal(l){for(let p=this._syncedSignals.length-1;p>=0;p--){let d=this._syncedSignals[p];d.signal===l&&(d.nodes.forEach(l=>l.dispose()),d.signal.value=d.initial,this._syncedSignals.splice(p,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),Mi(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}};Ai.mixin(No),Ti(l=>{l.transport=new No({context:l})}),ki(l=>{l.transport.dispose()});let Po=class Po extends io{constructor(l){super(l),this.input=void 0,this._state=new so("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=Ei,this._syncedStop=Ei,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Oo({context:this.context,mute:l.mute,volume:l.volume}),this.volume=this._volume.volume,Oi(this,"volume"),this.onstop=l.onstop}static getDefaults(){return Object.assign(io.getDefaults(),{mute:!1,onstop:Ei,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(l){this._volume.mute=l}_clampToCurrentTime(l){return this._synced?l:Math.max(l,this.context.currentTime)}start(l,p,d){let f=Fn(l)&&this._synced?this.context.transport.seconds:this.toSeconds(l);if(f=this._clampToCurrentTime(f),this._synced||"started"!==this._state.getValueAtTime(f)){if(this.log("start",f),this._state.setStateAtTime("started",f),this._synced){let l=this._state.get(f);l&&(l.offset=this.toSeconds(pi(p,0)),l.duration=d?this.toSeconds(d):void 0);let _=this.context.transport.schedule(l=>{this._start(l,p,d)},f);this._scheduled.push(_),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>f&&this._syncedStart(this.now(),this.context.transport.seconds)}else Gn(this.context),this._start(f,p,d)}else Bn(mi(f,this._state.get(f).time),"Start time must be strictly greater than previous start time"),this._state.cancel(f),this._state.setStateAtTime("started",f),this.log("restart",f),this.restart(f,p,d);return this}stop(l){let p=Fn(l)&&this._synced?this.context.transport.seconds:this.toSeconds(l);if(p=this._clampToCurrentTime(p),"started"===this._state.getValueAtTime(p)||In(this._state.getNextState("started",p))){if(this.log("stop",p),this._synced){let l=this.context.transport.schedule(this._stop.bind(this),p);this._scheduled.push(l)}else this._stop(p);this._state.cancel(p),this._state.setStateAtTime("stopped",p)}return this}restart(l,p,d){return l=this.toSeconds(l),"started"===this._state.getValueAtTime(l)&&(this._state.cancel(l),this._restart(l,p,d)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(l,p)=>{if(mi(p,0)){let d=this._state.get(p);if(d&&"started"===d.state&&d.time!==p){let f;let _=p-this.toSeconds(d.time);d.duration&&(f=this.toSeconds(d.duration)-_),this._start(l,this.toSeconds(d.offset)+_,f)}}},this._syncedStop=l=>{let p=this.context.transport.getSecondsAtTime(Math.max(l-this.sampleTime,0));"started"===this._state.getValueAtTime(p)&&this._stop(l)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(l=>this.context.transport.clear(l)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Ei,this.unsync(),this._volume.dispose(),this._state.dispose(),this}};let jo=class jo extends lo{constructor(){super(ui(jo.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;let l=ui(jo.getDefaults(),arguments,["url","onload"]);ro(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new no({context:this.context,param:this._source.playbackRate,units:"positive",value:l.playbackRate}),this.loop=l.loop,this.loopStart=l.loopStart,this.loopEnd=l.loopEnd,this._buffer=new Ri(l.url,l.onload,l.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(lo.getDefaults(),{url:new Ri,loop:!1,loopEnd:0,loopStart:0,onload:Ei,onerror:Ei,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(l){this._fadeIn=l}get fadeOut(){return this._fadeOut}set fadeOut(l){this._fadeOut=l}get curve(){return this._curve}set curve(l){this._curve=l}start(l,p,d,f=1){Bn(this.buffer.loaded,"buffer is either not set or not loaded");let _=this.toSeconds(l);this._startGain(_,f),p=this.loop?pi(p,this.loopStart):pi(p,0);let m=Math.max(this.toSeconds(p),0);if(this.loop){let l=this.toSeconds(this.loopEnd)||this.buffer.duration,p=this.toSeconds(this.loopStart),d=l-p;gi(m,l)&&(m=(m-p)%d+p),yi(m,this.buffer.duration)&&(m=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,vi(m,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(_,m)),In(d)){let l=this.toSeconds(d);l=Math.max(l,0),this.stop(_+l)}return this}_stopSource(l){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(l)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(l){this._source.loopStart=this.toSeconds(l)}get loopEnd(){return this._source.loopEnd}set loopEnd(l){this._source.loopEnd=this.toSeconds(l)}get buffer(){return this._buffer}set buffer(l){this._buffer.set(l)}get loop(){return this._source.loop}set loop(l){this._source.loop=l,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}};let Lo=class Lo extends Po{constructor(){super(ui(Lo.getDefaults(),arguments,["type"])),this.name="Noise",this._source=null;let l=ui(Lo.getDefaults(),arguments,["type"]);this._playbackRate=l.playbackRate,this.type=l.type,this._fadeIn=l.fadeIn,this._fadeOut=l.fadeOut}static getDefaults(){return Object.assign(Po.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(l){if(Bn(l in iT,"Noise: invalid type: "+l),this._type!==l&&(this._type=l,"started"===this.state)){let l=this.now();this._stop(l),this._start(l)}}get playbackRate(){return this._playbackRate}set playbackRate(l){this._playbackRate=l,this._source&&(this._source.playbackRate.value=l)}_start(l){let p=iT[this._type];this._source=new jo({url:p,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(l),Math.random()*(p.duration-.001))}_stop(l){this._source&&(this._source.stop(this.toSeconds(l)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(l){this._fadeIn=l,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(l){this._fadeOut=l,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(l){this._stop(l),this._start(l)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}};let iw={brown:null,pink:null,white:null},iT={get brown(){if(!iw.brown){let l=[];for(let p=0;p<2;p++){let d=new Float32Array(220500);l[p]=d;let f=0;for(let l=0;l<220500;l++){let p=2*Math.random()-1;d[l]=(f+.02*p)/1.02,f=d[l],d[l]*=3.5}}iw.brown=(new Ri).fromArray(l)}return iw.brown},get pink(){if(!iw.pink){let l=[];for(let p=0;p<2;p++){let d,f,_,m,O,I,V;let F=new Float32Array(220500);l[p]=F,d=f=_=m=O=I=V=0;for(let l=0;l<220500;l++){let p=2*Math.random()-1;d=.99886*d+.0555179*p,f=.99332*f+.0750759*p,_=.969*_+.153852*p,m=.8665*m+.3104856*p,O=.55*O+.5329522*p,I=-.7616*I-.016898*p,F[l]=d+f+_+m+O+I+V+.5362*p,F[l]*=.11,V=.115926*p}}iw.pink=(new Ri).fromArray(l)}return iw.pink},get white(){if(!iw.white){let l=[];for(let p=0;p<2;p++){let d=new Float32Array(220500);l[p]=d;for(let l=0;l<220500;l++)d[l]=2*Math.random()-1}iw.white=(new Ri).fromArray(l)}return iw.white}};let Uo=class Uo extends io{constructor(){super(ui(Uo.getDefaults(),arguments,["volume"])),this.name="UserMedia";let l=ui(Uo.getDefaults(),arguments,["volume"]);this._volume=this.output=new Oo({context:this.context,volume:l.volume}),this.volume=this._volume.volume,Oi(this,"volume"),this.mute=l.mute}static getDefaults(){return Object.assign(io.getDefaults(),{mute:!1,volume:0})}open(l){return ni(this,void 0,void 0,function*(){Bn(Uo.supported,"UserMedia is not supported"),"started"===this.state&&this.close();let p=yield Uo.enumerateDevices();Nn(l)?this._device=p[l]:(this._device=p.find(p=>p.label===l||p.deviceId===l),!this._device&&p.length>0&&(this._device=p[0]),Bn(In(this._device),`No matching device ${l}`));let d={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}};this._device&&(d.audio.deviceId=this._device.deviceId);let f=yield navigator.mediaDevices.getUserMedia(d);if(!this._stream){this._stream=f;let l=this.context.createMediaStreamSource(f);ro(l,this.output),this._mediaStream=l}return this})}close(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach(l=>{l.stop()}),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}static enumerateDevices(){return ni(this,void 0,void 0,function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter(l=>"audioinput"===l.kind)})}get state(){return this._stream&&this._stream.active?"started":"stopped"}get deviceId(){return this._device?this._device.deviceId:void 0}get groupId(){return this._device?this._device.groupId:void 0}get label(){return this._device?this._device.label:void 0}get mute(){return this._volume.mute}set mute(l){this._volume.mute=l}dispose(){return super.dispose(),this.close(),this._volume.dispose(),this.volume.dispose(),this}static get supported(){return In(navigator.mediaDevices)&&In(navigator.mediaDevices.getUserMedia)}};function Go(l,p){return ni(this,void 0,void 0,function*(){let d=p/l.context.sampleRate,f=new qi(1,d,l.context.sampleRate);return new l.constructor(Object.assign(l.get(),{frequency:2/d,detune:0,context:f})).toDestination().start(0),(yield f.render()).getChannelData(0)})}let Qo=class Qo extends lo{constructor(){super(ui(Qo.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];let l=ui(Qo.getDefaults(),arguments,["frequency","type"]);ro(this._oscillator,this._gainNode),this.type=l.type,this.frequency=new no({context:this.context,param:this._oscillator.frequency,units:"frequency",value:l.frequency}),this.detune=new no({context:this.context,param:this._oscillator.detune,units:"cents",value:l.detune}),Oi(this,["frequency","detune"])}static getDefaults(){return Object.assign(lo.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(l){let p=this.toSeconds(l);return this.log("start",p),this._startGain(p),this._oscillator.start(p),this}_stopSource(l){this._oscillator.stop(l)}setPeriodicWave(l){return this._oscillator.setPeriodicWave(l),this}get type(){return this._oscillator.type}set type(l){this._oscillator.type=l}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}};let Zo=class Zo extends Po{constructor(){super(ui(Zo.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;let l=ui(Zo.getDefaults(),arguments,["frequency","type"]);this.frequency=new po({context:this.context,units:"frequency",value:l.frequency}),Oi(this,"frequency"),this.detune=new po({context:this.context,units:"cents",value:l.detune}),Oi(this,"detune"),this._partials=l.partials,this._partialCount=l.partialCount,this._type=l.type,l.partialCount&&"custom"!==l.type&&(this._type=this.baseType+l.partialCount.toString()),this.phase=l.phase}static getDefaults(){return Object.assign(Po.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(l){let p=this.toSeconds(l),d=new Qo({context:this.context,onended:()=>this.onstop(this)});this._oscillator=d,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(p)}_stop(l){let p=this.toSeconds(l);this._oscillator&&this._oscillator.stop(p)}_restart(l){let p=this.toSeconds(l);return this.log("restart",p),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(p),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type)return Zo._periodicWaveCache.find(l=>{var p,d;return l.phase===this._phase&&(p=l.partials,d=this._partials,p.length===d.length&&p.every((l,p)=>d[p]===l))});{let l=Zo._periodicWaveCache.find(l=>l.type===this._type&&l.phase===this._phase);return this._partialCount=l?l.partialCount:this._partialCount,l}}get type(){return this._type}set type(l){this._type=l;let p=-1!==["sine","square","sawtooth","triangle"].indexOf(l);if(0===this._phase&&p)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=l);else{let p=this._getCachedPeriodicWave();if(In(p)){let{partials:l,wave:d}=p;this._wave=d,this._partials=l,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{let[p,d]=this._getRealImaginary(l,this._phase),f=this.context.createPeriodicWave(p,d);this._wave=f,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),Zo._periodicWaveCache.push({imag:d,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:p,type:this._type,wave:this._wave}),Zo._periodicWaveCache.length>100&&Zo._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(l){this.partialCount&&"custom"!==this._type&&"custom"!==l?this.type=l+this.partialCount:this.type=l}get partialCount(){return this._partialCount}set partialCount(l){Un(l,0);let p=this._type,d=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(d&&(p=d[1]),"custom"!==this._type)this.type=0===l?p:p+l.toString();else{let p=new Float32Array(l);this._partials.forEach((l,d)=>p[d]=l),this._partials=Array.from(p),this.type=this._type}}_getRealImaginary(l,p){let d=2048,f=new Float32Array(d),_=new Float32Array(d),m=1;if("custom"===l){if(m=this._partials.length+1,this._partialCount=this._partials.length,d=m,0===this._partials.length)return[f,_]}else{let p=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(l);p?(m=parseInt(p[2],10)+1,this._partialCount=parseInt(p[2],10),l=p[1],d=m=Math.max(m,2)):this._partialCount=0,this._partials=[]}for(let O=1;O<d;++O){let d;let I=2/(O*Math.PI);switch(l){case"sine":d=O<=m?1:0,this._partials[O-1]=d;break;case"square":d=1&O?2*I:0,this._partials[O-1]=d;break;case"sawtooth":d=I*(1&O?1:-1),this._partials[O-1]=d;break;case"triangle":d=1&O?I*I*2*(O-1>>1&1?-1:1):0,this._partials[O-1]=d;break;case"custom":d=this._partials[O-1];break;default:throw TypeError("Oscillator: invalid type: "+l)}0!==d?(f[O]=-d*Math.sin(p*O),_[O]=d*Math.cos(p*O)):(f[O]=0,_[O]=0)}return[f,_]}_inverseFFT(l,p,d){let f=0,_=l.length;for(let m=0;m<_;m++)f+=l[m]*Math.cos(m*d)+p[m]*Math.sin(m*d);return f}getInitialValue(){let[l,p]=this._getRealImaginary(this._type,0),d=0,f=2*Math.PI;for(let _=0;_<32;_++)d=Math.max(this._inverseFFT(l,p,_/32*f),d);return xi(-this._inverseFFT(l,p,this._phase)/d,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(l){this._partials=l,this._partialCount=this._partials.length,l.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(l){this._phase=l*Math.PI/180,this.type=this._type}asArray(l=1024){return ni(this,void 0,void 0,function*(){return Go(this,l)})}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}};Zo._periodicWaveCache=[];let Xo=class Xo extends Ro{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new qo({context:this.context,mapping:l=>(l+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}};let Yo=class Yo extends po{constructor(){super(Object.assign(ui(Yo.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;let l=ui(Yo.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new ho({context:this.context,minValue:l.minValue,maxValue:l.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(l.value,0)}static getDefaults(){return Object.assign(po.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}};let $o=class $o extends Po{constructor(){super(ui($o.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new Xo({context:this.context}),this._modulationNode=new ho({context:this.context});let l=ui($o.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Zo({context:this.context,detune:l.detune,frequency:l.frequency,onstop:()=>this.onstop(this),phase:l.phase,type:l.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new Zo({context:this.context,phase:l.phase,type:l.modulationType}),this.harmonicity=new Yo({context:this.context,units:"positive",value:l.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),Oi(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Zo.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(l){this._modulator.start(l),this._carrier.start(l)}_stop(l){this._modulator.stop(l),this._carrier.stop(l)}_restart(l){this._modulator.restart(l),this._carrier.restart(l)}get type(){return this._carrier.type}set type(l){this._carrier.type=l}get baseType(){return this._carrier.baseType}set baseType(l){this._carrier.baseType=l}get partialCount(){return this._carrier.partialCount}set partialCount(l){this._carrier.partialCount=l}get modulationType(){return this._modulator.type}set modulationType(l){this._modulator.type=l}get phase(){return this._carrier.phase}set phase(l){this._carrier.phase=l,this._modulator.phase=l}get partials(){return this._carrier.partials}set partials(l){this._carrier.partials=l}asArray(l=1024){return ni(this,void 0,void 0,function*(){return Go(this,l)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}};let Ho=class Ho extends Po{constructor(){super(ui(Ho.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new ho({context:this.context,gain:0});let l=ui(Ho.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Zo({context:this.context,detune:l.detune,frequency:0,onstop:()=>this.onstop(this),phase:l.phase,type:l.type}),this.detune=this._carrier.detune,this.frequency=new po({context:this.context,units:"frequency",value:l.frequency}),this._modulator=new Zo({context:this.context,phase:l.phase,type:l.modulationType}),this.harmonicity=new Yo({context:this.context,units:"positive",value:l.harmonicity}),this.modulationIndex=new Yo({context:this.context,units:"positive",value:l.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),Oi(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Zo.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(l){this._modulator.start(l),this._carrier.start(l)}_stop(l){this._modulator.stop(l),this._carrier.stop(l)}_restart(l){return this._modulator.restart(l),this._carrier.restart(l),this}get type(){return this._carrier.type}set type(l){this._carrier.type=l}get baseType(){return this._carrier.baseType}set baseType(l){this._carrier.baseType=l}get partialCount(){return this._carrier.partialCount}set partialCount(l){this._carrier.partialCount=l}get modulationType(){return this._modulator.type}set modulationType(l){this._modulator.type=l}get phase(){return this._carrier.phase}set phase(l){this._carrier.phase=l,this._modulator.phase=l}get partials(){return this._carrier.partials}set partials(l){this._carrier.partials=l}asArray(l=1024){return ni(this,void 0,void 0,function*(){return Go(this,l)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}};let Jo=class Jo extends Po{constructor(){super(ui(Jo.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new ho({context:this.context,gain:0}),this._thresh=new qo({context:this.context,mapping:l=>l<=0?-1:1});let l=ui(Jo.getDefaults(),arguments,["frequency","width"]);this.width=new po({context:this.context,units:"audioRange",value:l.width}),this._triangle=new Zo({context:this.context,detune:l.detune,frequency:l.frequency,onstop:()=>this.onstop(this),phase:l.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),Oi(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Po.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(l){l=this.toSeconds(l),this._triangle.start(l),this._widthGate.gain.setValueAtTime(1,l)}_stop(l){l=this.toSeconds(l),this._triangle.stop(l),this._widthGate.gain.cancelScheduledValues(l),this._widthGate.gain.setValueAtTime(0,l)}_restart(l){this._triangle.restart(l),this._widthGate.gain.cancelScheduledValues(l),this._widthGate.gain.setValueAtTime(1,l)}get phase(){return this._triangle.phase}set phase(l){this._triangle.phase=l}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(l){this._triangle.type=l}asArray(l=1024){return ni(this,void 0,void 0,function*(){return Go(this,l)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}};let Ko=class Ko extends Po{constructor(){super(ui(Ko.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];let l=ui(Ko.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new po({context:this.context,units:"frequency",value:l.frequency}),this.detune=new po({context:this.context,units:"cents",value:l.detune}),this._spread=l.spread,this._type=l.type,this._phase=l.phase,this._partials=l.partials,this._partialCount=l.partialCount,this.count=l.count,Oi(this,["frequency","detune"])}static getDefaults(){return Object.assign(Zo.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(l){l=this.toSeconds(l),this._forEach(p=>p.start(l))}_stop(l){l=this.toSeconds(l),this._forEach(p=>p.stop(l))}_restart(l){this._forEach(p=>p.restart(l))}_forEach(l){for(let p=0;p<this._oscillators.length;p++)l(this._oscillators[p],p)}get type(){return this._type}set type(l){this._type=l,this._forEach(p=>p.type=l)}get spread(){return this._spread}set spread(l){if(this._spread=l,this._oscillators.length>1){let p=-l/2,d=l/(this._oscillators.length-1);this._forEach((l,f)=>l.detune.value=p+d*f)}}get count(){return this._oscillators.length}set count(l){if(Un(l,1),this._oscillators.length!==l){this._forEach(l=>l.dispose()),this._oscillators=[];for(let p=0;p<l;p++){let d=new Zo({context:this.context,volume:-6-1.1*l,type:this._type,phase:this._phase+p/l*360,partialCount:this._partialCount,onstop:0===p?()=>this.onstop(this):Ei});"custom"===this.type&&(d.partials=this._partials),this.frequency.connect(d.frequency),this.detune.connect(d.detune),d.detune.overridden=!1,d.connect(this.output),this._oscillators[p]=d}this.spread=this._spread,"started"===this.state&&this._forEach(l=>l.start())}}get phase(){return this._phase}set phase(l){this._phase=l,this._forEach((l,p)=>l.phase=this._phase+p/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(l){this._forEach(p=>p.baseType=l),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(l){this._partials=l,this._partialCount=this._partials.length,l.length&&(this._type="custom",this._forEach(p=>p.partials=l))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(l){this._partialCount=l,this._forEach(p=>p.partialCount=l),this._type=this._oscillators[0].type}asArray(l=1024){return ni(this,void 0,void 0,function*(){return Go(this,l)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(l=>l.dispose()),this}};let tr=class tr extends Po{constructor(){super(ui(tr.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Yo({context:this.context,value:2});let l=ui(tr.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new Jo({context:this.context,frequency:l.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new Zo({context:this.context,detune:l.detune,frequency:l.frequency,onstop:()=>this.onstop(this),phase:l.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),Oi(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Po.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(l){l=this.toSeconds(l),this._modulator.start(l),this._pulse.start(l)}_stop(l){l=this.toSeconds(l),this._modulator.stop(l),this._pulse.stop(l)}_restart(l){this._modulator.restart(l),this._pulse.restart(l)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(l){this._modulator.phase=l}asArray(l=1024){return ni(this,void 0,void 0,function*(){return Go(this,l)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}};let iS={am:$o,fat:Ko,fm:Ho,oscillator:Zo,pulse:Jo,pwm:tr};let sr=class sr extends Po{constructor(){super(ui(sr.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";let l=ui(sr.getDefaults(),arguments,["frequency","type"]);this.frequency=new po({context:this.context,units:"frequency",value:l.frequency}),this.detune=new po({context:this.context,units:"cents",value:l.detune}),Oi(this,["frequency","detune"]),this.set(l)}static getDefaults(){return Object.assign(Zo.getDefaults(),Ho.getDefaults(),$o.getDefaults(),Ko.getDefaults(),Jo.getDefaults(),tr.getDefaults())}_start(l){this._oscillator.start(l)}_stop(l){this._oscillator.stop(l)}_restart(l){return this._oscillator.restart(l),this}get type(){let l="";return["am","fm","fat"].some(l=>this._sourceType===l)&&(l=this._sourceType),l+this._oscillator.type}set type(l){"fm"===l.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=l.substr(2)):"am"===l.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=l.substr(2)):"fat"===l.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=l.substr(3)):"pwm"===l?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===l?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=l)}get partials(){return this._oscillator.partials}set partials(l){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=l)}get partialCount(){return this._oscillator.partialCount}set partialCount(l){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=l)}set(l){return Reflect.has(l,"type")&&l.type&&(this.type=l.type),super.set(l),this}_createNewOscillator(l){if(l!==this._sourceType){this._sourceType=l;let p=iS[l],d=this.now();if(this._oscillator){let l=this._oscillator;l.stop(d),this.context.setTimeout(()=>l.dispose(),this.blockTime)}this._oscillator=new p({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(d)}}get phase(){return this._oscillator.phase}set phase(l){this._oscillator.phase=l}get sourceType(){return this._sourceType}set sourceType(l){let p="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(p=this._oscillator.type),"fm"===l?this.type="fm"+p:"am"===l?this.type="am"+p:"fat"===l?this.type="fat"+p:"oscillator"===l?this.type=p:"pulse"===l?this.type="pulse":"pwm"===l&&(this.type="pwm")}_getOscType(l,p){return l instanceof iS[p]}get baseType(){return this._oscillator.baseType}set baseType(l){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===l||"pwm"===l||(this._oscillator.baseType=l)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(l){this._getOscType(this._oscillator,"fat")&&Nn(l)&&(this._oscillator.count=l)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(l){this._getOscType(this._oscillator,"fat")&&Nn(l)&&(this._oscillator.spread=l)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(l){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&zn(l)&&(this._oscillator.modulationType=l)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(l=1024){return ni(this,void 0,void 0,function*(){return Go(this,l)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}};let nr=class nr extends po{constructor(){super(Object.assign(ui(nr.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Add",this._sum=new ho({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,oo(this._constantSource,this._sum)}static getDefaults(){return Object.assign(po.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}};let ir=class ir extends Ro{constructor(){super(Object.assign(ui(ir.getDefaults(),arguments,["min","max"]))),this.name="Scale";let l=ui(ir.getDefaults(),arguments,["min","max"]);this._mult=this.input=new Yo({context:this.context,value:l.max-l.min}),this._add=this.output=new nr({context:this.context,value:l.min}),this._min=l.min,this._max=l.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(Ro.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(l){this._min=l,this._setRange()}get max(){return this._max}set max(l){this._max=l,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}};let or=class or extends Ro{constructor(){super(Object.assign(ui(or.getDefaults(),arguments))),this.name="Zero",this._gain=new ho({context:this.context}),this.output=this._gain,this.input=void 0,ro(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),ao(this.context.getConstant(0),this._gain),this}};let rr=class rr extends io{constructor(){super(ui(rr.getDefaults(),arguments,["frequency","min","max"])),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=no.prototype._fromType,this._toType=no.prototype._toType,this._is=no.prototype._is,this._clampValue=no.prototype._clampValue;let l=ui(rr.getDefaults(),arguments,["frequency","min","max"]);this._oscillator=new Zo(l),this.frequency=this._oscillator.frequency,this._amplitudeGain=new ho({context:this.context,gain:l.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new po({context:this.context,units:"audioRange",value:0}),this._zeros=new or({context:this.context}),this._a2g=new Xo({context:this.context}),this._scaler=this.output=new ir({context:this.context,max:l.max,min:l.min}),this.units=l.units,this.min=l.min,this.max=l.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),Oi(this,["amplitude","frequency"]),this.phase=l.phase}static getDefaults(){return Object.assign(Zo.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}start(l){return l=this.toSeconds(l),this._stoppedSignal.setValueAtTime(0,l),this._oscillator.start(l),this}stop(l){return l=this.toSeconds(l),this._stoppedSignal.setValueAtTime(this._stoppedValue,l),this._oscillator.stop(l),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}_setStoppedValue(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get min(){return this._toType(this._scaler.min)}set min(l){l=this._fromType(l),this._scaler.min=l}get max(){return this._toType(this._scaler.max)}set max(l){l=this._fromType(l),this._scaler.max=l}get type(){return this._oscillator.type}set type(l){this._oscillator.type=l,this._setStoppedValue()}get partials(){return this._oscillator.partials}set partials(l){this._oscillator.partials=l,this._setStoppedValue()}get phase(){return this._oscillator.phase}set phase(l){this._oscillator.phase=l,this._setStoppedValue()}get units(){return this._units}set units(l){let p=this.min,d=this.max;this._units=l,this.min=p,this.max=d}get state(){return this._oscillator.state}connect(l,p,d){return(l instanceof no||l instanceof po)&&(this.convert=l.convert,this.units=l.units),fo(this,l,p,d),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}};function ar(l,p=1/0){let d=new WeakMap;return function(f,_){Reflect.defineProperty(f,_,{configurable:!0,enumerable:!0,get:function(){return d.get(this)},set:function(f){Un(f,l,p),d.set(this,f)}})}}function cr(l,p=1/0){let d=new WeakMap;return function(f,_){Reflect.defineProperty(f,_,{configurable:!0,enumerable:!0,get:function(){return d.get(this)},set:function(f){Un(this.toSeconds(f),l,p),d.set(this,f)}})}}let hr=class hr extends Po{constructor(){super(ui(hr.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;let l=ui(hr.getDefaults(),arguments,["url","onload"]);this._buffer=new Ri({onload:this._onload.bind(this,l.onload),onerror:l.onerror,reverse:l.reverse,url:l.url}),this.autostart=l.autostart,this._loop=l.loop,this._loopStart=l.loopStart,this._loopEnd=l.loopEnd,this._playbackRate=l.playbackRate,this.fadeIn=l.fadeIn,this.fadeOut=l.fadeOut}static getDefaults(){return Object.assign(Po.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Ei,onerror:Ei,playbackRate:1,reverse:!1})}load(l){return ni(this,void 0,void 0,function*(){return yield this._buffer.load(l),this._onload(),this})}_onload(l=Ei){l(),this.autostart&&this.start()}_onSourceEnd(l){this.onstop(this),this._activeSources.delete(l),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(l,p,d){return super.start(l,p,d),this}_start(l,p,d){p=this._loop?pi(p,this._loopStart):pi(p,0);let f=this.toSeconds(p),_=d;d=pi(d,Math.max(this._buffer.duration-f,0));let m=this.toSeconds(d);m/=this._playbackRate,l=this.toSeconds(l);let O=new jo({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(l+m),this._state.setStateAtTime("stopped",l+m,{implicitEnd:!0})),this._activeSources.add(O),this._loop&&Fn(_)?O.start(l,f):O.start(l,f,m-this.toSeconds(this.fadeOut))}_stop(l){let p=this.toSeconds(l);this._activeSources.forEach(l=>l.stop(p))}restart(l,p,d){return super.restart(l,p,d),this}_restart(l,p,d){var f;null===(f=[...this._activeSources].pop())||void 0===f||f.stop(l),this._start(l,p,d)}seek(l,p){let d=this.toSeconds(p);if("started"===this._state.getValueAtTime(d)){let p=this.toSeconds(l);this._stop(d),this._start(d,p)}return this}setLoopPoints(l,p){return this.loopStart=l,this.loopEnd=p,this}get loopStart(){return this._loopStart}set loopStart(l){this._loopStart=l,this.buffer.loaded&&Un(this.toSeconds(l),0,this.buffer.duration),this._activeSources.forEach(p=>{p.loopStart=l})}get loopEnd(){return this._loopEnd}set loopEnd(l){this._loopEnd=l,this.buffer.loaded&&Un(this.toSeconds(l),0,this.buffer.duration),this._activeSources.forEach(p=>{p.loopEnd=l})}get buffer(){return this._buffer}set buffer(l){this._buffer.set(l)}get loop(){return this._loop}set loop(l){if(this._loop!==l&&(this._loop=l,this._activeSources.forEach(p=>{p.loop=l}),l)){let l=this._state.getNextState("stopped",this.now());l&&this._state.cancel(l.time)}}get playbackRate(){return this._playbackRate}set playbackRate(l){this._playbackRate=l;let p=this.now(),d=this._state.getNextState("stopped",p);d&&d.implicitEnd&&(this._state.cancel(d.time),this._activeSources.forEach(l=>l.cancelStop())),this._activeSources.forEach(d=>{d.playbackRate.setValueAtTime(l,p)})}get reverse(){return this._buffer.reverse}set reverse(l){this._buffer.reverse=l}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(l=>l.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}};si([cr(0)],hr.prototype,"fadeIn",void 0),si([cr(0)],hr.prototype,"fadeOut",void 0);let lr=class lr extends io{constructor(){super(ui(lr.getDefaults(),arguments,["urls","onload"],"urls")),this.name="Players",this.input=void 0,this._players=new Map;let l=ui(lr.getDefaults(),arguments,["urls","onload"],"urls");this._volume=this.output=new Oo({context:this.context,volume:l.volume}),this.volume=this._volume.volume,Oi(this,"volume"),this._buffers=new wo({urls:l.urls,onload:l.onload,baseUrl:l.baseUrl,onerror:l.onerror}),this.mute=l.mute,this._fadeIn=l.fadeIn,this._fadeOut=l.fadeOut}static getDefaults(){return Object.assign(Po.getDefaults(),{baseUrl:"",fadeIn:0,fadeOut:0,mute:!1,onload:Ei,onerror:Ei,urls:{},volume:0})}get mute(){return this._volume.mute}set mute(l){this._volume.mute=l}get fadeIn(){return this._fadeIn}set fadeIn(l){this._fadeIn=l,this._players.forEach(p=>{p.fadeIn=l})}get fadeOut(){return this._fadeOut}set fadeOut(l){this._fadeOut=l,this._players.forEach(p=>{p.fadeOut=l})}get state(){return Array.from(this._players).some(([l,p])=>"started"===p.state)?"started":"stopped"}has(l){return this._buffers.has(l)}player(l){if(Bn(this.has(l),`No Player with the name ${l} exists on this object`),!this._players.has(l)){let p=new hr({context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,url:this._buffers.get(l)}).connect(this.output);this._players.set(l,p)}return this._players.get(l)}get loaded(){return this._buffers.loaded}add(l,p,d){return Bn(!this._buffers.has(l),"A buffer with that name already exists on this object"),this._buffers.add(l,p,d),this}stopAll(l){return this._players.forEach(p=>p.stop(l)),this}dispose(){return super.dispose(),this._volume.dispose(),this.volume.dispose(),this._players.forEach(l=>l.dispose()),this._buffers.dispose(),this}};let ur=class ur extends Po{constructor(){super(ui(ur.getDefaults(),arguments,["url","onload"])),this.name="GrainPlayer",this._loopStart=0,this._loopEnd=0,this._activeSources=[];let l=ui(ur.getDefaults(),arguments,["url","onload"]);this.buffer=new Ri({onload:l.onload,onerror:l.onerror,reverse:l.reverse,url:l.url}),this._clock=new vo({context:this.context,callback:this._tick.bind(this),frequency:1/l.grainSize}),this._playbackRate=l.playbackRate,this._grainSize=l.grainSize,this._overlap=l.overlap,this.detune=l.detune,this.overlap=l.overlap,this.loop=l.loop,this.playbackRate=l.playbackRate,this.grainSize=l.grainSize,this.loopStart=l.loopStart,this.loopEnd=l.loopEnd,this.reverse=l.reverse,this._clock.on("stop",this._onstop.bind(this))}static getDefaults(){return Object.assign(Po.getDefaults(),{onload:Ei,onerror:Ei,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1})}_start(l,p,d){p=pi(p,0),p=this.toSeconds(p),l=this.toSeconds(l);let f=1/this._clock.frequency.getValueAtTime(l);this._clock.start(l,p/f),d&&this.stop(l+this.toSeconds(d))}restart(l,p,d){return super.restart(l,p,d),this}_restart(l,p,d){this._stop(l),this._start(l,p,d)}_stop(l){this._clock.stop(l)}_onstop(l){this._activeSources.forEach(p=>{p.fadeOut=0,p.stop(l)}),this.onstop(this)}_tick(l){let p=this._clock.getTicksAtTime(l),d=p*this._grainSize;if(this.log("offset",d),!this.loop&&d>this.buffer.duration)return void this.stop(l);let f=d<this._overlap?0:this._overlap,_=new jo({context:this.context,url:this.buffer,fadeIn:f,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:zi(this.detune/100)}).connect(this.output);_.start(l,this._grainSize*p),_.stop(l+this._grainSize/this.playbackRate),this._activeSources.push(_),_.onended=()=>{let l=this._activeSources.indexOf(_);-1!==l&&this._activeSources.splice(l,1)}}get playbackRate(){return this._playbackRate}set playbackRate(l){Un(l,.001),this._playbackRate=l,this.grainSize=this._grainSize}get loopStart(){return this._loopStart}set loopStart(l){this.buffer.loaded&&Un(this.toSeconds(l),0,this.buffer.duration),this._loopStart=this.toSeconds(l)}get loopEnd(){return this._loopEnd}set loopEnd(l){this.buffer.loaded&&Un(this.toSeconds(l),0,this.buffer.duration),this._loopEnd=this.toSeconds(l)}get reverse(){return this.buffer.reverse}set reverse(l){this.buffer.reverse=l}get grainSize(){return this._grainSize}set grainSize(l){this._grainSize=this.toSeconds(l),this._clock.frequency.setValueAtTime(this._playbackRate/this._grainSize,this.now())}get overlap(){return this._overlap}set overlap(l){let p=this.toSeconds(l);Un(p,0),this._overlap=p}get loaded(){return this.buffer.loaded}dispose(){return super.dispose(),this.buffer.dispose(),this._clock.dispose(),this._activeSources.forEach(l=>l.dispose()),this}};let pr=class pr extends Ro{constructor(){super(...arguments),this.name="Abs",this._abs=new qo({context:this.context,mapping:l=>.001>Math.abs(l)?0:Math.abs(l)}),this.input=this._abs,this.output=this._abs}dispose(){return super.dispose(),this._abs.dispose(),this}};let dr=class dr extends Ro{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new qo({context:this.context,mapping:l=>2*Math.abs(l)-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}};let fr=class fr extends Ro{constructor(){super(...arguments),this.name="Negate",this._multiply=new Yo({context:this.context,value:-1}),this.input=this._multiply,this.output=this._multiply}dispose(){return super.dispose(),this._multiply.dispose(),this}};let _r=class _r extends po{constructor(){super(Object.assign(ui(_r.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Subtract",this._sum=new ho({context:this.context}),this.input=this._sum,this.output=this._sum,this._neg=new fr({context:this.context}),this.subtrahend=this._param,oo(this._constantSource,this._neg,this._sum)}static getDefaults(){return Object.assign(po.getDefaults(),{value:0})}dispose(){return super.dispose(),this._neg.dispose(),this._sum.dispose(),this}};let mr=class mr extends Ro{constructor(){super(Object.assign(ui(mr.getDefaults(),arguments))),this.name="GreaterThanZero",this._thresh=this.output=new qo({context:this.context,length:127,mapping:l=>l<=0?0:1}),this._scale=this.input=new Yo({context:this.context,value:1e4}),this._scale.connect(this._thresh)}dispose(){return super.dispose(),this._scale.dispose(),this._thresh.dispose(),this}};let gr=class gr extends po{constructor(){super(Object.assign(ui(gr.getDefaults(),arguments,["value"]))),this.name="GreaterThan",this.override=!1;let l=ui(gr.getDefaults(),arguments,["value"]);this._subtract=this.input=new _r({context:this.context,value:l.value}),this._gtz=this.output=new mr({context:this.context}),this.comparator=this._param=this._subtract.subtrahend,Oi(this,"comparator"),this._subtract.connect(this._gtz)}static getDefaults(){return Object.assign(po.getDefaults(),{value:0})}dispose(){return super.dispose(),this._gtz.dispose(),this._subtract.dispose(),this.comparator.dispose(),this}};let vr=class vr extends ir{constructor(){super(Object.assign(ui(vr.getDefaults(),arguments,["min","max","exponent"]))),this.name="ScaleExp";let l=ui(vr.getDefaults(),arguments,["min","max","exponent"]);this.input=this._exp=new Fo({context:this.context,value:l.exponent}),this._exp.connect(this._mult)}static getDefaults(){return Object.assign(ir.getDefaults(),{exponent:1})}get exponent(){return this._exp.value}set exponent(l){this._exp.value=l}dispose(){return super.dispose(),this._exp.dispose(),this}};let yr=class yr extends po{constructor(){super(ui(po.getDefaults(),arguments,["value","units"])),this.name="SyncedSignal",this.override=!1;let l=ui(po.getDefaults(),arguments,["value","units"]);this._lastVal=l.value,this._synced=this.context.transport.scheduleRepeat(this._onTick.bind(this),"1i"),this._syncedCallback=this._anchorValue.bind(this),this.context.transport.on("start",this._syncedCallback),this.context.transport.on("pause",this._syncedCallback),this.context.transport.on("stop",this._syncedCallback),this._constantSource.disconnect(),this._constantSource.stop(0),this._constantSource=this.output=new uo({context:this.context,offset:l.value,units:l.units}).start(0),this.setValueAtTime(l.value,0)}_onTick(l){let p=super.getValueAtTime(this.context.transport.seconds);this._lastVal!==p&&(this._lastVal=p,this._constantSource.offset.setValueAtTime(p,l))}_anchorValue(l){let p=super.getValueAtTime(this.context.transport.seconds);this._lastVal=p,this._constantSource.offset.cancelAndHoldAtTime(l),this._constantSource.offset.setValueAtTime(p,l)}getValueAtTime(l){let p=new Ki(this.context,l).toSeconds();return super.getValueAtTime(p)}setValueAtTime(l,p){let d=new Ki(this.context,p).toSeconds();return super.setValueAtTime(l,d),this}linearRampToValueAtTime(l,p){let d=new Ki(this.context,p).toSeconds();return super.linearRampToValueAtTime(l,d),this}exponentialRampToValueAtTime(l,p){let d=new Ki(this.context,p).toSeconds();return super.exponentialRampToValueAtTime(l,d),this}setTargetAtTime(l,p,d){let f=new Ki(this.context,p).toSeconds();return super.setTargetAtTime(l,f,d),this}cancelScheduledValues(l){let p=new Ki(this.context,l).toSeconds();return super.cancelScheduledValues(p),this}setValueCurveAtTime(l,p,d,f){let _=new Ki(this.context,p).toSeconds();return d=this.toSeconds(d),super.setValueCurveAtTime(l,_,d,f),this}cancelAndHoldAtTime(l){let p=new Ki(this.context,l).toSeconds();return super.cancelAndHoldAtTime(p),this}setRampPoint(l){let p=new Ki(this.context,l).toSeconds();return super.setRampPoint(p),this}exponentialRampTo(l,p,d){let f=new Ki(this.context,d).toSeconds();return super.exponentialRampTo(l,p,f),this}linearRampTo(l,p,d){let f=new Ki(this.context,d).toSeconds();return super.linearRampTo(l,p,f),this}targetRampTo(l,p,d){let f=new Ki(this.context,d).toSeconds();return super.targetRampTo(l,p,f),this}dispose(){return super.dispose(),this.context.transport.clear(this._synced),this.context.transport.off("start",this._syncedCallback),this.context.transport.off("pause",this._syncedCallback),this.context.transport.off("stop",this._syncedCallback),this._constantSource.dispose(),this}};let xr=class xr extends io{constructor(){super(ui(xr.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new po({context:this.context,value:0}),this.output=this._sig,this.input=void 0;let l=ui(xr.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=l.attack,this.decay=l.decay,this.sustain=l.sustain,this.release=l.release,this.attackCurve=l.attackCurve,this.releaseCurve=l.releaseCurve,this.decayCurve=l.decayCurve}static getDefaults(){return Object.assign(io.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(l,p){if(zn(l))return l;{let d;for(d in ik)if(ik[d][p]===l)return d;return l}}_setCurve(l,p,d){if(zn(d)&&Reflect.has(ik,d)){let f=ik[d];Pn(f)?"_decayCurve"!==l&&(this[l]=f[p]):this[l]=f}else{if(!Ln(d)||"_decayCurve"===l)throw Error("Envelope: invalid curve: "+d);this[l]=d}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(l){this._setCurve("_attackCurve","In",l)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(l){this._setCurve("_releaseCurve","Out",l)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(l){this._setCurve("_decayCurve","Out",l)}triggerAttack(l,p=1){this.log("triggerAttack",l,p),l=this.toSeconds(l);let d=this.toSeconds(this.attack),f=this.toSeconds(this.decay),_=this.getValueAtTime(l);if(_>0&&(d=(1-_)/(1/d)),d<this.sampleTime)this._sig.cancelScheduledValues(l),this._sig.setValueAtTime(p,l);else if("linear"===this._attackCurve)this._sig.linearRampTo(p,d,l);else if("exponential"===this._attackCurve)this._sig.targetRampTo(p,d,l);else{this._sig.cancelAndHoldAtTime(l);let f=this._attackCurve;for(let l=1;l<f.length;l++)if(f[l-1]<=_&&_<=f[l]){(f=this._attackCurve.slice(l))[0]=_;break}this._sig.setValueCurveAtTime(f,l,d,p)}if(f&&this.sustain<1){let _=p*this.sustain,m=l+d;this.log("decay",m),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(_,f+m):this._sig.exponentialApproachValueAtTime(_,m,f)}return this}triggerRelease(l){this.log("triggerRelease",l),l=this.toSeconds(l);let p=this.getValueAtTime(l);if(p>0){let d=this.toSeconds(this.release);d<this.sampleTime?this._sig.setValueAtTime(0,l):"linear"===this._releaseCurve?this._sig.linearRampTo(0,d,l):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,d,l):(Bn(Ln(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(l),this._sig.setValueCurveAtTime(this._releaseCurve,l,d,p))}return this}getValueAtTime(l){return this._sig.getValueAtTime(l)}triggerAttackRelease(l,p,d=1){return p=this.toSeconds(p),this.triggerAttack(p,d),this.triggerRelease(p+this.toSeconds(l)),this}cancel(l){return this._sig.cancelScheduledValues(this.toSeconds(l)),this}connect(l,p=0,d=0){return fo(this,l,p,d),this}asArray(l=1024){return ni(this,void 0,void 0,function*(){let p=l/this.context.sampleRate,d=new qi(1,p,this.context.sampleRate),f=this.toSeconds(this.attack)+this.toSeconds(this.decay),_=f+this.toSeconds(this.release),m=.1*_,O=_+m,I=new this.constructor(Object.assign(this.get(),{attack:p*this.toSeconds(this.attack)/O,decay:p*this.toSeconds(this.decay)/O,release:p*this.toSeconds(this.release)/O,context:d}));return I._sig.toDestination(),I.triggerAttackRelease(p*(f+m)/O,0),(yield d.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}};si([cr(0)],xr.prototype,"attack",void 0),si([cr(0)],xr.prototype,"decay",void 0),si([ar(0,1)],xr.prototype,"sustain",void 0),si([cr(0)],xr.prototype,"release",void 0);let ik=(()=>{let l,p;let d=[];for(l=0;l<128;l++)d[l]=Math.sin(l/127*(Math.PI/2));let f=[];for(l=0;l<127;l++){p=l/127;let d=Math.sin(p*(2*Math.PI)*6.4-Math.PI/2)+1;f[l]=d/10+.83*p}f[127]=1;let _=[];for(l=0;l<128;l++)_[l]=Math.ceil(l/127*5)/5;let m=[];for(l=0;l<128;l++)p=l/127,m[l]=.5*(1-Math.cos(Math.PI*p));let O=[];for(l=0;l<128;l++){p=l/127;let d=4*Math.pow(p,3)+.2,f=Math.cos(d*Math.PI*2*p);O[l]=Math.abs(f*(1-p))}function c(l){let p=Array(l.length);for(let d=0;d<l.length;d++)p[d]=1-l[d];return p}return{bounce:{In:c(O),Out:O},cosine:{In:d,Out:d.slice(0).reverse()},exponential:"exponential",linear:"linear",ripple:{In:f,Out:c(f)},sine:{In:m,Out:c(m)},step:{In:_,Out:c(_)}}})();let br=class br extends io{constructor(){super(ui(br.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=l=>this._original_triggerRelease(l);let l=ui(br.getDefaults(),arguments);this._volume=this.output=new Oo({context:this.context,volume:l.volume}),this.volume=this._volume.volume,Oi(this,"volume")}static getDefaults(){return Object.assign(io.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let l=!1;return this._synced||(this._synced=!0,l=!0),l}_syncMethod(l,p){let d=this["_original_"+l]=this[l];this[l]=(...l)=>{let f=l[p],_=this.context.transport.schedule(f=>{l[p]=f,d.apply(this,l)},f);this._scheduledEvents.push(_)}}unsync(){return this._scheduledEvents.forEach(l=>this.context.transport.clear(l)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(l,p,d,f){let _=this.toSeconds(d),m=this.toSeconds(p);return this.triggerAttack(l,_,f),this.triggerRelease(_+m),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}};let Tr=class Tr extends br{constructor(){super(ui(Tr.getDefaults(),arguments));let l=ui(Tr.getDefaults(),arguments);this.portamento=l.portamento,this.onsilence=l.onsilence}static getDefaults(){return Object.assign(br.getDefaults(),{detune:0,onsilence:Ei,portamento:0})}triggerAttack(l,p,d=1){this.log("triggerAttack",l,p,d);let f=this.toSeconds(p);return this._triggerEnvelopeAttack(f,d),this.setNote(l,f),this}triggerRelease(l){this.log("triggerRelease",l);let p=this.toSeconds(l);return this._triggerEnvelopeRelease(p),this}setNote(l,p){let d=this.toSeconds(p),f=l instanceof Yi?l.toFrequency():l;if(this.portamento>0&&this.getLevelAtTime(d)>.05){let l=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(f,l,d)}else this.frequency.setValueAtTime(f,d);return this}};si([cr(0)],Tr.prototype,"portamento",void 0);let Sr=class Sr extends xr{constructor(){super(ui(Sr.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new ho({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}};let kr=class kr extends Tr{constructor(){super(ui(kr.getDefaults(),arguments)),this.name="Synth";let l=ui(kr.getDefaults(),arguments);this.oscillator=new sr(Object.assign({context:this.context,detune:l.detune,onstop:()=>this.onsilence(this)},l.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new Sr(Object.assign({context:this.context},l.envelope)),this.oscillator.chain(this.envelope,this.output),Oi(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Tr.getDefaults(),{envelope:Object.assign(di(xr.getDefaults(),Object.keys(io.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(di(sr.getDefaults(),[...Object.keys(Po.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(l,p){if(this.envelope.triggerAttack(l,p),this.oscillator.start(l),0===this.envelope.sustain){let p=this.toSeconds(this.envelope.attack),d=this.toSeconds(this.envelope.decay);this.oscillator.stop(l+p+d)}}_triggerEnvelopeRelease(l){this.envelope.triggerRelease(l),this.oscillator.stop(l+this.toSeconds(this.envelope.release))}getLevelAtTime(l){return l=this.toSeconds(l),this.envelope.getValueAtTime(l)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}};let Ar=class Ar extends Tr{constructor(){super(ui(Ar.getDefaults(),arguments)),this.name="ModulationSynth";let l=ui(Ar.getDefaults(),arguments);this._carrier=new kr({context:this.context,oscillator:l.oscillator,envelope:l.envelope,onsilence:()=>this.onsilence(this),volume:-10}),this._modulator=new kr({context:this.context,oscillator:l.modulation,envelope:l.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new po({context:this.context,units:"frequency"}),this.detune=new po({context:this.context,value:l.detune,units:"cents"}),this.harmonicity=new Yo({context:this.context,value:l.harmonicity,minValue:0}),this._modulationNode=new ho({context:this.context,gain:0}),Oi(this,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])}static getDefaults(){return Object.assign(Tr.getDefaults(),{harmonicity:3,oscillator:Object.assign(di(sr.getDefaults(),[...Object.keys(Po.getDefaults()),"frequency","detune"]),{type:"sine"}),envelope:Object.assign(di(xr.getDefaults(),Object.keys(io.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(di(sr.getDefaults(),[...Object.keys(Po.getDefaults()),"frequency","detune"]),{type:"square"}),modulationEnvelope:Object.assign(di(xr.getDefaults(),Object.keys(io.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(l,p){this._carrier._triggerEnvelopeAttack(l,p),this._modulator._triggerEnvelopeAttack(l,p)}_triggerEnvelopeRelease(l){return this._carrier._triggerEnvelopeRelease(l),this._modulator._triggerEnvelopeRelease(l),this}getLevelAtTime(l){return l=this.toSeconds(l),this.envelope.getValueAtTime(l)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}};let Cr=class Cr extends Ar{constructor(){super(ui(Cr.getDefaults(),arguments)),this.name="AMSynth",this._modulationScale=new Xo({context:this.context}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output)}dispose(){return super.dispose(),this._modulationScale.dispose(),this}};let Dr=class Dr extends io{constructor(){super(ui(Dr.getDefaults(),arguments,["frequency","type"])),this.name="BiquadFilter";let l=ui(Dr.getDefaults(),arguments,["frequency","type"]);this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new no({context:this.context,units:"number",value:l.Q,param:this._filter.Q}),this.frequency=new no({context:this.context,units:"frequency",value:l.frequency,param:this._filter.frequency}),this.detune=new no({context:this.context,units:"cents",value:l.detune,param:this._filter.detune}),this.gain=new no({context:this.context,units:"decibels",convert:!1,value:l.gain,param:this._filter.gain}),this.type=l.type}static getDefaults(){return Object.assign(io.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(l){Bn(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(l),`Invalid filter type: ${l}`),this._filter.type=l}getFrequencyResponse(l=128){let p=new Float32Array(l);for(let d=0;d<l;d++){let f=19980*Math.pow(d/l,2)+20;p[d]=f}let d=new Float32Array(l),f=new Float32Array(l),_=this.context.createBiquadFilter();return _.type=this.type,_.Q.value=this.Q.value,_.frequency.value=this.frequency.value,_.gain.value=this.gain.value,_.getFrequencyResponse(p,d,f),d}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}};let Or=class Or extends io{constructor(){super(ui(Or.getDefaults(),arguments,["frequency","type","rolloff"])),this.name="Filter",this.input=new ho({context:this.context}),this.output=new ho({context:this.context}),this._filters=[];let l=ui(Or.getDefaults(),arguments,["frequency","type","rolloff"]);this._filters=[],this.Q=new po({context:this.context,units:"positive",value:l.Q}),this.frequency=new po({context:this.context,units:"frequency",value:l.frequency}),this.detune=new po({context:this.context,units:"cents",value:l.detune}),this.gain=new po({context:this.context,units:"decibels",convert:!1,value:l.gain}),this._type=l.type,this.rolloff=l.rolloff,Oi(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(io.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(l){Bn(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(l),`Invalid filter type: ${l}`),this._type=l,this._filters.forEach(p=>p.type=l)}get rolloff(){return this._rolloff}set rolloff(l){let p=Nn(l)?l:parseInt(l,10),d=[-12,-24,-48,-96],f=d.indexOf(p);Bn(-1!==f,`rolloff can only be ${d.join(", ")}`),f+=1,this._rolloff=p,this.input.disconnect(),this._filters.forEach(l=>l.disconnect()),this._filters=Array(f);for(let l=0;l<f;l++){let p=new Dr({context:this.context});p.type=this._type,this.frequency.connect(p.frequency),this.detune.connect(p.detune),this.Q.connect(p.Q),this.gain.connect(p.gain),this._filters[l]=p}this._internalChannels=this._filters,oo(this.input,...this._internalChannels,this.output)}getFrequencyResponse(l=128){let p=new Dr({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),d=new Float32Array(l).map(()=>1);return this._filters.forEach(()=>{p.getFrequencyResponse(l).forEach((l,p)=>d[p]*=l)}),p.dispose(),d}dispose(){return super.dispose(),this._filters.forEach(l=>{l.dispose()}),Mi(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}};let Mr=class Mr extends xr{constructor(){super(ui(Mr.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="FrequencyEnvelope";let l=ui(Mr.getDefaults(),arguments,["attack","decay","sustain","release"]);this._octaves=l.octaves,this._baseFrequency=this.toFrequency(l.baseFrequency),this._exponent=this.input=new Fo({context:this.context,value:l.exponent}),this._scale=this.output=new ir({context:this.context,min:this._baseFrequency,max:this._baseFrequency*Math.pow(2,this._octaves)}),this._sig.chain(this._exponent,this._scale)}static getDefaults(){return Object.assign(xr.getDefaults(),{baseFrequency:200,exponent:1,octaves:4})}get baseFrequency(){return this._baseFrequency}set baseFrequency(l){let p=this.toFrequency(l);Un(p,0),this._baseFrequency=p,this._scale.min=this._baseFrequency,this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(l){this._octaves=l,this._scale.max=this._baseFrequency*Math.pow(2,l)}get exponent(){return this._exponent.value}set exponent(l){this._exponent.value=l}dispose(){return super.dispose(),this._exponent.dispose(),this._scale.dispose(),this}};let Er=class Er extends Tr{constructor(){super(ui(Er.getDefaults(),arguments)),this.name="MonoSynth";let l=ui(Er.getDefaults(),arguments);this.oscillator=new sr(Object.assign(l.oscillator,{context:this.context,detune:l.detune,onstop:()=>this.onsilence(this)})),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new Or(Object.assign(l.filter,{context:this.context})),this.filterEnvelope=new Mr(Object.assign(l.filterEnvelope,{context:this.context})),this.envelope=new Sr(Object.assign(l.envelope,{context:this.context})),this.oscillator.chain(this.filter,this.envelope,this.output),this.filterEnvelope.connect(this.filter.frequency),Oi(this,["oscillator","frequency","detune","filter","filterEnvelope","envelope"])}static getDefaults(){return Object.assign(Tr.getDefaults(),{envelope:Object.assign(di(xr.getDefaults(),Object.keys(io.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.9}),filter:Object.assign(di(Or.getDefaults(),Object.keys(io.getDefaults())),{Q:1,rolloff:-12,type:"lowpass"}),filterEnvelope:Object.assign(di(Mr.getDefaults(),Object.keys(io.getDefaults())),{attack:.6,baseFrequency:200,decay:.2,exponent:2,octaves:3,release:2,sustain:.5}),oscillator:Object.assign(di(sr.getDefaults(),Object.keys(Po.getDefaults())),{type:"sawtooth"})})}_triggerEnvelopeAttack(l,p=1){if(this.envelope.triggerAttack(l,p),this.filterEnvelope.triggerAttack(l),this.oscillator.start(l),0===this.envelope.sustain){let p=this.toSeconds(this.envelope.attack),d=this.toSeconds(this.envelope.decay);this.oscillator.stop(l+p+d)}}_triggerEnvelopeRelease(l){this.envelope.triggerRelease(l),this.filterEnvelope.triggerRelease(l),this.oscillator.stop(l+this.toSeconds(this.envelope.release))}getLevelAtTime(l){return l=this.toSeconds(l),this.envelope.getValueAtTime(l)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this.filterEnvelope.dispose(),this.filter.dispose(),this}};let Rr=class Rr extends Tr{constructor(){super(ui(Rr.getDefaults(),arguments)),this.name="DuoSynth";let l=ui(Rr.getDefaults(),arguments);this.voice0=new Er(Object.assign(l.voice0,{context:this.context,onsilence:()=>this.onsilence(this)})),this.voice1=new Er(Object.assign(l.voice1,{context:this.context})),this.harmonicity=new Yo({context:this.context,units:"positive",value:l.harmonicity}),this._vibrato=new rr({frequency:l.vibratoRate,context:this.context,min:-50,max:50}),this._vibrato.start(),this.vibratoRate=this._vibrato.frequency,this._vibratoGain=new ho({context:this.context,units:"normalRange",gain:l.vibratoAmount}),this.vibratoAmount=this._vibratoGain.gain,this.frequency=new po({context:this.context,units:"frequency",value:440}),this.detune=new po({context:this.context,units:"cents",value:l.detune}),this.frequency.connect(this.voice0.frequency),this.frequency.chain(this.harmonicity,this.voice1.frequency),this._vibrato.connect(this._vibratoGain),this._vibratoGain.fan(this.voice0.detune,this.voice1.detune),this.detune.fan(this.voice0.detune,this.voice1.detune),this.voice0.connect(this.output),this.voice1.connect(this.output),Oi(this,["voice0","voice1","frequency","vibratoAmount","vibratoRate"])}getLevelAtTime(l){return l=this.toSeconds(l),this.voice0.envelope.getValueAtTime(l)+this.voice1.envelope.getValueAtTime(l)}static getDefaults(){return li(Tr.getDefaults(),{vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:li(di(Er.getDefaults(),Object.keys(Tr.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}),voice1:li(di(Er.getDefaults(),Object.keys(Tr.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}})})}_triggerEnvelopeAttack(l,p){this.voice0._triggerEnvelopeAttack(l,p),this.voice1._triggerEnvelopeAttack(l,p)}_triggerEnvelopeRelease(l){return this.voice0._triggerEnvelopeRelease(l),this.voice1._triggerEnvelopeRelease(l),this}dispose(){return super.dispose(),this.voice0.dispose(),this.voice1.dispose(),this.frequency.dispose(),this.detune.dispose(),this._vibrato.dispose(),this.vibratoRate.dispose(),this._vibratoGain.dispose(),this.harmonicity.dispose(),this}};let qr=class qr extends Ar{constructor(){super(ui(qr.getDefaults(),arguments)),this.name="FMSynth";let l=ui(qr.getDefaults(),arguments);this.modulationIndex=new Yo({context:this.context,value:l.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output)}static getDefaults(){return Object.assign(Ar.getDefaults(),{modulationIndex:10})}dispose(){return super.dispose(),this.modulationIndex.dispose(),this}};let iA=[1,1.483,1.932,2.546,2.63,3.897];let Ir=class Ir extends Tr{constructor(){super(ui(Ir.getDefaults(),arguments)),this.name="MetalSynth",this._oscillators=[],this._freqMultipliers=[];let l=ui(Ir.getDefaults(),arguments);this.detune=new po({context:this.context,units:"cents",value:l.detune}),this.frequency=new po({context:this.context,units:"frequency"}),this._amplitude=new ho({context:this.context,gain:0}).connect(this.output),this._highpass=new Or({Q:0,context:this.context,type:"highpass"}).connect(this._amplitude);for(let p=0;p<iA.length;p++){let d=new Ho({context:this.context,harmonicity:l.harmonicity,modulationIndex:l.modulationIndex,modulationType:"square",onstop:0===p?()=>this.onsilence(this):Ei,type:"square"});d.connect(this._highpass),this._oscillators[p]=d;let f=new Yo({context:this.context,value:iA[p]});this._freqMultipliers[p]=f,this.frequency.chain(f,d.frequency),this.detune.connect(d.detune)}this._filterFreqScaler=new ir({context:this.context,max:7e3,min:this.toFrequency(l.resonance)}),this.envelope=new xr({attack:l.envelope.attack,attackCurve:"linear",context:this.context,decay:l.envelope.decay,release:l.envelope.release,sustain:0}),this.envelope.chain(this._filterFreqScaler,this._highpass.frequency),this.envelope.connect(this._amplitude.gain),this._octaves=l.octaves,this.octaves=l.octaves}static getDefaults(){return li(Tr.getDefaults(),{envelope:Object.assign(di(xr.getDefaults(),Object.keys(io.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})}_triggerEnvelopeAttack(l,p=1){return this.envelope.triggerAttack(l,p),this._oscillators.forEach(p=>p.start(l)),0===this.envelope.sustain&&this._oscillators.forEach(p=>{p.stop(l+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay))}),this}_triggerEnvelopeRelease(l){return this.envelope.triggerRelease(l),this._oscillators.forEach(p=>p.stop(l+this.toSeconds(this.envelope.release))),this}getLevelAtTime(l){return l=this.toSeconds(l),this.envelope.getValueAtTime(l)}get modulationIndex(){return this._oscillators[0].modulationIndex.value}set modulationIndex(l){this._oscillators.forEach(p=>p.modulationIndex.value=l)}get harmonicity(){return this._oscillators[0].harmonicity.value}set harmonicity(l){this._oscillators.forEach(p=>p.harmonicity.value=l)}get resonance(){return this._filterFreqScaler.min}set resonance(l){this._filterFreqScaler.min=this.toFrequency(l),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(l){this._octaves=l,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,l)}dispose(){return super.dispose(),this._oscillators.forEach(l=>l.dispose()),this._freqMultipliers.forEach(l=>l.dispose()),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}};let Vr=class Vr extends kr{constructor(){super(ui(Vr.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;let l=ui(Vr.getDefaults(),arguments);this.pitchDecay=l.pitchDecay,this.octaves=l.octaves,Oi(this,["oscillator","envelope"])}static getDefaults(){return li(Tr.getDefaults(),kr.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(l,p){let d=this.toSeconds(p),f=this.toFrequency(l instanceof Yi?l.toFrequency():l),_=f*this.octaves;return this.oscillator.frequency.setValueAtTime(_,d),this.oscillator.frequency.exponentialRampToValueAtTime(f,d+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}};si([ar(0)],Vr.prototype,"octaves",void 0),si([cr(0)],Vr.prototype,"pitchDecay",void 0);let Nr=class Nr extends br{constructor(){super(ui(Nr.getDefaults(),arguments)),this.name="NoiseSynth";let l=ui(Nr.getDefaults(),arguments);this.noise=new Lo(Object.assign({context:this.context},l.noise)),this.envelope=new Sr(Object.assign({context:this.context},l.envelope)),this.noise.chain(this.envelope,this.output)}static getDefaults(){return Object.assign(br.getDefaults(),{envelope:Object.assign(di(xr.getDefaults(),Object.keys(io.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(di(Lo.getDefaults(),Object.keys(Po.getDefaults())),{type:"white"})})}triggerAttack(l,p=1){return l=this.toSeconds(l),this.envelope.triggerAttack(l,p),this.noise.start(l),0===this.envelope.sustain&&this.noise.stop(l+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}triggerRelease(l){return l=this.toSeconds(l),this.envelope.triggerRelease(l),this.noise.stop(l+this.toSeconds(this.envelope.release)),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}triggerAttackRelease(l,p,d=1){return p=this.toSeconds(p),l=this.toSeconds(l),this.triggerAttack(p,d),this.triggerRelease(p+l),this}dispose(){return super.dispose(),this.noise.dispose(),this.envelope.dispose(),this}};let iC=new Set;function Lr(l,p){let d=`registerProcessor("${l}", ${p})`;iC.add(d)}let zr=class zr extends io{constructor(l){super(l),this.name="ToneAudioWorklet",this.workletOptions={},this.onprocessorerror=Ei;let p=URL.createObjectURL(new Blob([Array.from(iC).join("\n")],{type:"text/javascript"})),d=this._audioWorkletName();this._dummyGain=this.context.createGain(),this._dummyParam=this._dummyGain.gain,this.context.addAudioWorkletModule(p).then(()=>{this.disposed||(this._worklet=this.context.createAudioWorkletNode(d,this.workletOptions),this._worklet.onprocessorerror=this.onprocessorerror.bind(this),this.onReady(this._worklet))})}dispose(){return super.dispose(),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}};iC.add('\n	/**\n	 * The base AudioWorkletProcessor for use in Tone.js. Works with the {@link ToneAudioWorklet}. \n	 */\n	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n		constructor(options) {\n			\n			super(options);\n			/**\n			 * If the processor was disposed or not. Keep alive until it\'s disposed.\n			 */\n			this.disposed = false;\n		   	/** \n			 * The number of samples in the processing block\n			 */\n			this.blockSize = 128;\n			/**\n			 * the sample rate\n			 */\n			this.sampleRate = sampleRate;\n\n			this.port.onmessage = (event) => {\n				// when it receives a dispose \n				if (event.data === "dispose") {\n					this.disposed = true;\n				}\n			};\n		}\n	}\n'),iC.add("\n	/**\n	 * Abstract class for a single input/output processor. \n	 * has a 'generate' function which processes one sample at a time\n	 */\n	class SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n		constructor(options) {\n			super(Object.assign(options, {\n				numberOfInputs: 1,\n				numberOfOutputs: 1\n			}));\n			/**\n			 * Holds the name of the parameter and a single value of that\n			 * parameter at the current sample\n			 * @type { [name: string]: number }\n			 */\n			this.params = {}\n		}\n\n		/**\n		 * Generate an output sample from the input sample and parameters\n		 * @abstract\n		 * @param input number\n		 * @param channel number\n		 * @param parameters { [name: string]: number }\n		 * @returns number\n		 */\n		generate(){}\n\n		/**\n		 * Update the private params object with the \n		 * values of the parameters at the given index\n		 * @param parameters { [name: string]: Float32Array },\n		 * @param index number\n		 */\n		updateParams(parameters, index) {\n			for (const paramName in parameters) {\n				const param = parameters[paramName];\n				if (param.length > 1) {\n					this.params[paramName] = parameters[paramName][index];\n				} else {\n					this.params[paramName] = parameters[paramName][0];\n				}\n			}\n		}\n\n		/**\n		 * Process a single frame of the audio\n		 * @param inputs Float32Array[][]\n		 * @param outputs Float32Array[][]\n		 */\n		process(inputs, outputs, parameters) {\n			const input = inputs[0];\n			const output = outputs[0];\n			// get the parameter values\n			const channelCount = Math.max(input && input.length || 0, output.length);\n			for (let sample = 0; sample < this.blockSize; sample++) {\n				this.updateParams(parameters, sample);\n				for (let channel = 0; channel < channelCount; channel++) {\n					const inputSample = input && input.length ? input[channel][sample] : 0;\n					output[channel][sample] = this.generate(inputSample, channel, this.params);\n				}\n			}\n			return !this.disposed;\n		}\n	};\n"),iC.add("\n	/**\n	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n	 */\n	class DelayLine {\n		\n		constructor(size, channels) {\n			this.buffer = [];\n			this.writeHead = []\n			this.size = size;\n\n			// create the empty channels\n			for (let i = 0; i < channels; i++) {\n				this.buffer[i] = new Float32Array(this.size);\n				this.writeHead[i] = 0;\n			}\n		}\n\n		/**\n		 * Push a value onto the end\n		 * @param channel number\n		 * @param value number\n		 */\n		push(channel, value) {\n			this.writeHead[channel] += 1;\n			if (this.writeHead[channel] > this.size) {\n				this.writeHead[channel] = 0;\n			}\n			this.buffer[channel][this.writeHead[channel]] = value;\n		}\n\n		/**\n		 * Get the recorded value of the channel given the delay\n		 * @param channel number\n		 * @param delay number delay samples\n		 */\n		get(channel, delay) {\n			let readHead = this.writeHead[channel] - Math.floor(delay);\n			if (readHead < 0) {\n				readHead += this.size;\n			}\n			return this.buffer[channel][readHead];\n		}\n	}\n");let iO="feedback-comb-filter";Lr(iO,'\n	class FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n		constructor(options) {\n			super(options);\n			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n		}\n\n		static get parameterDescriptors() {\n			return [{\n				name: "delayTime",\n				defaultValue: 0.1,\n				minValue: 0,\n				maxValue: 1,\n				automationRate: "k-rate"\n			}, {\n				name: "feedback",\n				defaultValue: 0.5,\n				minValue: 0,\n				maxValue: 0.9999,\n				automationRate: "k-rate"\n			}];\n		}\n\n		generate(input, channel, parameters) {\n			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n			this.delayLine.push(channel, input + delayedSample * parameters.feedback);\n			return delayedSample;\n		}\n	}\n');let Br=class Br extends zr{constructor(){super(ui(Br.getDefaults(),arguments,["delayTime","resonance"])),this.name="FeedbackCombFilter";let l=ui(Br.getDefaults(),arguments,["delayTime","resonance"]);this.input=new ho({context:this.context}),this.output=new ho({context:this.context}),this.delayTime=new no({context:this.context,value:l.delayTime,units:"time",minValue:0,maxValue:1,param:this._dummyParam,swappable:!0}),this.resonance=new no({context:this.context,value:l.resonance,units:"normalRange",param:this._dummyParam,swappable:!0}),Oi(this,["resonance","delayTime"])}_audioWorkletName(){return iO}static getDefaults(){return Object.assign(io.getDefaults(),{delayTime:.1,resonance:.5})}onReady(l){oo(this.input,l,this.output);let p=l.parameters.get("delayTime");this.delayTime.setParam(p);let d=l.parameters.get("feedback");this.resonance.setParam(d)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.delayTime.dispose(),this.resonance.dispose(),this}};let Ur=class Ur extends io{constructor(){super(ui(Ur.getDefaults(),arguments,["frequency","type"])),this.name="OnePoleFilter";let l=ui(Ur.getDefaults(),arguments,["frequency","type"]);this._frequency=l.frequency,this._type=l.type,this.input=new ho({context:this.context}),this.output=new ho({context:this.context}),this._createFilter()}static getDefaults(){return Object.assign(io.getDefaults(),{frequency:880,type:"lowpass"})}_createFilter(){let l=this._filter,p=this.toFrequency(this._frequency),d=1/(2*Math.PI*p);if("lowpass"===this._type){let l=1/(d*this.context.sampleRate),p=l-1;this._filter=this.context.createIIRFilter([l,0],[1,p])}else{let l=1/(d*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,l])}this.input.chain(this._filter,this.output),l&&this.context.setTimeout(()=>{this.disposed||(this.input.disconnect(l),l.disconnect())},this.blockTime)}get frequency(){return this._frequency}set frequency(l){this._frequency=l,this._createFilter()}get type(){return this._type}set type(l){this._type=l,this._createFilter()}getFrequencyResponse(l=128){let p=new Float32Array(l);for(let d=0;d<l;d++){let f=19980*Math.pow(d/l,2)+20;p[d]=f}let d=new Float32Array(l),f=new Float32Array(l);return this._filter.getFrequencyResponse(p,d,f),d}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}};let Gr=class Gr extends io{constructor(){super(ui(Gr.getDefaults(),arguments,["delayTime","resonance","dampening"])),this.name="LowpassCombFilter";let l=ui(Gr.getDefaults(),arguments,["delayTime","resonance","dampening"]);this._combFilter=this.output=new Br({context:this.context,delayTime:l.delayTime,resonance:l.resonance}),this.delayTime=this._combFilter.delayTime,this.resonance=this._combFilter.resonance,this._lowpass=this.input=new Ur({context:this.context,frequency:l.dampening,type:"lowpass"}),this._lowpass.connect(this._combFilter)}static getDefaults(){return Object.assign(io.getDefaults(),{dampening:3e3,delayTime:.1,resonance:.5})}get dampening(){return this._lowpass.frequency}set dampening(l){this._lowpass.frequency=l}dispose(){return super.dispose(),this._combFilter.dispose(),this._lowpass.dispose(),this}};let Qr=class Qr extends br{constructor(){super(ui(Qr.getDefaults(),arguments)),this.name="PluckSynth";let l=ui(Qr.getDefaults(),arguments);this._noise=new Lo({context:this.context,type:"pink"}),this.attackNoise=l.attackNoise,this._lfcf=new Gr({context:this.context,dampening:l.dampening,resonance:l.resonance}),this.resonance=l.resonance,this.release=l.release,this._noise.connect(this._lfcf),this._lfcf.connect(this.output)}static getDefaults(){return li(br.getDefaults(),{attackNoise:1,dampening:4e3,resonance:.7,release:1})}get dampening(){return this._lfcf.dampening}set dampening(l){this._lfcf.dampening=l}triggerAttack(l,p){let d=this.toFrequency(l);p=this.toSeconds(p);let f=1/d;return this._lfcf.delayTime.setValueAtTime(f,p),this._noise.start(p),this._noise.stop(p+f*this.attackNoise),this._lfcf.resonance.cancelScheduledValues(p),this._lfcf.resonance.setValueAtTime(this.resonance,p),this}triggerRelease(l){return this._lfcf.resonance.linearRampTo(0,this.release,l),this}dispose(){return super.dispose(),this._noise.dispose(),this._lfcf.dispose(),this}};let Zr=class Zr extends br{constructor(){super(ui(Zr.getDefaults(),arguments,["voice","options"])),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0,this._syncedRelease=l=>this.releaseAll(l);let l=ui(Zr.getDefaults(),arguments,["voice","options"]);Bn(!Nn(l.voice),"DEPRECATED: The polyphony count is no longer the first argument.");let p=l.voice.getDefaults();this.options=Object.assign(p,l.options),this.voice=l.voice,this.maxPolyphony=l.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();let d=this._voices.indexOf(this._dummyVoice);this._voices.splice(d,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(br.getDefaults(),{maxPolyphony:32,options:{},voice:kr})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(l){this._availableVoices.push(l);let p=this._activeVoices.findIndex(p=>p.voice===l);this._activeVoices.splice(p,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){let l=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return Bn(l instanceof Tr,"Voice must extend Monophonic class"),l.connect(this.output),this._voices.push(l),l}Kn("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){let l=this._availableVoices.shift(),p=this._voices.indexOf(l);this._voices.splice(p,1),this.context.isOffline||l.dispose()}}_triggerAttack(l,p,d){l.forEach(l=>{let f=new bo(this.context,l).toMidi(),_=this._getNextAvailableVoice();_&&(_.triggerAttack(l,p,d),this._activeVoices.push({midi:f,voice:_,released:!1}),this.log("triggerAttack",l,p))})}_triggerRelease(l,p){l.forEach(l=>{let d=new bo(this.context,l).toMidi(),f=this._activeVoices.find(({midi:l,released:p})=>l===d&&!p);f&&(f.voice.triggerRelease(p),f.released=!0,this.log("triggerRelease",l,p))})}_scheduleEvent(l,p,d,f){Bn(!this.disposed,"Synth was already disposed"),d<=this.now()?"attack"===l?this._triggerAttack(p,d,f):this._triggerRelease(p,d):this.context.setTimeout(()=>{this.disposed||this._scheduleEvent(l,p,d,f)},d-this.now())}triggerAttack(l,p,d){Array.isArray(l)||(l=[l]);let f=this.toSeconds(p);return this._scheduleEvent("attack",l,f,d),this}triggerRelease(l,p){Array.isArray(l)||(l=[l]);let d=this.toSeconds(p);return this._scheduleEvent("release",l,d),this}triggerAttackRelease(l,p,d,f){let _=this.toSeconds(d);if(this.triggerAttack(l,_,f),Ln(p)){Bn(Ln(l),"If the duration is an array, the notes must also be an array");for(let d=0;d<l.length;d++){let f=p[Math.min(d,p.length-1)],m=this.toSeconds(f);Bn(m>0,"The duration must be greater than 0"),this.triggerRelease(l[d],_+m)}}else{let d=this.toSeconds(p);Bn(d>0,"The duration must be greater than 0"),this.triggerRelease(l,_+d)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}set(l){let p=di(l,["onsilence","context"]);return this.options=li(this.options,p),this._voices.forEach(l=>l.set(p)),this._dummyVoice.set(p),this}get(){return this._dummyVoice.get()}releaseAll(l){let p=this.toSeconds(l);return this._activeVoices.forEach(({voice:l})=>{l.triggerRelease(p)}),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach(l=>l.dispose()),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}};let Xr=class Xr extends br{constructor(){super(ui(Xr.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;let l=ui(Xr.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),p={};Object.keys(l.urls).forEach(d=>{let f=parseInt(d,10);if(Bn(Wn(d)||Nn(f)&&isFinite(f),`url key is neither a note or midi pitch: ${d}`),Wn(d)){let f=new Yi(this.context,d).toMidi();p[f]=l.urls[d]}else Nn(f)&&isFinite(f)&&(p[f]=l.urls[f])}),this._buffers=new wo({urls:p,onload:l.onload,baseUrl:l.baseUrl,onerror:l.onerror}),this.attack=l.attack,this.release=l.release,this.curve=l.curve,this._buffers.loaded&&Promise.resolve().then(l.onload)}static getDefaults(){return Object.assign(br.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Ei,onerror:Ei,release:.1,urls:{}})}_findClosest(l){let p=0;for(;p<96;){if(this._buffers.has(l+p))return-p;if(this._buffers.has(l-p))return p;p++}throw Error(`No available buffers for note: ${l}`)}triggerAttack(l,p,d=1){return this.log("triggerAttack",l,p,d),Array.isArray(l)||(l=[l]),l.forEach(l=>{let f=Ui(new Yi(this.context,l).toFrequency()),_=Math.round(f),m=f-_,O=this._findClosest(_),I=_-O,V=this._buffers.get(I),F=zi(O+m),P=new jo({url:V,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:F}).connect(this.output);P.start(p,0,V.duration/F,d),Ln(this._activeSources.get(_))||this._activeSources.set(_,[]),this._activeSources.get(_).push(P),P.onended=()=>{if(this._activeSources&&this._activeSources.has(_)){let l=this._activeSources.get(_),p=l.indexOf(P);-1!==p&&l.splice(p,1)}}}),this}triggerRelease(l,p){return this.log("triggerRelease",l,p),Array.isArray(l)||(l=[l]),l.forEach(l=>{let d=new Yi(this.context,l).toMidi();if(this._activeSources.has(d)&&this._activeSources.get(d).length){let l=this._activeSources.get(d);p=this.toSeconds(p),l.forEach(l=>{l.stop(p)}),this._activeSources.set(d,[])}}),this}releaseAll(l){let p=this.toSeconds(l);return this._activeSources.forEach(l=>{for(;l.length;)l.shift().stop(p)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(l,p,d,f=1){let _=this.toSeconds(d);return this.triggerAttack(l,_,f),Ln(p)?(Bn(Ln(l),"notes must be an array when duration is array"),l.forEach((l,d)=>{let f=p[Math.min(d,p.length-1)];this.triggerRelease(l,_+this.toSeconds(f))})):this.triggerRelease(l,_+this.toSeconds(p)),this}add(l,p,d){if(Bn(Wn(l)||isFinite(l),`note must be a pitch or midi: ${l}`),Wn(l)){let f=new Yi(this.context,l).toMidi();this._buffers.add(f,p,d)}else this._buffers.add(l,p,d);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(l=>{l.forEach(l=>l.dispose())}),this._activeSources.clear(),this}};si([cr(0)],Xr.prototype,"attack",void 0),si([cr(0)],Xr.prototype,"release",void 0);let Yr=class Yr extends eo{constructor(){super(ui(Yr.getDefaults(),arguments,["callback","value"])),this.name="ToneEvent",this._state=new so("stopped"),this._startOffset=0;let l=ui(Yr.getDefaults(),arguments,["callback","value"]);this._loop=l.loop,this.callback=l.callback,this.value=l.value,this._loopStart=this.toTicks(l.loopStart),this._loopEnd=this.toTicks(l.loopEnd),this._playbackRate=l.playbackRate,this._probability=l.probability,this._humanize=l.humanize,this.mute=l.mute,this._playbackRate=l.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(eo.getDefaults(),{callback:Ei,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(l=-1){this._state.forEachFrom(l,l=>{let p;if("started"===l.state){-1!==l.id&&this.context.transport.clear(l.id);let d=l.time+Math.round(this.startOffset/this._playbackRate);if(!0===this._loop||Nn(this._loop)&&this._loop>1){p=1/0,Nn(this._loop)&&(p=this._loop*this._getLoopDuration());let f=this._state.getAfter(d);null!==f&&(p=Math.min(p,f.time-d)),p!==1/0&&(p=new So(this.context,p));let _=new So(this.context,this._getLoopDuration());l.id=this.context.transport.scheduleRepeat(this._tick.bind(this),_,new So(this.context,d),p)}else l.id=this.context.transport.schedule(this._tick.bind(this),new So(this.context,d))}})}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(l){this._startOffset=l}get probability(){return this._probability}set probability(l){this._probability=l}get humanize(){return this._humanize}set humanize(l){this._humanize=l}start(l){let p=this.toTicks(l);return"stopped"===this._state.getValueAtTime(p)&&(this._state.add({id:-1,state:"started",time:p}),this._rescheduleEvents(p)),this}stop(l){this.cancel(l);let p=this.toTicks(l);if("started"===this._state.getValueAtTime(p)){this._state.setStateAtTime("stopped",p,{id:-1});let l=this._state.getBefore(p),d=p;null!==l&&(d=l.time),this._rescheduleEvents(d)}return this}cancel(l){l=pi(l,-1/0);let p=this.toTicks(l);return this._state.forEachFrom(p,l=>{this.context.transport.clear(l.id)}),this._state.cancel(p),this}_tick(l){let p=this.context.transport.getTicksAtTime(l);if(!this.mute&&"started"===this._state.getValueAtTime(p)){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let p=.02;jn(this.humanize)||(p=this.toSeconds(this.humanize)),l+=(2*Math.random()-1)*p}this.callback(l,this.value)}}_getLoopDuration(){return(this._loopEnd-this._loopStart)/this._playbackRate}get loop(){return this._loop}set loop(l){this._loop=l,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(l){this._playbackRate=l,this._rescheduleEvents()}get loopEnd(){return new So(this.context,this._loopEnd).toSeconds()}set loopEnd(l){this._loopEnd=this.toTicks(l),this._loop&&this._rescheduleEvents()}get loopStart(){return new So(this.context,this._loopStart).toSeconds()}set loopStart(l){this._loopStart=this.toTicks(l),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){let l=this.context.transport.ticks,p=this._state.get(l);if(null!==p&&"started"===p.state){let d=this._getLoopDuration();return(l-p.time)%d/d}}return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}};let $r=class $r extends eo{constructor(){super(ui($r.getDefaults(),arguments,["callback","interval"])),this.name="Loop";let l=ui($r.getDefaults(),arguments,["callback","interval"]);this._event=new Yr({context:this.context,callback:this._tick.bind(this),loop:!0,loopEnd:l.interval,playbackRate:l.playbackRate,probability:l.probability,humanize:l.humanize}),this.callback=l.callback,this.iterations=l.iterations}static getDefaults(){return Object.assign(eo.getDefaults(),{interval:"4n",callback:Ei,playbackRate:1,iterations:1/0,probability:1,mute:!1,humanize:!1})}start(l){return this._event.start(l),this}stop(l){return this._event.stop(l),this}cancel(l){return this._event.cancel(l),this}_tick(l){this.callback(l)}get state(){return this._event.state}get progress(){return this._event.progress}get interval(){return this._event.loopEnd}set interval(l){this._event.loopEnd=l}get playbackRate(){return this._event.playbackRate}set playbackRate(l){this._event.playbackRate=l}get humanize(){return this._event.humanize}set humanize(l){this._event.humanize=l}get probability(){return this._event.probability}set probability(l){this._event.probability=l}get mute(){return this._event.mute}set mute(l){this._event.mute=l}get iterations(){return!0===this._event.loop?1/0:this._event.loop}set iterations(l){this._event.loop=l===1/0||l}dispose(){return super.dispose(),this._event.dispose(),this}};let Hr=class Hr extends Yr{constructor(){super(ui(Hr.getDefaults(),arguments,["callback","events"])),this.name="Part",this._state=new so("stopped"),this._events=new Set;let l=ui(Hr.getDefaults(),arguments,["callback","events"]);this._state.increasing=!0,l.events.forEach(l=>{Ln(l)?this.add(l[0],l[1]):this.add(l)})}static getDefaults(){return Object.assign(Yr.getDefaults(),{events:[]})}start(l,p){let d=this.toTicks(l);if("started"!==this._state.getValueAtTime(d)){p=pi(p,this._loop?this._loopStart:0),p=this._loop?pi(p,this._loopStart):pi(p,0);let l=this.toTicks(p);this._state.add({id:-1,offset:l,state:"started",time:d}),this._forEach(p=>{this._startNote(p,d,l)})}return this}_startNote(l,p,d){p-=d,this._loop?l.startOffset>=this._loopStart&&l.startOffset<this._loopEnd?(l.startOffset<d&&(p+=this._getLoopDuration()),l.start(new So(this.context,p))):l.startOffset<this._loopStart&&l.startOffset>=d&&(l.loop=!1,l.start(new So(this.context,p))):l.startOffset>=d&&l.start(new So(this.context,p))}get startOffset(){return this._startOffset}set startOffset(l){this._startOffset=l,this._forEach(l=>{l.startOffset+=this._startOffset})}stop(l){let p=this.toTicks(l);return this._state.cancel(p),this._state.setStateAtTime("stopped",p),this._forEach(p=>{p.stop(l)}),this}at(l,p){let d=new Ki(this.context,l).toTicks(),f=new So(this.context,1).toSeconds(),_=this._events.values(),m=_.next();for(;!m.done;){let l=m.value;if(Math.abs(d-l.startOffset)<f)return In(p)&&(l.value=p),l;m=_.next()}return In(p)?(this.add(l,p),this.at(l)):null}add(l,p){let d;l instanceof Object&&Reflect.has(l,"time")&&(l=(p=l).time);let f=this.toTicks(l);return p instanceof Yr?(d=p).callback=this._tick.bind(this):d=new Yr({callback:this._tick.bind(this),context:this.context,value:p}),d.startOffset=f,d.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(d),this._restartEvent(d),this}_restartEvent(l){this._state.forEach(p=>{"started"===p.state?this._startNote(l,p.time,p.offset):l.stop(new So(this.context,p.time))})}remove(l,p){return Pn(l)&&l.hasOwnProperty("time")&&(l=(p=l).time),l=this.toTicks(l),this._events.forEach(d=>{d.startOffset===l&&(Fn(p)||In(p)&&d.value===p)&&(this._events.delete(d),d.dispose())}),this}clear(){return this._forEach(l=>l.dispose()),this._events.clear(),this}cancel(l){return this._forEach(p=>p.cancel(l)),this._state.cancel(this.toTicks(l)),this}_forEach(l){return this._events&&this._events.forEach(p=>{p instanceof Hr?p._forEach(l):l(p)}),this}_setAll(l,p){this._forEach(d=>{d[l]=p})}_tick(l,p){this.mute||this.callback(l,p)}_testLoopBoundries(l){this._loop&&(l.startOffset<this._loopStart||l.startOffset>=this._loopEnd)?l.cancel(0):"stopped"===l.state&&this._restartEvent(l)}get probability(){return this._probability}set probability(l){this._probability=l,this._setAll("probability",l)}get humanize(){return this._humanize}set humanize(l){this._humanize=l,this._setAll("humanize",l)}get loop(){return this._loop}set loop(l){this._loop=l,this._forEach(p=>{p.loopStart=this.loopStart,p.loopEnd=this.loopEnd,p.loop=l,this._testLoopBoundries(p)})}get loopEnd(){return new So(this.context,this._loopEnd).toSeconds()}set loopEnd(l){this._loopEnd=this.toTicks(l),this._loop&&this._forEach(p=>{p.loopEnd=l,this._testLoopBoundries(p)})}get loopStart(){return new So(this.context,this._loopStart).toSeconds()}set loopStart(l){this._loopStart=this.toTicks(l),this._loop&&this._forEach(l=>{l.loopStart=this.loopStart,this._testLoopBoundries(l)})}get playbackRate(){return this._playbackRate}set playbackRate(l){this._playbackRate=l,this._setAll("playbackRate",l)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}};function*Jr(l){let p=0;for(;p<l;)p=xi(p,0,l-1),yield p,p++}function*Kr(l){let p=l-1;for(;p>=0;)p=xi(p,0,l-1),yield p,p--}function*ta(l,p){for(;;)yield*p(l)}function*ea(l,p){let d=p?0:l-1;for(;;)d=xi(d,0,l-1),yield d,p?++d>=l-1&&(p=!1):--d<=0&&(p=!0)}function*sa(l){let p=0,d=0;for(;p<l;)p=xi(p,0,l-1),yield p,p+=++d%2?2:-1}function*na(l){let p=l-1,d=0;for(;p>=0;)p=xi(p,0,l-1),yield p,p+=++d%2?-2:1}function*ia(l){let p=[];for(let d=0;d<l;d++)p.push(d);for(;p.length>0;){let d=xi(p.splice(Math.floor(p.length*Math.random()),1)[0],0,l-1);yield d}}function*oa(l,p="up",d=0){switch(Bn(l>=1,"The number of values must be at least one"),p){case"up":yield*ta(l,Jr);case"down":yield*ta(l,Kr);case"upDown":yield*ea(l,!0);case"downUp":yield*ea(l,!1);case"alternateUp":yield*ta(l,sa);case"alternateDown":yield*ta(l,na);case"random":yield*function*(l){for(;;){let p=Math.floor(Math.random()*l);yield p}}(l);case"randomOnce":yield*ta(l,ia);case"randomWalk":yield*function*(l){let p=Math.floor(Math.random()*l);for(;;)0===p?p++:p===l-1||.5>Math.random()?p--:p++,yield p}(l)}}let ra=class ra extends $r{constructor(){super(ui(ra.getDefaults(),arguments,["callback","values","pattern"])),this.name="Pattern";let l=ui(ra.getDefaults(),arguments,["callback","values","pattern"]);this.callback=l.callback,this._values=l.values,this._pattern=oa(l.values.length,l.pattern),this._type=l.pattern}static getDefaults(){return Object.assign($r.getDefaults(),{pattern:"up",values:[],callback:Ei})}_tick(l){let p=this._pattern.next();this._index=p.value,this._value=this._values[p.value],this.callback(l,this._value)}get values(){return this._values}set values(l){this._values=l,this.pattern=this._type}get value(){return this._value}get index(){return this._index}get pattern(){return this._type}set pattern(l){this._type=l,this._pattern=oa(this._values.length,this._type)}};let aa=class aa extends Yr{constructor(){super(ui(aa.getDefaults(),arguments,["callback","events","subdivision"])),this.name="Sequence",this._part=new Hr({callback:this._seqCallback.bind(this),context:this.context}),this._events=[],this._eventsArray=[];let l=ui(aa.getDefaults(),arguments,["callback","events","subdivision"]);this._subdivision=this.toTicks(l.subdivision),this.events=l.events,this.loop=l.loop,this.loopStart=l.loopStart,this.loopEnd=l.loopEnd,this.playbackRate=l.playbackRate,this.probability=l.probability,this.humanize=l.humanize,this.mute=l.mute,this.playbackRate=l.playbackRate}static getDefaults(){return Object.assign(di(Yr.getDefaults(),["value"]),{events:[],loop:!0,loopEnd:0,loopStart:0,subdivision:"8n"})}_seqCallback(l,p){null===p||this.mute||this.callback(l,p)}get events(){return this._events}set events(l){this.clear(),this._eventsArray=l,this._events=this._createSequence(this._eventsArray),this._eventsUpdated()}start(l,p){return this._part.start(l,p?this._indexTime(p):p),this}stop(l){return this._part.stop(l),this}get subdivision(){return new So(this.context,this._subdivision).toSeconds()}_createSequence(l){return new Proxy(l,{get:(l,p)=>l[p],set:(l,p,d)=>(zn(p)&&isFinite(parseInt(p,10))&&Ln(d)?l[p]=this._createSequence(d):l[p]=d,this._eventsUpdated(),!0)})}_eventsUpdated(){this._part.clear(),this._rescheduleSequence(this._eventsArray,this._subdivision,this.startOffset),this.loopEnd=this.loopEnd}_rescheduleSequence(l,p,d){l.forEach((l,f)=>{let _=f*p+d;if(Ln(l))this._rescheduleSequence(l,p/l.length,_);else{let p=new So(this.context,_,"i").toSeconds();this._part.add(p,l)}})}_indexTime(l){return new So(this.context,l*this._subdivision+this.startOffset).toSeconds()}clear(){return this._part.clear(),this}dispose(){return super.dispose(),this._part.dispose(),this}get loop(){return this._part.loop}set loop(l){this._part.loop=l}get loopStart(){return this._loopStart}set loopStart(l){this._loopStart=l,this._part.loopStart=this._indexTime(l)}get loopEnd(){return this._loopEnd}set loopEnd(l){this._loopEnd=l,this._part.loopEnd=0===l?this._indexTime(this._eventsArray.length):this._indexTime(l)}get startOffset(){return this._part.startOffset}set startOffset(l){this._part.startOffset=l}get playbackRate(){return this._part.playbackRate}set playbackRate(l){this._part.playbackRate=l}get probability(){return this._part.probability}set probability(l){this._part.probability=l}get progress(){return this._part.progress}get humanize(){return this._part.humanize}set humanize(l){this._part.humanize=l}get length(){return this._part.length}};let ca=class ca extends io{constructor(){super(Object.assign(ui(ca.getDefaults(),arguments,["fade"]))),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new dr({context:this.context}),this.a=new ho({context:this.context,gain:0}),this.b=new ho({context:this.context,gain:0}),this.output=new ho({context:this.context}),this._internalChannels=[this.a,this.b];let l=ui(ca.getDefaults(),arguments,["fade"]);this.fade=new po({context:this.context,units:"normalRange",value:l.fade}),Oi(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",ro(this._split,this.a.gain,0),ro(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(io.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}};let ha=class ha extends io{constructor(l){super(l),this.name="Effect",this._dryWet=new ca({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new ho({context:this.context}),this.effectReturn=new ho({context:this.context}),this.input=new ho({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(l.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],Oi(this,"wet")}static getDefaults(){return Object.assign(io.getDefaults(),{wet:1})}connectEffect(l){return this._internalChannels.push(l),this.effectSend.chain(l,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}};let la=class la extends ha{constructor(l){super(l),this.name="LFOEffect",this._lfo=new rr({context:this.context,frequency:l.frequency,amplitude:l.depth}),this.depth=this._lfo.amplitude,this.frequency=this._lfo.frequency,this.type=l.type,Oi(this,["frequency","depth"])}static getDefaults(){return Object.assign(ha.getDefaults(),{frequency:1,type:"sine",depth:1})}start(l){return this._lfo.start(l),this}stop(l){return this._lfo.stop(l),this}sync(){return this._lfo.sync(),this}unsync(){return this._lfo.unsync(),this}get type(){return this._lfo.type}set type(l){this._lfo.type=l}dispose(){return super.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}};let ua=class ua extends la{constructor(){super(ui(ua.getDefaults(),arguments,["frequency","baseFrequency","octaves"])),this.name="AutoFilter";let l=ui(ua.getDefaults(),arguments,["frequency","baseFrequency","octaves"]);this.filter=new Or(Object.assign(l.filter,{context:this.context})),this.connectEffect(this.filter),this._lfo.connect(this.filter.frequency),this.octaves=l.octaves,this.baseFrequency=l.baseFrequency}static getDefaults(){return Object.assign(la.getDefaults(),{baseFrequency:200,octaves:2.6,filter:{type:"lowpass",rolloff:-12,Q:1}})}get baseFrequency(){return this._lfo.min}set baseFrequency(l){this._lfo.min=this.toFrequency(l),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(l){this._octaves=l,this._lfo.max=this._lfo.min*Math.pow(2,l)}dispose(){return super.dispose(),this.filter.dispose(),this}};let pa=class pa extends io{constructor(){super(Object.assign(ui(pa.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;let l=ui(pa.getDefaults(),arguments,["pan"]);this.pan=new no({context:this.context,param:this._panner.pan,value:l.pan,minValue:-1,maxValue:1}),this._panner.channelCount=l.channelCount,this._panner.channelCountMode="explicit",Oi(this,"pan")}static getDefaults(){return Object.assign(io.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}};let da=class da extends la{constructor(){super(ui(da.getDefaults(),arguments,["frequency"])),this.name="AutoPanner";let l=ui(da.getDefaults(),arguments,["frequency"]);this._panner=new pa({context:this.context,channelCount:l.channelCount}),this.connectEffect(this._panner),this._lfo.connect(this._panner.pan),this._lfo.min=-1,this._lfo.max=1}static getDefaults(){return Object.assign(la.getDefaults(),{channelCount:1})}dispose(){return super.dispose(),this._panner.dispose(),this}};let fa=class fa extends io{constructor(){super(ui(fa.getDefaults(),arguments,["smoothing"])),this.name="Follower";let l=ui(fa.getDefaults(),arguments,["smoothing"]);this._abs=this.input=new pr({context:this.context}),this._lowpass=this.output=new Ur({context:this.context,frequency:1/this.toSeconds(l.smoothing),type:"lowpass"}),this._abs.connect(this._lowpass),this._smoothing=l.smoothing}static getDefaults(){return Object.assign(io.getDefaults(),{smoothing:.05})}get smoothing(){return this._smoothing}set smoothing(l){this._smoothing=l,this._lowpass.frequency=1/this.toSeconds(this.smoothing)}dispose(){return super.dispose(),this._abs.dispose(),this._lowpass.dispose(),this}};let _a=class _a extends ha{constructor(){super(ui(_a.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"])),this.name="AutoWah";let l=ui(_a.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"]);this._follower=new fa({context:this.context,smoothing:l.follower}),this._sweepRange=new vr({context:this.context,min:0,max:1,exponent:.5}),this._baseFrequency=this.toFrequency(l.baseFrequency),this._octaves=l.octaves,this._inputBoost=new ho({context:this.context}),this._bandpass=new Or({context:this.context,rolloff:-48,frequency:0,Q:l.Q}),this._peaking=new Or({context:this.context,type:"peaking"}),this._peaking.gain.value=l.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this._follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=l.sensitivity,Oi(this,["gain","Q"])}static getDefaults(){return Object.assign(ha.getDefaults(),{baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:.2})}get octaves(){return this._octaves}set octaves(l){this._octaves=l,this._setSweepRange()}get follower(){return this._follower.smoothing}set follower(l){this._follower.smoothing=l}get baseFrequency(){return this._baseFrequency}set baseFrequency(l){this._baseFrequency=this.toFrequency(l),this._setSweepRange()}get sensitivity(){return Li(1/this._inputBoost.gain.value)}set sensitivity(l){this._inputBoost.gain.value=1/ji(l)}_setSweepRange(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)}dispose(){return super.dispose(),this._follower.dispose(),this._sweepRange.dispose(),this._bandpass.dispose(),this._peaking.dispose(),this._inputBoost.dispose(),this}};let iD="bit-crusher";Lr(iD,"\n	class BitCrusherWorklet extends SingleIOProcessor {\n\n		static get parameterDescriptors() {\n			return [{\n				name: \"bits\",\n				defaultValue: 12,\n				minValue: 1,\n				maxValue: 16,\n				automationRate: 'k-rate'\n			}];\n		}\n\n		generate(input, _channel, parameters) {\n			const step = Math.pow(0.5, parameters.bits - 1);\n			const val = step * Math.floor(input / step + 0.5);\n			return val;\n		}\n	}\n");let ga=class ga extends ha{constructor(){super(ui(ga.getDefaults(),arguments,["bits"])),this.name="BitCrusher";let l=ui(ga.getDefaults(),arguments,["bits"]);this._bitCrusherWorklet=new va({context:this.context,bits:l.bits}),this.connectEffect(this._bitCrusherWorklet),this.bits=this._bitCrusherWorklet.bits}static getDefaults(){return Object.assign(ha.getDefaults(),{bits:4})}dispose(){return super.dispose(),this._bitCrusherWorklet.dispose(),this}};let va=class va extends zr{constructor(){super(ui(va.getDefaults(),arguments)),this.name="BitCrusherWorklet";let l=ui(va.getDefaults(),arguments);this.input=new ho({context:this.context}),this.output=new ho({context:this.context}),this.bits=new no({context:this.context,value:l.bits,units:"positive",minValue:1,maxValue:16,param:this._dummyParam,swappable:!0})}static getDefaults(){return Object.assign(zr.getDefaults(),{bits:12})}_audioWorkletName(){return iD}onReady(l){oo(this.input,l,this.output);let p=l.parameters.get("bits");this.bits.setParam(p)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.bits.dispose(),this}};let ya=class ya extends ha{constructor(){super(ui(ya.getDefaults(),arguments,["order"])),this.name="Chebyshev";let l=ui(ya.getDefaults(),arguments,["order"]);this._shaper=new qo({context:this.context,length:4096}),this._order=l.order,this.connectEffect(this._shaper),this.order=l.order,this.oversample=l.oversample}static getDefaults(){return Object.assign(ha.getDefaults(),{order:1,oversample:"none"})}_getCoefficient(l,p,d){return d.has(p)||(0===p?d.set(p,0):1===p?d.set(p,l):d.set(p,2*l*this._getCoefficient(l,p-1,d)-this._getCoefficient(l,p-2,d))),d.get(p)}get order(){return this._order}set order(l){Bn(Number.isInteger(l),"'order' must be an integer"),this._order=l,this._shaper.setMap(p=>this._getCoefficient(p,l,new Map))}get oversample(){return this._shaper.oversample}set oversample(l){this._shaper.oversample=l}dispose(){return super.dispose(),this._shaper.dispose(),this}};let xa=class xa extends io{constructor(){super(ui(xa.getDefaults(),arguments,["channels"])),this.name="Split";let l=ui(xa.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(l.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(io.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}};let wa=class wa extends io{constructor(){super(ui(wa.getDefaults(),arguments,["channels"])),this.name="Merge";let l=ui(wa.getDefaults(),arguments,["channels"]);this._merger=this.output=this.input=this.context.createChannelMerger(l.channels)}static getDefaults(){return Object.assign(io.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}};let ba=class ba extends io{constructor(l){super(l),this.name="StereoEffect",this.input=new ho({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new ca({context:this.context,fade:l.wet}),this.wet=this._dryWet.fade,this._split=new xa({context:this.context,channels:2}),this._merge=new wa({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),Oi(this,["wet"])}connectEffectLeft(...l){this._split.connect(l[0],0,0),oo(...l),ro(l[l.length-1],this._merge,0,0)}connectEffectRight(...l){this._split.connect(l[0],1,0),oo(...l),ro(l[l.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(io.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}};let Ta=class Ta extends ba{constructor(l){super(l),this.feedback=new po({context:this.context,value:l.feedback,units:"normalRange"}),this._feedbackL=new ho({context:this.context}),this._feedbackR=new ho({context:this.context}),this._feedbackSplit=new xa({context:this.context,channels:2}),this._feedbackMerge=new wa({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),Oi(this,["feedback"])}static getDefaults(){return Object.assign(ba.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}};let Sa=class Sa extends Ta{constructor(){super(ui(Sa.getDefaults(),arguments,["frequency","delayTime","depth"])),this.name="Chorus";let l=ui(Sa.getDefaults(),arguments,["frequency","delayTime","depth"]);this._depth=l.depth,this._delayTime=l.delayTime/1e3,this._lfoL=new rr({context:this.context,frequency:l.frequency,min:0,max:1}),this._lfoR=new rr({context:this.context,frequency:l.frequency,min:0,max:1,phase:180}),this._delayNodeL=new yo({context:this.context}),this._delayNodeR=new yo({context:this.context}),this.frequency=this._lfoL.frequency,Oi(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=l.type,this.spread=l.spread}static getDefaults(){return Object.assign(Ta.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(l){this._depth=l;let p=this._delayTime*l;this._lfoL.min=Math.max(this._delayTime-p,0),this._lfoL.max=this._delayTime+p,this._lfoR.min=Math.max(this._delayTime-p,0),this._lfoR.max=this._delayTime+p}get delayTime(){return 1e3*this._delayTime}set delayTime(l){this._delayTime=l/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(l){this._lfoL.type=l,this._lfoR.type=l}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(l){this._lfoL.phase=90-l/2,this._lfoR.phase=l/2+90}start(l){return this._lfoL.start(l),this._lfoR.start(l),this}stop(l){return this._lfoL.stop(l),this._lfoR.stop(l),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}};let ka=class ka extends ha{constructor(){super(ui(ka.getDefaults(),arguments,["distortion"])),this.name="Distortion";let l=ui(ka.getDefaults(),arguments,["distortion"]);this._shaper=new qo({context:this.context,length:4096}),this._distortion=l.distortion,this.connectEffect(this._shaper),this.distortion=l.distortion,this.oversample=l.oversample}static getDefaults(){return Object.assign(ha.getDefaults(),{distortion:.4,oversample:"none"})}get distortion(){return this._distortion}set distortion(l){this._distortion=l;let p=100*l,d=Math.PI/180;this._shaper.setMap(l=>.001>Math.abs(l)?0:(3+p)*l*20*d/(Math.PI+p*Math.abs(l)))}get oversample(){return this._shaper.oversample}set oversample(l){this._shaper.oversample=l}dispose(){return super.dispose(),this._shaper.dispose(),this}};let Aa=class Aa extends ha{constructor(l){super(l),this.name="FeedbackEffect",this._feedbackGain=new ho({context:this.context,gain:l.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,Oi(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(ha.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}};let Ca=class Ca extends Aa{constructor(){super(ui(Ca.getDefaults(),arguments,["delayTime","feedback"])),this.name="FeedbackDelay";let l=ui(Ca.getDefaults(),arguments,["delayTime","feedback"]);this._delayNode=new yo({context:this.context,delayTime:l.delayTime,maxDelay:l.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),Oi(this,"delayTime")}static getDefaults(){return Object.assign(Aa.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}};let Da=class Da extends io{constructor(l){super(l),this.name="PhaseShiftAllpass",this.input=new ho({context:this.context}),this.output=new ho({context:this.context}),this.offset90=new ho({context:this.context}),this._bank0=this._createAllPassFilterBank([.6923878,.9360654322959,.988229522686,.9987488452737]),this._bank1=this._createAllPassFilterBank([.4021921162426,.856171088242,.9722909545651,.9952884791278]),this._oneSampleDelay=this.context.createIIRFilter([0,1],[1,0]),oo(this.input,...this._bank0,this._oneSampleDelay,this.output),oo(this.input,...this._bank1,this.offset90)}_createAllPassFilterBank(l){return l.map(l=>{let p=[[l*l,0,-1],[1,0,-l*l]];return this.context.createIIRFilter(p[0],p[1])})}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.offset90.dispose(),this._bank0.forEach(l=>l.disconnect()),this._bank1.forEach(l=>l.disconnect()),this._oneSampleDelay.disconnect(),this}};let Oa=class Oa extends ha{constructor(){super(ui(Oa.getDefaults(),arguments,["frequency"])),this.name="FrequencyShifter";let l=ui(Oa.getDefaults(),arguments,["frequency"]);this.frequency=new po({context:this.context,units:"frequency",value:l.frequency,minValue:-this.context.sampleRate/2,maxValue:this.context.sampleRate/2}),this._sine=new Qo({context:this.context,type:"sine"}),this._cosine=new Zo({context:this.context,phase:-90,type:"sine"}),this._sineMultiply=new Yo({context:this.context}),this._cosineMultiply=new Yo({context:this.context}),this._negate=new fr({context:this.context}),this._add=new nr({context:this.context}),this._phaseShifter=new Da({context:this.context}),this.effectSend.connect(this._phaseShifter),this.frequency.fan(this._sine.frequency,this._cosine.frequency),this._phaseShifter.offset90.connect(this._cosineMultiply),this._cosine.connect(this._cosineMultiply.factor),this._phaseShifter.connect(this._sineMultiply),this._sine.connect(this._sineMultiply.factor),this._sineMultiply.connect(this._negate),this._cosineMultiply.connect(this._add),this._negate.connect(this._add.addend),this._add.connect(this.effectReturn);let p=this.immediate();this._sine.start(p),this._cosine.start(p)}static getDefaults(){return Object.assign(ha.getDefaults(),{frequency:0})}dispose(){return super.dispose(),this.frequency.dispose(),this._add.dispose(),this._cosine.dispose(),this._cosineMultiply.dispose(),this._negate.dispose(),this._phaseShifter.dispose(),this._sine.dispose(),this._sineMultiply.dispose(),this}};let iM=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100],iR=[225,556,441,341];let Ra=class Ra extends ba{constructor(){super(ui(Ra.getDefaults(),arguments,["roomSize","dampening"])),this.name="Freeverb",this._combFilters=[],this._allpassFiltersL=[],this._allpassFiltersR=[];let l=ui(Ra.getDefaults(),arguments,["roomSize","dampening"]);this.roomSize=new po({context:this.context,value:l.roomSize,units:"normalRange"}),this._allpassFiltersL=iR.map(l=>{let p=this.context.createBiquadFilter();return p.type="allpass",p.frequency.value=l,p}),this._allpassFiltersR=iR.map(l=>{let p=this.context.createBiquadFilter();return p.type="allpass",p.frequency.value=l,p}),this._combFilters=iM.map((p,d)=>{let f=new Gr({context:this.context,dampening:l.dampening,delayTime:p});return d<iM.length/2?this.connectEffectLeft(f,...this._allpassFiltersL):this.connectEffectRight(f,...this._allpassFiltersR),this.roomSize.connect(f.resonance),f}),Oi(this,["roomSize"])}static getDefaults(){return Object.assign(ba.getDefaults(),{roomSize:.7,dampening:3e3})}get dampening(){return this._combFilters[0].dampening}set dampening(l){this._combFilters.forEach(p=>p.dampening=l)}dispose(){return super.dispose(),this._allpassFiltersL.forEach(l=>l.disconnect()),this._allpassFiltersR.forEach(l=>l.disconnect()),this._combFilters.forEach(l=>l.dispose()),this.roomSize.dispose(),this}};let iE=[.06748,.06404,.08212,.09004],iq=[.773,.802,.753,.733],iI=[347,113,37];let Va=class Va extends ba{constructor(){super(ui(Va.getDefaults(),arguments,["roomSize"])),this.name="JCReverb",this._allpassFilters=[],this._feedbackCombFilters=[];let l=ui(Va.getDefaults(),arguments,["roomSize"]);this.roomSize=new po({context:this.context,value:l.roomSize,units:"normalRange"}),this._scaleRoomSize=new ir({context:this.context,min:-.733,max:.197}),this._allpassFilters=iI.map(l=>{let p=this.context.createBiquadFilter();return p.type="allpass",p.frequency.value=l,p}),this._feedbackCombFilters=iE.map((l,p)=>{let d=new Br({context:this.context,delayTime:l});return this._scaleRoomSize.connect(d.resonance),d.resonance.value=iq[p],p<iE.length/2?this.connectEffectLeft(...this._allpassFilters,d):this.connectEffectRight(...this._allpassFilters,d),d}),this.roomSize.connect(this._scaleRoomSize),Oi(this,["roomSize"])}static getDefaults(){return Object.assign(ba.getDefaults(),{roomSize:.5})}dispose(){return super.dispose(),this._allpassFilters.forEach(l=>l.disconnect()),this._feedbackCombFilters.forEach(l=>l.dispose()),this.roomSize.dispose(),this._scaleRoomSize.dispose(),this}};let Na=class Na extends Ta{constructor(l){super(l),this._feedbackL.disconnect(),this._feedbackL.connect(this._feedbackMerge,0,1),this._feedbackR.disconnect(),this._feedbackR.connect(this._feedbackMerge,0,0),Oi(this,["feedback"])}};let Pa=class Pa extends Na{constructor(){super(ui(Pa.getDefaults(),arguments,["delayTime","feedback"])),this.name="PingPongDelay";let l=ui(Pa.getDefaults(),arguments,["delayTime","feedback"]);this._leftDelay=new yo({context:this.context,maxDelay:l.maxDelay}),this._rightDelay=new yo({context:this.context,maxDelay:l.maxDelay}),this._rightPreDelay=new yo({context:this.context,maxDelay:l.maxDelay}),this.delayTime=new po({context:this.context,units:"time",value:l.delayTime}),this.connectEffectLeft(this._leftDelay),this.connectEffectRight(this._rightPreDelay,this._rightDelay),this.delayTime.fan(this._leftDelay.delayTime,this._rightDelay.delayTime,this._rightPreDelay.delayTime),this._feedbackL.disconnect(),this._feedbackL.connect(this._rightDelay),Oi(this,["delayTime"])}static getDefaults(){return Object.assign(Na.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._leftDelay.dispose(),this._rightDelay.dispose(),this._rightPreDelay.dispose(),this.delayTime.dispose(),this}};let ja=class ja extends Aa{constructor(){super(ui(ja.getDefaults(),arguments,["pitch"])),this.name="PitchShift";let l=ui(ja.getDefaults(),arguments,["pitch"]);this._frequency=new po({context:this.context}),this._delayA=new yo({maxDelay:1,context:this.context}),this._lfoA=new rr({context:this.context,min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime),this._delayB=new yo({maxDelay:1,context:this.context}),this._lfoB=new rr({context:this.context,min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime),this._crossFade=new ca({context:this.context}),this._crossFadeLFO=new rr({context:this.context,min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new yo({delayTime:l.delayTime,context:this.context}),this.delayTime=this._feedbackDelay.delayTime,Oi(this,"delayTime"),this._pitch=l.pitch,this._windowSize=l.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);let p=this.now();this._lfoA.start(p),this._lfoB.start(p),this._crossFadeLFO.start(p),this.windowSize=this._windowSize}static getDefaults(){return Object.assign(Aa.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}get pitch(){return this._pitch}set pitch(l){this._pitch=l;let p=0;l<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,p=zi(l-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,p=zi(l)-1),this._frequency.value=p*(1.2/this._windowSize)}get windowSize(){return this._windowSize}set windowSize(l){this._windowSize=this.toSeconds(l),this.pitch=this._pitch}dispose(){return super.dispose(),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}};let La=class La extends ba{constructor(){super(ui(La.getDefaults(),arguments,["frequency","octaves","baseFrequency"])),this.name="Phaser";let l=ui(La.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);this._lfoL=new rr({context:this.context,frequency:l.frequency,min:0,max:1}),this._lfoR=new rr({context:this.context,frequency:l.frequency,min:0,max:1,phase:180}),this._baseFrequency=this.toFrequency(l.baseFrequency),this._octaves=l.octaves,this.Q=new po({context:this.context,value:l.Q,units:"positive"}),this._filtersL=this._makeFilters(l.stages,this._lfoL),this._filtersR=this._makeFilters(l.stages,this._lfoR),this.frequency=this._lfoL.frequency,this.frequency.value=l.frequency,this.connectEffectLeft(...this._filtersL),this.connectEffectRight(...this._filtersR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=l.baseFrequency,this.octaves=l.octaves,this._lfoL.start(),this._lfoR.start(),Oi(this,["frequency","Q"])}static getDefaults(){return Object.assign(ba.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}_makeFilters(l,p){let d=[];for(let f=0;f<l;f++){let l=this.context.createBiquadFilter();l.type="allpass",this.Q.connect(l.Q),p.connect(l.frequency),d.push(l)}return d}get octaves(){return this._octaves}set octaves(l){this._octaves=l;let p=this._baseFrequency*Math.pow(2,l);this._lfoL.max=p,this._lfoR.max=p}get baseFrequency(){return this._baseFrequency}set baseFrequency(l){this._baseFrequency=this.toFrequency(l),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}dispose(){return super.dispose(),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach(l=>l.disconnect()),this._filtersR.forEach(l=>l.disconnect()),this.frequency.dispose(),this}};let za=class za extends ha{constructor(){super(ui(za.getDefaults(),arguments,["decay"])),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();let l=ui(za.getDefaults(),arguments,["decay"]);this._decay=l.decay,this._preDelay=l.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(ha.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(l){Un(l=this.toSeconds(l),.001),this._decay=l,this.generate()}get preDelay(){return this._preDelay}set preDelay(l){Un(l=this.toSeconds(l),0),this._preDelay=l,this.generate()}generate(){return ni(this,void 0,void 0,function*(){let l=this.ready,p=new qi(2,this._decay+this._preDelay,this.context.sampleRate),d=new Lo({context:p}),f=new Lo({context:p}),_=new wa({context:p});d.connect(_,0,0),f.connect(_,0,1);let m=new ho({context:p}).toDestination();_.connect(m),d.start(0),f.start(0),m.gain.setValueAtTime(0,0),m.gain.setValueAtTime(1,this._preDelay),m.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);let O=p.render();return this.ready=O.then(Ei),yield l,this._convolver.buffer=(yield O).get(),this})}dispose(){return super.dispose(),this._convolver.disconnect(),this}};let Wa=class Wa extends io{constructor(){super(ui(Wa.getDefaults(),arguments)),this.name="MidSideSplit",this._split=this.input=new xa({channels:2,context:this.context}),this._midAdd=new nr({context:this.context}),this.mid=new Yo({context:this.context,value:Math.SQRT1_2}),this._sideSubtract=new _r({context:this.context}),this.side=new Yo({context:this.context,value:Math.SQRT1_2}),this._split.connect(this._midAdd,0),this._split.connect(this._midAdd.addend,1),this._split.connect(this._sideSubtract,0),this._split.connect(this._sideSubtract.subtrahend,1),this._midAdd.connect(this.mid),this._sideSubtract.connect(this.side)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midAdd.dispose(),this._sideSubtract.dispose(),this._split.dispose(),this}};let Ba=class Ba extends io{constructor(){super(ui(Ba.getDefaults(),arguments)),this.name="MidSideMerge",this.mid=new ho({context:this.context}),this.side=new ho({context:this.context}),this._left=new nr({context:this.context}),this._leftMult=new Yo({context:this.context,value:Math.SQRT1_2}),this._right=new _r({context:this.context}),this._rightMult=new Yo({context:this.context,value:Math.SQRT1_2}),this._merge=this.output=new wa({context:this.context}),this.mid.fan(this._left),this.side.connect(this._left.addend),this.mid.connect(this._right),this.side.connect(this._right.subtrahend),this._left.connect(this._leftMult),this._right.connect(this._rightMult),this._leftMult.connect(this._merge,0,0),this._rightMult.connect(this._merge,0,1)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._leftMult.dispose(),this._rightMult.dispose(),this._left.dispose(),this._right.dispose(),this}};let Ua=class Ua extends ha{constructor(l){super(l),this.name="MidSideEffect",this._midSideMerge=new Ba({context:this.context}),this._midSideSplit=new Wa({context:this.context}),this._midSend=this._midSideSplit.mid,this._sideSend=this._midSideSplit.side,this._midReturn=this._midSideMerge.mid,this._sideReturn=this._midSideMerge.side,this.effectSend.connect(this._midSideSplit),this._midSideMerge.connect(this.effectReturn)}connectEffectMid(...l){this._midSend.chain(...l,this._midReturn)}connectEffectSide(...l){this._sideSend.chain(...l,this._sideReturn)}dispose(){return super.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this._midSend.dispose(),this._sideSend.dispose(),this._midReturn.dispose(),this._sideReturn.dispose(),this}};let Ga=class Ga extends Ua{constructor(){super(ui(Ga.getDefaults(),arguments,["width"])),this.name="StereoWidener";let l=ui(Ga.getDefaults(),arguments,["width"]);this.width=new po({context:this.context,value:l.width,units:"normalRange"}),Oi(this,["width"]),this._twoTimesWidthMid=new Yo({context:this.context,value:2}),this._twoTimesWidthSide=new Yo({context:this.context,value:2}),this._midMult=new Yo({context:this.context}),this._twoTimesWidthMid.connect(this._midMult.factor),this.connectEffectMid(this._midMult),this._oneMinusWidth=new _r({context:this.context}),this._oneMinusWidth.connect(this._twoTimesWidthMid),ro(this.context.getConstant(1),this._oneMinusWidth),this.width.connect(this._oneMinusWidth.subtrahend),this._sideMult=new Yo({context:this.context}),this.width.connect(this._twoTimesWidthSide),this._twoTimesWidthSide.connect(this._sideMult.factor),this.connectEffectSide(this._sideMult)}static getDefaults(){return Object.assign(Ua.getDefaults(),{width:.5})}dispose(){return super.dispose(),this.width.dispose(),this._midMult.dispose(),this._sideMult.dispose(),this._twoTimesWidthMid.dispose(),this._twoTimesWidthSide.dispose(),this._oneMinusWidth.dispose(),this}};let Qa=class Qa extends ba{constructor(){super(ui(Qa.getDefaults(),arguments,["frequency","depth"])),this.name="Tremolo";let l=ui(Qa.getDefaults(),arguments,["frequency","depth"]);this._lfoL=new rr({context:this.context,type:l.type,min:1,max:0}),this._lfoR=new rr({context:this.context,type:l.type,min:1,max:0}),this._amplitudeL=new ho({context:this.context}),this._amplitudeR=new ho({context:this.context}),this.frequency=new po({context:this.context,value:l.frequency,units:"frequency"}),this.depth=new po({context:this.context,value:l.depth,units:"normalRange"}),Oi(this,["frequency","depth"]),this.connectEffectLeft(this._amplitudeL),this.connectEffectRight(this._amplitudeR),this._lfoL.connect(this._amplitudeL.gain),this._lfoR.connect(this._amplitudeR.gain),this.frequency.fan(this._lfoL.frequency,this._lfoR.frequency),this.depth.fan(this._lfoR.amplitude,this._lfoL.amplitude),this.spread=l.spread}static getDefaults(){return Object.assign(ba.getDefaults(),{frequency:10,type:"sine",depth:.5,spread:180})}start(l){return this._lfoL.start(l),this._lfoR.start(l),this}stop(l){return this._lfoL.stop(l),this._lfoR.stop(l),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this.context.transport.syncSignal(this.frequency),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this.context.transport.unsyncSignal(this.frequency),this}get type(){return this._lfoL.type}set type(l){this._lfoL.type=l,this._lfoR.type=l}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(l){this._lfoL.phase=90-l/2,this._lfoR.phase=l/2+90}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._amplitudeL.dispose(),this._amplitudeR.dispose(),this.frequency.dispose(),this.depth.dispose(),this}};let Za=class Za extends ha{constructor(){super(ui(Za.getDefaults(),arguments,["frequency","depth"])),this.name="Vibrato";let l=ui(Za.getDefaults(),arguments,["frequency","depth"]);this._delayNode=new yo({context:this.context,delayTime:0,maxDelay:l.maxDelay}),this._lfo=new rr({context:this.context,type:l.type,min:0,max:l.maxDelay,frequency:l.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=l.depth,Oi(this,["frequency","depth"]),this.effectSend.chain(this._delayNode,this.effectReturn)}static getDefaults(){return Object.assign(ha.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:"sine"})}get type(){return this._lfo.type}set type(l){this._lfo.type=l}dispose(){return super.dispose(),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}};let Xa=class Xa extends io{constructor(){super(ui(Xa.getDefaults(),arguments,["type","size"])),this.name="Analyser",this._analysers=[],this._buffers=[];let l=ui(Xa.getDefaults(),arguments,["type","size"]);this.input=this.output=this._gain=new ho({context:this.context}),this._split=new xa({context:this.context,channels:l.channels}),this.input.connect(this._split),Un(l.channels,1);for(let p=0;p<l.channels;p++)this._analysers[p]=this.context.createAnalyser(),this._split.connect(this._analysers[p],p,0);this.size=l.size,this.type=l.type,this.smoothing=l.smoothing}static getDefaults(){return Object.assign(io.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}getValue(){return this._analysers.forEach((l,p)=>{let d=this._buffers[p];"fft"===this._type?l.getFloatFrequencyData(d):"waveform"===this._type&&l.getFloatTimeDomainData(d)}),1===this.channels?this._buffers[0]:this._buffers}get size(){return this._analysers[0].frequencyBinCount}set size(l){this._analysers.forEach((p,d)=>{p.fftSize=2*l,this._buffers[d]=new Float32Array(l)})}get channels(){return this._analysers.length}get type(){return this._type}set type(l){Bn("waveform"===l||"fft"===l,`Analyser: invalid type: ${l}`),this._type=l}get smoothing(){return this._analysers[0].smoothingTimeConstant}set smoothing(l){this._analysers.forEach(p=>p.smoothingTimeConstant=l)}dispose(){return super.dispose(),this._analysers.forEach(l=>l.disconnect()),this._split.dispose(),this._gain.dispose(),this}};let Ya=class Ya extends io{constructor(){super(ui(Ya.getDefaults(),arguments)),this.name="MeterBase",this.input=this.output=this._analyser=new Xa({context:this.context,size:256,type:"waveform"})}dispose(){return super.dispose(),this._analyser.dispose(),this}};let $a=class $a extends Ya{constructor(){super(ui($a.getDefaults(),arguments,["smoothing"])),this.name="Meter";let l=ui($a.getDefaults(),arguments,["smoothing"]);this.input=this.output=this._analyser=new Xa({context:this.context,size:256,type:"waveform",channels:l.channelCount}),this.smoothing=l.smoothing,this.normalRange=l.normalRange,this._rms=Array(l.channelCount),this._rms.fill(0)}static getDefaults(){return Object.assign(Ya.getDefaults(),{smoothing:.8,normalRange:!1,channelCount:1})}getLevel(){return Kn("'getLevel' has been changed to 'getValue'"),this.getValue()}getValue(){let l=this._analyser.getValue(),p=(1===this.channels?[l]:l).map((l,p)=>{let d=l.reduce((l,p)=>l+p*p,0),f=Math.sqrt(d/l.length);return this._rms[p]=Math.max(f,this._rms[p]*this.smoothing),this.normalRange?this._rms[p]:Li(this._rms[p])});return 1===this.channels?p[0]:p}get channels(){return this._analyser.channels}dispose(){return super.dispose(),this._analyser.dispose(),this}};let Ha=class Ha extends Ya{constructor(){super(ui(Ha.getDefaults(),arguments,["size"])),this.name="FFT";let l=ui(Ha.getDefaults(),arguments,["size"]);this.normalRange=l.normalRange,this._analyser.type="fft",this.size=l.size}static getDefaults(){return Object.assign(io.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}getValue(){return this._analyser.getValue().map(l=>this.normalRange?ji(l):l)}get size(){return this._analyser.size}set size(l){this._analyser.size=l}get smoothing(){return this._analyser.smoothing}set smoothing(l){this._analyser.smoothing=l}getFrequencyOfIndex(l){return Bn(0<=l&&l<this.size,`index must be greater than or equal to 0 and less than ${this.size}`),l*this.context.sampleRate/(2*this.size)}};let Ja=class Ja extends Ya{constructor(){super(ui(Ja.getDefaults(),arguments)),this.name="DCMeter",this._analyser.type="waveform",this._analyser.size=256}getValue(){return this._analyser.getValue()[0]}};let Ka=class Ka extends Ya{constructor(){super(ui(Ka.getDefaults(),arguments,["size"])),this.name="Waveform";let l=ui(Ka.getDefaults(),arguments,["size"]);this._analyser.type="waveform",this.size=l.size}static getDefaults(){return Object.assign(Ya.getDefaults(),{size:1024})}getValue(){return this._analyser.getValue()}get size(){return this._analyser.size}set size(l){this._analyser.size=l}};let tc=class tc extends io{constructor(){super(ui(tc.getDefaults(),arguments,["solo"])),this.name="Solo";let l=ui(tc.getDefaults(),arguments,["solo"]);this.input=this.output=new ho({context:this.context}),tc._allSolos.has(this.context)||tc._allSolos.set(this.context,new Set),tc._allSolos.get(this.context).add(this),this.solo=l.solo}static getDefaults(){return Object.assign(io.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(l){l?this._addSolo():this._removeSolo(),tc._allSolos.get(this.context).forEach(l=>l._updateSolo())}get muted(){return 0===this.input.gain.value}_addSolo(){tc._soloed.has(this.context)||tc._soloed.set(this.context,new Set),tc._soloed.get(this.context).add(this)}_removeSolo(){tc._soloed.has(this.context)&&tc._soloed.get(this.context).delete(this)}_isSoloed(){return tc._soloed.has(this.context)&&tc._soloed.get(this.context).has(this)}_noSolos(){return!tc._soloed.has(this.context)||tc._soloed.has(this.context)&&0===tc._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),tc._allSolos.get(this.context).delete(this),this._removeSolo(),this}};tc._allSolos=new Map,tc._soloed=new Map;let ec=class ec extends io{constructor(){super(ui(ec.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";let l=ui(ec.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new pa({context:this.context,pan:l.pan,channelCount:l.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Oo({context:this.context,volume:l.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=l.mute,Oi(this,["pan","volume"])}static getDefaults(){return Object.assign(io.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(l){this._volume.mute=l}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}};let sc=class sc extends io{constructor(){super(ui(sc.getDefaults(),arguments,["volume","pan"])),this.name="Channel";let l=ui(sc.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new tc({solo:l.solo,context:this.context}),this._panVol=this.output=new ec({context:this.context,pan:l.pan,volume:l.volume,mute:l.mute,channelCount:l.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),Oi(this,["pan","volume"])}static getDefaults(){return Object.assign(io.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(l){this._solo.solo=l}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(l){this._panVol.mute=l}_getBus(l){return sc.buses.has(l)||sc.buses.set(l,new ho({context:this.context})),sc.buses.get(l)}send(l,p=0){let d=this._getBus(l),f=new ho({context:this.context,units:"decibels",gain:p});return this.connect(f),f.connect(d),f}receive(l){return this._getBus(l).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}};sc.buses=new Map;let nc=class nc extends io{constructor(){super(ui(nc.getDefaults(),arguments)),this.name="Mono",this.input=new ho({context:this.context}),this._merge=this.output=new wa({channels:2,context:this.context}),this.input.connect(this._merge,0,0),this.input.connect(this._merge,0,1)}dispose(){return super.dispose(),this._merge.dispose(),this.input.dispose(),this}};let ic=class ic extends io{constructor(){super(ui(ic.getDefaults(),arguments,["lowFrequency","highFrequency"])),this.name="MultibandSplit",this.input=new ho({context:this.context}),this.output=void 0,this.low=new Or({context:this.context,frequency:0,type:"lowpass"}),this._lowMidFilter=new Or({context:this.context,frequency:0,type:"highpass"}),this.mid=new Or({context:this.context,frequency:0,type:"lowpass"}),this.high=new Or({context:this.context,frequency:0,type:"highpass"}),this._internalChannels=[this.low,this.mid,this.high];let l=ui(ic.getDefaults(),arguments,["lowFrequency","highFrequency"]);this.lowFrequency=new po({context:this.context,units:"frequency",value:l.lowFrequency}),this.highFrequency=new po({context:this.context,units:"frequency",value:l.highFrequency}),this.Q=new po({context:this.context,units:"positive",value:l.Q}),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.fan(this.low.frequency,this._lowMidFilter.frequency),this.highFrequency.fan(this.mid.frequency,this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),Oi(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(io.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}dispose(){return super.dispose(),Mi(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}};let oc=class oc extends io{constructor(){super(...arguments),this.name="Listener",this.positionX=new no({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new no({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new no({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new no({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new no({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new no({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new no({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new no({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new no({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(io.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}};Ti(l=>{l.listener=new oc({context:l})}),ki(l=>{l.listener.dispose()});let rc=class rc extends io{constructor(){super(ui(rc.getDefaults(),arguments,["positionX","positionY","positionZ"])),this.name="Panner3D";let l=ui(rc.getDefaults(),arguments,["positionX","positionY","positionZ"]);this._panner=this.input=this.output=this.context.createPanner(),this.panningModel=l.panningModel,this.maxDistance=l.maxDistance,this.distanceModel=l.distanceModel,this.coneOuterGain=l.coneOuterGain,this.coneOuterAngle=l.coneOuterAngle,this.coneInnerAngle=l.coneInnerAngle,this.refDistance=l.refDistance,this.rolloffFactor=l.rolloffFactor,this.positionX=new no({context:this.context,param:this._panner.positionX,value:l.positionX}),this.positionY=new no({context:this.context,param:this._panner.positionY,value:l.positionY}),this.positionZ=new no({context:this.context,param:this._panner.positionZ,value:l.positionZ}),this.orientationX=new no({context:this.context,param:this._panner.orientationX,value:l.orientationX}),this.orientationY=new no({context:this.context,param:this._panner.orientationY,value:l.orientationY}),this.orientationZ=new no({context:this.context,param:this._panner.orientationZ,value:l.orientationZ})}static getDefaults(){return Object.assign(io.getDefaults(),{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1})}setPosition(l,p,d){return this.positionX.value=l,this.positionY.value=p,this.positionZ.value=d,this}setOrientation(l,p,d){return this.orientationX.value=l,this.orientationY.value=p,this.orientationZ.value=d,this}get panningModel(){return this._panner.panningModel}set panningModel(l){this._panner.panningModel=l}get refDistance(){return this._panner.refDistance}set refDistance(l){this._panner.refDistance=l}get rolloffFactor(){return this._panner.rolloffFactor}set rolloffFactor(l){this._panner.rolloffFactor=l}get distanceModel(){return this._panner.distanceModel}set distanceModel(l){this._panner.distanceModel=l}get coneInnerAngle(){return this._panner.coneInnerAngle}set coneInnerAngle(l){this._panner.coneInnerAngle=l}get coneOuterAngle(){return this._panner.coneOuterAngle}set coneOuterAngle(l){this._panner.coneOuterAngle=l}get coneOuterGain(){return this._panner.coneOuterGain}set coneOuterGain(l){this._panner.coneOuterGain=l}get maxDistance(){return this._panner.maxDistance}set maxDistance(l){this._panner.maxDistance=l}dispose(){return super.dispose(),this._panner.disconnect(),this.orientationX.dispose(),this.orientationY.dispose(),this.orientationZ.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this}};let ac=class ac extends io{constructor(){super(ui(ac.getDefaults(),arguments)),this.name="Recorder";let l=ui(ac.getDefaults(),arguments);this.input=new ho({context:this.context}),Bn(ac.supported,"Media Recorder API is not available"),this._stream=this.context.createMediaStreamDestination(),this.input.connect(this._stream),this._recorder=new MediaRecorder(this._stream.stream,{mimeType:l.mimeType})}static getDefaults(){return io.getDefaults()}get mimeType(){return this._recorder.mimeType}static get supported(){return null!==ip&&Reflect.has(ip,"MediaRecorder")}get state(){return"inactive"===this._recorder.state?"stopped":"paused"===this._recorder.state?"paused":"started"}start(){return ni(this,void 0,void 0,function*(){Bn("started"!==this.state,"Recorder is already started");let l=new Promise(l=>{let e=()=>{this._recorder.removeEventListener("start",e,!1),l()};this._recorder.addEventListener("start",e,!1)});return this._recorder.start(),yield l})}stop(){return ni(this,void 0,void 0,function*(){Bn("stopped"!==this.state,"Recorder is not started");let l=new Promise(l=>{let e=p=>{this._recorder.removeEventListener("dataavailable",e,!1),l(p.data)};this._recorder.addEventListener("dataavailable",e,!1)});return this._recorder.stop(),yield l})}pause(){return Bn("started"===this.state,"Recorder must be started"),this._recorder.pause(),this}dispose(){return super.dispose(),this.input.dispose(),this._stream.disconnect(),this}};let cc=class cc extends io{constructor(){super(ui(cc.getDefaults(),arguments,["threshold","ratio"])),this.name="Compressor",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor;let l=ui(cc.getDefaults(),arguments,["threshold","ratio"]);this.threshold=new no({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:"decibels",value:l.threshold}),this.attack=new no({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:"time",value:l.attack}),this.release=new no({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:"time",value:l.release}),this.knee=new no({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:"decibels",value:l.knee}),this.ratio=new no({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:"positive",value:l.ratio}),Oi(this,["knee","release","attack","ratio","threshold"])}static getDefaults(){return Object.assign(io.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}};let hc=class hc extends io{constructor(){super(Object.assign(ui(hc.getDefaults(),arguments,["threshold","smoothing"]))),this.name="Gate";let l=ui(hc.getDefaults(),arguments,["threshold","smoothing"]);this._follower=new fa({context:this.context,smoothing:l.smoothing}),this._gt=new gr({context:this.context,value:ji(l.threshold)}),this.input=new ho({context:this.context}),this._gate=this.output=new ho({context:this.context}),this.input.connect(this._gate),this.input.chain(this._follower,this._gt,this._gate.gain)}static getDefaults(){return Object.assign(io.getDefaults(),{smoothing:.1,threshold:-40})}get threshold(){return Li(this._gt.value)}set threshold(l){this._gt.value=ji(l)}get smoothing(){return this._follower.smoothing}set smoothing(l){this._follower.smoothing=l}dispose(){return super.dispose(),this.input.dispose(),this._follower.dispose(),this._gt.dispose(),this._gate.dispose(),this}};let lc=class lc extends io{constructor(){super(Object.assign(ui(lc.getDefaults(),arguments,["threshold"]))),this.name="Limiter";let l=ui(lc.getDefaults(),arguments,["threshold"]);this._compressor=this.input=this.output=new cc({context:this.context,ratio:20,attack:.003,release:.01,threshold:l.threshold}),this.threshold=this._compressor.threshold,Oi(this,"threshold")}static getDefaults(){return Object.assign(io.getDefaults(),{threshold:-12})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.dispose(),this.threshold.dispose(),this}};let uc=class uc extends io{constructor(){super(Object.assign(ui(uc.getDefaults(),arguments))),this.name="MidSideCompressor";let l=ui(uc.getDefaults(),arguments);this._midSideSplit=this.input=new Wa({context:this.context}),this._midSideMerge=this.output=new Ba({context:this.context}),this.mid=new cc(Object.assign(l.mid,{context:this.context})),this.side=new cc(Object.assign(l.side,{context:this.context})),this._midSideSplit.mid.chain(this.mid,this._midSideMerge.mid),this._midSideSplit.side.chain(this.side,this._midSideMerge.side),Oi(this,["mid","side"])}static getDefaults(){return Object.assign(io.getDefaults(),{mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}})}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this}};let pc=class pc extends io{constructor(){super(Object.assign(ui(pc.getDefaults(),arguments))),this.name="MultibandCompressor";let l=ui(pc.getDefaults(),arguments);this._splitter=this.input=new ic({context:this.context,lowFrequency:l.lowFrequency,highFrequency:l.highFrequency}),this.lowFrequency=this._splitter.lowFrequency,this.highFrequency=this._splitter.highFrequency,this.output=new ho({context:this.context}),this.low=new cc(Object.assign(l.low,{context:this.context})),this.mid=new cc(Object.assign(l.mid,{context:this.context})),this.high=new cc(Object.assign(l.high,{context:this.context})),this._splitter.low.chain(this.low,this.output),this._splitter.mid.chain(this.mid,this.output),this._splitter.high.chain(this.high,this.output),Oi(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(io.getDefaults(),{lowFrequency:250,highFrequency:2e3,low:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10},mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},high:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16}})}dispose(){return super.dispose(),this._splitter.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.output.dispose(),this}};let dc=class dc extends io{constructor(){super(ui(dc.getDefaults(),arguments,["low","mid","high"])),this.name="EQ3",this.output=new ho({context:this.context}),this._internalChannels=[];let l=ui(dc.getDefaults(),arguments,["low","mid","high"]);this.input=this._multibandSplit=new ic({context:this.context,highFrequency:l.highFrequency,lowFrequency:l.lowFrequency}),this._lowGain=new ho({context:this.context,gain:l.low,units:"decibels"}),this._midGain=new ho({context:this.context,gain:l.mid,units:"decibels"}),this._highGain=new ho({context:this.context,gain:l.high,units:"decibels"}),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),Oi(this,["low","mid","high","lowFrequency","highFrequency"]),this._internalChannels=[this._multibandSplit]}static getDefaults(){return Object.assign(io.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}dispose(){return super.dispose(),Mi(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}};let fc=class fc extends io{constructor(){super(ui(fc.getDefaults(),arguments,["url","onload"])),this.name="Convolver",this._convolver=this.context.createConvolver();let l=ui(fc.getDefaults(),arguments,["url","onload"]);this._buffer=new Ri(l.url,p=>{this.buffer=p,l.onload()}),this.input=new ho({context:this.context}),this.output=new ho({context:this.context}),this._buffer.loaded&&(this.buffer=this._buffer),this.normalize=l.normalize,this.input.chain(this._convolver,this.output)}static getDefaults(){return Object.assign(io.getDefaults(),{normalize:!0,onload:Ei})}load(l){return ni(this,void 0,void 0,function*(){this.buffer=yield this._buffer.load(l)})}get buffer(){return this._buffer.length?this._buffer:null}set buffer(l){l&&this._buffer.set(l),this._convolver.buffer&&(this.input.disconnect(),this._convolver.disconnect(),this._convolver=this.context.createConvolver(),this.input.chain(this._convolver,this.output));let p=this._buffer.get();this._convolver.buffer=p||null}get normalize(){return this._convolver.normalize}set normalize(l){this._convolver.normalize=l}dispose(){return super.dispose(),this._buffer.dispose(),this._convolver.disconnect(),this}};function _c(){return Vi().now()}function mc(){return Vi().immediate()}let iV=Vi().transport;function vc(){return Vi().transport}let iF=Vi().destination,iN=Vi().destination;function wc(){return Vi().destination}let iP=Vi().listener;function Tc(){return Vi().listener}let ij=Vi().draw;function kc(){return Vi().draw}let iB=Vi();function Cc(){return Ri.loaded()}let iL=Ri,iz=wo,iW=jo})(),d})(),"object"==typeof exports&&"object"==typeof module?module.exports=_():"function"==typeof define&&define.amd?define([],_):"object"==typeof exports?exports.Tone=_():f.Tone=_()}}]);