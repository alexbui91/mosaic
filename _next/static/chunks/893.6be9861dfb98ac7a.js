"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[893],{4893:function(e,t,r){r.d(t,{LiveAudioVisualizer:function(){return Sr}});var n,a=r(7294),l={exports:{}},i={};l.exports=function(){if(n)return i;n=1;var e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,l=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function k(t,n,a){var i,o={},s=null,c=null;for(i in void 0!==a&&(s=""+a),void 0!==n.key&&(s=""+n.key),void 0!==n.ref&&(c=n.ref),n)r.call(n,i)&&!u.hasOwnProperty(i)&&(o[i]=n[i]);if(t&&t.defaultProps)for(i in n=t.defaultProps)void 0===o[i]&&(o[i]=n[i]);return{$$typeof:e,type:t,key:s,ref:c,props:o,_owner:l.current}}return i.Fragment=t,i.jsx=k,i.jsxs=k,i}();var u=l.exports;let gr=(e,t,r,n)=>{let a=t/(r+n),l=Math.floor(e.length/a);a>e.length&&(a=e.length,l=1);let i=[];for(let t=0;t<a;t++){let r=0;for(let n=0;n<l&&t*l+n<e.length;n++)r+=e[t*l+n];i.push(r/l)}return i},vr=(e,t,r,n,a,l)=>{let i=t.height/2,u=t.getContext("2d");u&&(u.clearRect(0,0,t.width,t.height),"transparent"!==a&&(u.fillStyle=a,u.fillRect(0,0,t.width,t.height)),e.forEach((e,t)=>{u.fillStyle=l;let a=t*(r+n),o=i-e/2,s=e||1;u.beginPath(),u.roundRect?(u.roundRect(a,o,r,s,50),u.fill()):u.fillRect(a,o,r,s)}))},Sr=({mediaRecorder:e,width:t="100%",height:r="100%",barWidth:n=2,gap:l=1,backgroundColor:i="transparent",barColor:o="rgb(160, 198, 255)",fftSize:s=1024,maxDecibels:c=-10,minDecibels:f=-90,smoothingTimeConstant:h=.4})=>{let[d]=(0,a.useState)(()=>new AudioContext),[g,m]=(0,a.useState)(),p=(0,a.useRef)(null);(0,a.useEffect)(()=>{if(!e.stream)return;let t=d.createAnalyser();m(t),t.fftSize=s,t.minDecibels=f,t.maxDecibels=c,t.smoothingTimeConstant=h,d.createMediaStreamSource(e.stream).connect(t)},[e.stream]),(0,a.useEffect)(()=>{g&&"recording"===e.state&&y()},[g,e.state]);let y=(0,a.useCallback)(()=>{if(!g)return;let t=new Uint8Array(null==g?void 0:g.frequencyBinCount);"recording"===e.state?(null==g||g.getByteFrequencyData(t),D(t),requestAnimationFrame(y)):"paused"===e.state?D(t):"inactive"===e.state&&"closed"!==d.state&&d.close()},[g,d.state]),D=e=>{if(!p.current)return;let t=gr(e,p.current.width,n,l);vr(t,p.current,n,l,i,o)};return u.jsx("canvas",{ref:p,width:t,height:r,style:{aspectRatio:"unset"}})},hr=(e,t,r,n,a)=>{let l=e.getChannelData(0),i=r/(n+a),u=Math.floor(l.length/i),o=t/2,s=[],c=0;for(let t=0;t<i;t++){let r=[],n=0,a=[],i=0;for(let o=0;o<u&&t*u+o<e.length;o++){let e=l[t*u+o];e<=0&&(r.push(e),n++),e>0&&(a.push(e),i++)}let o=r.reduce((e,t)=>e+t,0)/n,f={max:a.reduce((e,t)=>e+t,0)/i,min:o};f.max>c&&(c=f.max),Math.abs(f.min)>c&&(c=Math.abs(f.min)),s.push(f)}if(.8*o>c*o){let e=.8*o/c;s=s.map(t=>({max:t.max*e,min:t.min*e}))}return s},te=(e,t,r,n,a,l,i,u=0,o=1)=>{let s=t.height/2,c=t.getContext("2d");if(!c)return;c.clearRect(0,0,t.width,t.height),"transparent"!==a&&(c.fillStyle=a,c.fillRect(0,0,t.width,t.height));let f=(u||0)/o;e.forEach((t,a)=>{let u=a/e.length;c.fillStyle=f>u&&i?i:l;let o=a*(r+n),h=s+t.min,d=s+t.max-h;c.beginPath(),c.roundRect?(c.roundRect(o,h,r,d,50),c.fill()):c.fillRect(o,h,r,d)})},o=(0,a.forwardRef)(({blob:e,width:t,height:r,barWidth:n=2,gap:l=1,currentTime:i,style:o,backgroundColor:s="transparent",barColor:c="rgb(184, 184, 184)",barPlayedColor:f="rgb(160, 198, 255)"},h)=>{let d=(0,a.useRef)(null),[g,m]=(0,a.useState)([]),[p,y]=(0,a.useState)(0);return(0,a.useImperativeHandle)(h,()=>d.current,[]),(0,a.useEffect)(()=>{(async()=>{if(!d.current)return;if(!e){let e=Array.from({length:100},()=>({max:0,min:0}));te(e,d.current,n,l,s,c,f);return}let a=await e.arrayBuffer();await new AudioContext().decodeAudioData(a,e=>{if(!d.current)return;y(e.duration);let a=hr(e,r,t,n,l);m(a),te(a,d.current,n,l,s,c,f)})})()},[e,d.current]),(0,a.useEffect)(()=>{d.current&&te(g,d.current,n,l,s,c,f,i,p)},[i,p]),u.jsx("canvas",{ref:d,width:t,height:r,style:{...o}})});o.displayName="AudioVisualizer"}}]);